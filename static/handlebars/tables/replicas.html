<script id="replica-template" type="text/x-handlebars-template">
    <h2 class="title">Replication status</h2>
    <div class="alert alert-error cannot_change_replicas">
        Please resolve the cluster configuration conflict before changing replicas.
    </div>

    <div class="replica-status"></div>
    <h2 class="title">Replication settings</h2>
    <div class="alert alert-error settings_alert"></div>
    <div class="cluster_container">
        <div class="cluster-info replica_container">
            <div class="status-alert alert"></div>
            {{#if editable}}
                <button class="cancel btn">&times;</button>
                <button class="save update-replicas btn">Update</button>
            {{else}}
                <button class="edit btn">Edit</button>
            {{/if}}
            <div class="cluster-replicas">
                {{#if editable}}
                    <p>
                        <input type="text" id="replicas_value" value="{{num_replicas_per_shard}}" class="inline_edit_input">
                        <span class="caption">replicas</span>
                    </p>
                    <p class="max-value">max replicas: {{max_replicas}}</p>
                {{else}}
                    <p><span class="value">{{num_replicas_per_shard}}</span> <span class="caption">replicas per shard</p>
                {{/if}}
            </div>
        </div>
    </div>
</script>

<script id="replica-alert-template" type="text/x-handlebars-template">
    {{#if too_many_replicas}}
    The number of replicas ({{num_replicas}}) cannot exceed the total number of servers ({{max_num_replicas}}).
    {{/if}}
    {{#if not_int}}
    The number of replicas must be an integer.
    {{/if}}
    {{#if need_at_least_one_replica}}
    The number of replicas must be at least one.
    {{/if}}
    {{#if server_error}}
    The server could not update the replicas. Error:
    <pre class="server_error">{{error.msg}}</pre>
    {{/if}}
</script>

<script id="replica_status-template" type="text/x-handlebars-template">
    {{#if operation_active}}
        <div class="progress-status">
            <div class="stages">
                {{#if starting}}
                    <p>Started</p>
                {{/if}}
                {{#if processing}}
                    <p class="completed">Started</p>
                    <p>Replicating</p>
                {{/if}}
                {{#if finished}}
                    <p class="completed">Started</p>
                    <p class="completed">Replicated</p>
                {{/if}}
            </div>
            {{#if starting}}
                <p>0/{{new_value}} replicas completed</p>
                {{else}}
            <p>
            {{current_value}}/{{max_value}} {{pluralize_noun "replica" num_replicas}}{{#if total_blocks}}, 
            {{! Keep the if above so we do not have an extra space before the comma}}
            {{replicated_blocks}}/{{total_blocks}} blocks copied
            {{else}}
            up to date
            {{/if}}
            </p>
            {{/if}}
            <div class="progress"><div class="bar" style="width:{{#if starting}}0{{else}}{{percent_complete}}{{/if}}%"></div></div>
        </div>
    {{else}}
    <p><span class="big">{{current_value}}/{{max_value}}</span> {{pluralize_noun "replica" max_value}} available</p>
    {{/if}}
</script>
