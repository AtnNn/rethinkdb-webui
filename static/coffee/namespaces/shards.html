<script id="shard_name_td-partial" type="text/x-handlebars-template">
  <td class="name">
    <h4>{{name}}</h4>
    About {{shard_stats.rows_approx}} {{pluralize_noun "key" shard_stats.rows_approx}}
  </td>
</script>

<script id="namespace_view-sharding-template" type="text/x-handlebars-template">
  <table class="shards table">
    <tbody>
      {{#each shards}}
      <tr>
        {{> shard_name_td}}
        <td class="status">
          <p>
            <strong>Master:</strong> <a href="/#machines/{{primary.uuid}}">{{primary.name}}</a> {{humanize_machine_reachability primary.status}}{{#if primary.status.reachable}}{{> backfill_progress_summary primary}}{{/if}}</span>
<br />
{{> backfill_progress_details primary}}
<a id="assign_master_{{index}}" href="#">Assign master</a>
</p>
{{#if secondaries}}
{{#each secondaries}}
<p><strong>Replicas in datacenter <a href="/#datacenters/{{datacenter_uuid}}">{{datacenter_name}}</a>:</strong></p>
<ul>
  {{#each machines}}
  <li>
    <p>
      <a href="/#machines/{{uuid}}">{{name}}</a>
      <span>{{humanize_machine_reachability status}}{{#if status.reachable}}{{> backfill_progress_summary}}{{/if}}</span>
    </p>
    {{> backfill_progress_details}}
  </li>
  {{/each}}
</ul>
<a id="assign_machines_{{../index}}_{{datacenter_uuid}}" href="#">Assign machines</a>
<hr />
{{/each}}
{{else}}
This shard has no replicas.
{{/if}}
</td>
</tr>
{{/each}}
</tbody>
</table>
<p><a class="edit" href="/#namespaces/{{namespace_uuid}}/sharding_scheme">Change sharding scheme</a></p>
</script>

<script id="modify_shards-template" type="text/x-handlebars-template">
    <div class="modify-shards">
        <h1>Change sharding settings for <a href="/#namespaces/{{namespace.id}}">{{namespace.name}}</a>:</h1>
        {{#if unsaved_settings}}
        <div class="unsaved-settings-warning">You have unsaved changes. Please click "Commit settings" for them to take effect.</div>
        {{/if}}
        <form class="form">
            <div class="sharding-scheme">
                <table class="shards table">
                    <tbody>
                    </tbody>
                </table>
                {{#if suggest_shards_view}}
                <div class="shard-suggester clearfix">
                    <h4>Suggest sharding scheme:</h4>
                    {{#if error_msg}}
                    <p class="server-error alert alert-error">{{error_msg}}</p>
                    {{/if}}
                    <div class="shard_suggest_elements">
                        <label for="replicas">Number of shards:</label>
                        <input class="num_shards" name="num_shards" type="text" value="{{new_shard_count}}"/>
                        <button class="btn btn-compute-shards-suggestion" data-loading-text="Calculating...">Suggest</button>
                    </div>
                    <p class="current">Current shards: <strong>{{current_shards_count}}</strong>, Max shards: <strong>{{max_shard_count}}</strong></p>
                    <a id="cancel_shards_suggester_btn" href="#">Cancel</a>
                </div>
                {{else}}
                <p class="suggest_shards_pathway"><a id="suggest_shards_btn" href="#">Suggest shards</a></p>
                {{/if}}
            </div>
            <div class="sharding-plan"></div>
            <div class="btn-footer">
                <button class="btn btn-reset" data-loading-text="Reset">Reset</button>
                <button class="btn btn-primary" data-loading-text="Saving...">Commit settings</button>
            </div>
        </form>
    </div>
</script>

<script id="modify_shards-alert-template" type="text/x-handlebars-template">
  <div class="alert" data-alert="alert">
    <a class="close" href="#">&times;</a>
    <p>You successfully modified the shard plan. Machine assignments for this namespace have been reset.</p>
  </div>
</script>

<script id="modify_shards-view_shard-template" type="text/x-handlebars-template">
  {{#with shard}}
  {{> shard_name_td}}
  <td class="actions">
    <p>
      (<a href="#" class="split" data-index="{{index}}">split</a>)
      {{#if notlast}}
      (<a href="#" class="merge" data-index="{{index}}">merge with next</a>)
      {{/if}}
    </p>
  </td>
  {{/with}}
</script>

<script id="modify_shards-edit_shard-template" type="text/x-handlebars-template">
  {{#with shard}}
  {{> shard_name_td}}
  {{/with}}
  <td class="status">
    <div class="action">
      {{#if splitting}}
      <label for="splitpoint">
        <p>Split point:</p>
      </label>
      <input class="small" name="splitpoint" type="text" />
      <a href="#" class="btn commit_split primary">Split</a>
      <a href="#" class="btn cancel_split secondary">Cancel</a>
      {{/if}}
      {{#if merging}}
      <p>
        Are you sure you want to merge these shards?
        <a href="#" class="btn commit_merge primary">Yes</a>
        <a href="#" class="btn cancel_merge secondary">No</a>
      </p>
      {{/if}}
    </div>
  </td>
</script>

