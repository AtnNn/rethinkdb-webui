(function(){
var f=void 0,i=!0,j=null,k=!1,l,aa=this;
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function n(a){return"array"==ca(a)}Math.floor(2147483648*Math.random()).toString(36);function da(a,b,c){return a.call.apply(a.bind,arguments)}function ea(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function fa(a,b,c){fa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?da:ea;return fa.apply(j,arguments)}function o(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==f?d[e]=b:d=d[e]?d[e]:d[e]={}}function p(a,b){function c(){}c.prototype=b.prototype;a.gd=b.prototype;a.prototype=new c;a.prototype.constructor=a};aa.rethinkdb=function(a){return ga(a)};function q(a){return a instanceof r?a:t(a)}function u(a){return a instanceof ha?a:ia(a)}function w(a,b){if(a){var c=b;n(b)||(c=[c]);if(!c.some(function(b){return"string"===typeof b?typeof a===b:a instanceof b})){if(n(b))throw new TypeError("Function argument "+a+" must be one of the types "+b);throw new TypeError("Function argument "+a+" must be of the type "+b);}}}
function x(a,b){if(a.length<b)throw new TypeError("Function requires at least "+b+" argument"+(1<b?"s.":"."));}function y(a){function b(a){return z.prototype.ia.call(b,a)}var c=arguments[0],d=Array.prototype.slice.call(arguments,1);b.__proto__=c.prototype;c.apply(b,d);return b};function t(a){if(!(a instanceof z))if(a===j||"number"==typeof a)a=y(ja,a);else if("boolean"==typeof a)a=y(ka,a);else if("string"==typeof a)a=y(la,a);else if(n(a))a=y(ma,a);else var b=typeof a,a="object"==b&&a!=j||"function"==b?y(na,a):y(oa,a);return a}o("rethinkdb.expr",t);o("rethinkdb.js",function(a){x(arguments,1);w(a,"string");return y(pa,a)});o("rethinkdb.table",function(a,b){x(arguments,1);w(a,"string");w(b,"boolean");return y(A,a,j,b)});
o("rethinkdb.union",function(a){x(arguments,2);var b=q(arguments[0]);return z.prototype.Ma.apply(b,Array.prototype.slice.call(arguments,1))});function r(){}r.prototype.S=function(a,b){var c=b||qa;if(!c)throw new C("No connection specified and no last connection to default to.");return c.S(this,a)};r.prototype.run=r.prototype.S;r.prototype.pb=function(a){(a?a.S(this):this.S()).qa(function(a){1===a.length&&(a=a[0]);console.log(a)})};r.prototype.runp=r.prototype.pb;r.prototype.a=function(){return"----"};
function ra(){}p(ra,r);ra.prototype.o=function(a){var b=new sa,a=this.compile(a);b.ma(a);a=new D;a.c(ta);E(a,3,b);return a};function ua(a){Error.captureStackTrace?Error.captureStackTrace(this,ua):this.stack=Error().stack||"";a&&(this.message=String(a))}p(ua,Error);ua.prototype.name="CustomError";function va(a,b,c){this.dd=a;this.s=b;this.v=c.name;this.X=!!c.D;this.cd=!!c.required;this.p=c.b;this.Ga=c.type;this.Wa=k;switch(this.p){case wa:case xa:case ya:case za:case Aa:this.Wa=i}this.ta=c.defaultValue}var wa=3,xa=4,ya=6,za=16,Aa=18;var Ba=Array.prototype;function Ca(a,b){return a>b?1:a<b?-1:0};function Da(a,b,c){this.fb=a;this.v=b.name||j;this.bd=b.e||j;this.$c=b.l;this.H={};for(a=0;a<c.length;a++)b=c[a],this.H[b.s]=b}function Ea(a){var a=a.H,b=[],c=0,d;for(d in a)b[c++]=a[d];Ba.sort.call(b,function(a,b){return a.s-b.s}||Ca);return b};function F(){this.C={};this.P=this.constructor.P;this.H=this.P.H;this.K=this.Fa=j}l=F.prototype;l.ja=function(){return this.P};l.get=function(a,b){return G(this,a.s,b)};l.set=function(a,b){E(this,a.s,b)};l.add=function(a,b){H(this,a.s,b)};
l.n=function(a){if(!a||this.constructor!=a.constructor)return k;for(var b=Ea(this.ja()),c=0;c<b.length;c++){var d=b[c];if(Fa(this,d.s)!=Fa(a,d.s))return k;if(Fa(this,d.s)){var e=11==d.p||10==d.p,g=Ga(this,d),h=Ga(a,d);if(d.X){if(g.length!=h.length)return k;for(d=0;d<g.length;d++)if(!(e?g[d].n(h[d]):g[d]==h[d]))return k}else if(!(e?g.n(h):g==h))return k}}return i};function Fa(a,b){return b in a.C&&a.C[b]!==f&&a.C[b]!==j}
function Ga(a,b){var c=b.s;if(!c in a.C)return j;var d=a.C[c];return d==j?j:a.Fa?!(c in a.K)?(d=a.Fa.ad(a,b,d),a.K[c]=d):a.K[c]:d}function G(a,b,c){b=a.H[b];a=Ga(a,b);if(b.X)return n(a),a[c||0];n(a);return a}function Ha(a,b){var c;if(Fa(a,b))c=G(a,b,f);else{c=a.H[b];if(c.ta===f){var d=c.Ga;c.ta=d===Boolean?k:d===Number?0:d===String?"":new d}c=c.ta}return c}function Ia(a,b){var c=Ga(a,a.H[b]);c==j||n(c);return c||[]}
function Ja(a,b){return a.H[b].X?(Fa(a,b)&&n(a.C[b]),Fa(a,b)?a.C[b].length:0):Fa(a,b)?1:0}function E(a,b,c){a.C[b]=c;a.K&&(a.K[b]=c)}function H(a,b,c){a.C[b]||(a.C[b]=[]);a.C[b].push(c);a.K&&delete a.K[b]}function I(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new va(a,e,b[e])));a.P=new Da(a,d,c);a.ja=function(){return a.P}};function J(){F.apply(this)}p(J,F);J.prototype.aa=function(a){E(this,1,a)};function Ka(){F.apply(this)}p(Ka,F);Ka.prototype.T=function(a){E(this,1,a)};Ka.prototype.ma=function(a){E(this,2,a)};function K(){F.apply(this)}p(K,F);K.prototype.c=function(a){E(this,1,a)};K.prototype.T=function(a){E(this,2,a)};function La(a){return Ha(a,15)}function Ma(){F.apply(this)}p(Ma,F);function Na(){F.apply(this)}p(Na,F);function Oa(){F.apply(this)}p(Oa,F);function Pa(){F.apply(this)}p(Pa,F);
Pa.prototype.A=function(){return Ha(this,1)};Pa.prototype.r=function(a){E(this,1,a)};Pa.prototype.I=function(a){E(this,2,a)};Pa.prototype.M=function(a){E(this,3,a)};function Qa(){F.apply(this)}p(Qa,F);Qa.prototype.A=function(){return Ha(this,1)};Qa.prototype.r=function(a){E(this,1,a)};function L(){F.apply(this)}p(L,F);L.prototype.c=function(a){E(this,1,a)};L.prototype.ia=function(){return G(this,2)};L.prototype.$=function(a){E(this,2,a)};
var Ra=19,Sa={xc:1,Xb:2,cc:3,ac:4,dc:5,Cc:6,ec:7,rc:8,Db:9,Kc:11,zb:14,Oc:15,uc:16,Pb:17,tc:18,Ib:Ra,Ub:20,qc:21,Jb:22,Bc:23,Ob:24,lc:26,Uc:27,yc:28,Mc:29,Eb:30,Ic:31,Zb:32,Bb:35,Ab:36,Gc:37,gc:38,Xc:39};function Ta(){F.apply(this)}p(Ta,F);function Ua(){F.apply(this)}p(Ua,F);Ua.prototype.B=function(a){E(this,1,a)};function Va(){F.apply(this)}p(Va,F);Va.prototype.B=function(a){E(this,1,a)};function Wa(){F.apply(this)}p(Wa,F);Wa.prototype.ia=function(){return G(this,1)};
Wa.prototype.$=function(a){E(this,1,a)};function Xa(){F.apply(this)}p(Xa,F);function Ya(){F.apply(this)}p(Ya,F);Ya.prototype.I=function(a){E(this,1,a)};function Za(){F.apply(this)}p(Za,F);Za.prototype.q=function(a){E(this,4,a)};function M(){F.apply(this)}p(M,F);M.prototype.F=function(a){E(this,1,a)};M.prototype.q=function(a){E(this,2,a)};function $a(){F.apply(this)}p($a,F);$a.prototype.F=function(a){E(this,1,a)};$a.prototype.q=function(a){E(this,2,a)};function sa(){F.apply(this)}p(sa,F);
sa.prototype.ma=function(a){E(this,1,a)};function N(){F.apply(this)}p(N,F);N.prototype.c=function(a){E(this,1,a)};function ab(){F.apply(this)}p(ab,F);ab.prototype.ba=function(a){E(this,1,a)};ab.prototype.B=function(a){E(this,2,a)};function bb(){F.apply(this)}p(bb,F);bb.prototype.ba=function(a){E(this,1,a)};function cb(){F.apply(this)}p(cb,F);cb.prototype.ba=function(a){E(this,1,a)};cb.prototype.B=function(a){E(this,2,a)};function db(){F.apply(this)}p(db,F);
db.prototype.A=function(){return Ha(this,1)};db.prototype.r=function(a){E(this,1,a)};function eb(){F.apply(this)}p(eb,F);eb.prototype.T=function(a){E(this,2,a)};function fb(){F.apply(this)}p(fb,F);l=fb.prototype;l.A=function(){return Ha(this,1)};l.r=function(a){E(this,1,a)};l.I=function(a){E(this,2,a)};l.M=function(a){E(this,3,a)};l.B=function(a){E(this,4,a)};function gb(){F.apply(this)}p(gb,F);gb.prototype.A=function(){return Ha(this,1)};gb.prototype.r=function(a){E(this,1,a)};
gb.prototype.I=function(a){E(this,2,a)};gb.prototype.M=function(a){E(this,3,a)};function hb(){F.apply(this)}p(hb,F);l=hb.prototype;l.A=function(){return Ha(this,1)};l.r=function(a){E(this,1,a)};l.I=function(a){E(this,2,a)};l.M=function(a){E(this,3,a)};l.B=function(a){E(this,4,a)};function O(){F.apply(this)}p(O,F);O.prototype.c=function(a){E(this,1,a)};O.prototype.aa=function(a){E(this,2,a)};function ib(){F.apply(this)}p(ib,F);ib.prototype.A=function(){return Ha(this,3)};
ib.prototype.r=function(a){E(this,3,a)};function D(){F.apply(this)}p(D,F);D.prototype.c=function(a){E(this,1,a)};D.prototype.L=function(){return G(this,2)};D.prototype.xa=function(a){E(this,2,a)};var ta=1,jb={Hc:ta,Yc:2,Kb:3,Lc:4,sc:5};function kb(){F.apply(this)}p(kb,F);kb.prototype.L=function(){return G(this,2)};kb.prototype.xa=function(a){E(this,2,a)};function lb(){F.apply(this)}p(lb,F);
I(J,{"0":{name:"TableRef",e:"TableRef"},1:{name:"db_name",b:9,type:String},2:{name:"table_name",b:9,type:String},3:{name:"use_outdated",b:8,defaultValue:0,type:Boolean}});I(Ka,{"0":{name:"VarTermTuple",e:"VarTermTuple"},1:{name:"var",b:9,type:String},2:{name:"term",b:11,type:K}});
I(K,{"0":{name:"Term",e:"Term"},1:{name:"type",b:14,defaultValue:0,type:{jc:0,Wc:1,mc:2,Hb:3,bc:4,Tb:5,zc:6,Nc:7,JSON:8,BOOL:9,Cb:10,Ac:11,Yb:12,Tc:13,ic:14,fc:15}},2:{name:"var",b:9,type:String},3:{name:"let",b:11,type:Ma},4:{name:"call",b:11,type:Na},5:{name:"if_",b:11,type:Oa},6:{name:"error",b:9,type:String},7:{name:"number",b:1,type:Number},8:{name:"valuestring",b:9,type:String},9:{name:"jsonstring",b:9,type:String},10:{name:"valuebool",b:8,type:Boolean},11:{name:"array",D:i,b:11,type:K},12:{name:"object",
D:i,b:11,type:Ka},14:{name:"get_by_key",b:11,type:Pa},15:{name:"table",b:11,type:Qa},16:{name:"javascript",b:9,type:String}});I(Ma,{"0":{name:"Let",l:K,e:"Term.Let"},1:{name:"binds",D:i,b:11,type:Ka},2:{name:"expr",b:11,type:K}});I(Na,{"0":{name:"Call",l:K,e:"Term.Call"},1:{name:"builtin",b:11,type:L},2:{name:"args",D:i,b:11,type:K}});I(Oa,{"0":{name:"If",l:K,e:"Term.If"},1:{name:"test",b:11,type:K},2:{name:"true_branch",b:11,type:K},3:{name:"false_branch",b:11,type:K}});
I(Pa,{"0":{name:"GetByKey",l:K,e:"Term.GetByKey"},1:{name:"table_ref",b:11,type:J},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:K}});I(Qa,{"0":{name:"Table",l:K,e:"Term.Table"},1:{name:"table_ref",b:11,type:J}});
I(L,{"0":{name:"Builtin",e:"Builtin"},1:{name:"type",b:14,defaultValue:1,type:Sa},2:{name:"attr",b:9,type:String},3:{name:"attrs",D:i,b:9,type:String},4:{name:"comparison",b:14,defaultValue:1,type:{Sb:1,wc:2,pc:3,kc:4,$b:5,Wb:6}},5:{name:"filter",b:11,type:Ta},6:{name:"map",b:11,type:Ua},7:{name:"concat_map",b:11,type:Va},8:{name:"order_by",D:i,b:11,type:Wa},9:{name:"reduce",b:11,type:Za},10:{name:"grouped_map_reduce",b:11,type:Xa},11:{name:"range",b:11,type:Ya}});
I(Ta,{"0":{name:"Filter",l:L,e:"Builtin.Filter"},1:{name:"predicate",b:11,type:$a}});I(Ua,{"0":{name:"Map",l:L,e:"Builtin.Map"},1:{name:"mapping",b:11,type:M}});I(Va,{"0":{name:"ConcatMap",l:L,e:"Builtin.ConcatMap"},1:{name:"mapping",b:11,type:M}});I(Wa,{"0":{name:"OrderBy",l:L,e:"Builtin.OrderBy"},1:{name:"attr",b:9,type:String},2:{name:"ascending",b:8,defaultValue:1,type:Boolean}});
I(Xa,{"0":{name:"GroupedMapReduce",l:L,e:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",b:11,type:M},2:{name:"value_mapping",b:11,type:M},3:{name:"reduction",b:11,type:Za}});I(Ya,{"0":{name:"Range",l:L,e:"Builtin.Range"},1:{name:"attrname",b:9,type:String},2:{name:"lowerbound",b:11,type:K},3:{name:"upperbound",b:11,type:K}});I(Za,{"0":{name:"Reduction",e:"Reduction"},1:{name:"base",b:11,type:K},2:{name:"var1",b:9,type:String},3:{name:"var2",b:9,type:String},4:{name:"body",b:11,type:K}});
I(M,{"0":{name:"Mapping",e:"Mapping"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:K}});I($a,{"0":{name:"Predicate",e:"Predicate"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:K}});I(sa,{"0":{name:"ReadQuery",e:"ReadQuery"},1:{name:"term",b:11,type:K},2:{name:"max_chunk_size",b:3,type:String},3:{name:"max_age",b:3,type:String}});
I(N,{"0":{name:"WriteQuery",e:"WriteQuery"},1:{name:"type",b:14,defaultValue:1,type:{Vc:1,Nb:2,vc:3,hc:4,Vb:6,Fc:7,Dc:8,Ec:9}},11:{name:"atomic",b:8,defaultValue:1,type:Boolean},2:{name:"update",b:11,type:ab},3:{name:"delete",b:11,type:bb},4:{name:"mutate",b:11,type:cb},5:{name:"insert",b:11,type:db},7:{name:"for_each",b:11,type:eb},8:{name:"point_update",b:11,type:fb},9:{name:"point_delete",b:11,type:gb},10:{name:"point_mutate",b:11,type:hb}});
I(ab,{"0":{name:"Update",l:N,e:"WriteQuery.Update"},1:{name:"view",b:11,type:K},2:{name:"mapping",b:11,type:M}});I(bb,{"0":{name:"Delete",l:N,e:"WriteQuery.Delete"},1:{name:"view",b:11,type:K}});I(cb,{"0":{name:"Mutate",l:N,e:"WriteQuery.Mutate"},1:{name:"view",b:11,type:K},2:{name:"mapping",b:11,type:M}});I(db,{"0":{name:"Insert",l:N,e:"WriteQuery.Insert"},1:{name:"table_ref",b:11,type:J},2:{name:"terms",D:i,b:11,type:K},3:{name:"overwrite",b:8,defaultValue:0,type:Boolean}});
I(eb,{"0":{name:"ForEach",l:N,e:"WriteQuery.ForEach"},1:{name:"stream",b:11,type:K},2:{name:"var",b:9,type:String},3:{name:"queries",D:i,b:11,type:N}});I(fb,{"0":{name:"PointUpdate",l:N,e:"WriteQuery.PointUpdate"},1:{name:"table_ref",b:11,type:J},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:K},4:{name:"mapping",b:11,type:M}});I(gb,{"0":{name:"PointDelete",l:N,e:"WriteQuery.PointDelete"},1:{name:"table_ref",b:11,type:J},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:K}});
I(hb,{"0":{name:"PointMutate",l:N,e:"WriteQuery.PointMutate"},1:{name:"table_ref",b:11,type:J},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:K},4:{name:"mapping",b:11,type:M}});I(O,{"0":{name:"MetaQuery",e:"MetaQuery"},1:{name:"type",b:14,defaultValue:1,type:{Lb:1,Qb:2,nc:3,Mb:4,Rb:5,oc:6}},2:{name:"db_name",b:9,type:String},3:{name:"create_table",b:11,type:ib},4:{name:"drop_table",b:11,type:J}});
I(ib,{"0":{name:"CreateTable",l:O,e:"MetaQuery.CreateTable"},1:{name:"datacenter",b:9,type:String},3:{name:"table_ref",b:11,type:J},4:{name:"primary_key",b:9,defaultValue:"id",type:String},5:{name:"cache_size",b:3,defaultValue:"1073741824",type:String}});I(D,{"0":{name:"Query",e:"Query"},1:{name:"type",b:14,defaultValue:ta,type:jb},2:{name:"token",b:3,type:String},3:{name:"read_query",b:11,type:sa},4:{name:"write_query",b:11,type:N},5:{name:"meta_query",b:11,type:O}});
I(kb,{"0":{name:"Response",e:"Response"},1:{name:"status_code",b:14,defaultValue:0,type:{Pc:0,Qc:1,Rc:2,Sc:3,Gb:101,Fb:102,Jc:103}},2:{name:"token",b:3,type:String},3:{name:"response",D:i,b:9,type:String},4:{name:"error_message",b:9,type:String},5:{name:"backtrace",b:11,type:lb}});I(lb,{"0":{name:"Backtrace",l:kb,e:"Response.Backtrace"},1:{name:"frame",D:i,b:9,type:String}});function z(){}p(z,ra);function mb(a){this.gb=a||""}p(mb,z);mb.prototype.compile=function(){var a=new K;a.c(5);E(a,6,this.gb);return a};mb.prototype.a=function(a){return a?"^^^^^^^^^":"r.error()"};o("rethinkdb.error",function(){return new mb});function oa(a){this.i=a}p(oa,z);oa.prototype.compile=function(){var a=new K;a.c(8);var b=JSON.stringify(this.i);E(a,9,b);return a};function ja(a){this.i="undefined"===typeof a?j:a}p(ja,z);
ja.prototype.compile=function(){var a=new K;this.i===j?a.c(0):(a.c(6),E(a,7,this.i));return a};ja.prototype.a=function(a){var b="r.expr("+this.i+")";return a?P(b):b};function ka(a){this.i=a}p(ka,z);ka.prototype.compile=function(){var a=new K;a.c(9);E(a,10,this.i);return a};ka.prototype.a=function(a){var b="r.expr("+this.i+")";return a?P(b):b};function la(a){this.i=a}p(la,z);la.prototype.compile=function(){var a=new K;a.c(7);E(a,8,this.i);return a};
la.prototype.a=function(a){var b="r.expr('"+this.i+"')";return a?P(b):b};function ma(a){this.i=[];for(var b=0;b<a.length;b++){var c=q(a[b]);this.i.push(c)}}p(ma,z);ma.prototype.compile=function(a){var b=new K;b.c(10);for(var c=0;c<this.i.length;c++){var d=this.i[c].compile(a);H(b,11,d)}return b};
ma.prototype.a=function(a){var b=this.i.map(function(a){return a.a()});if(a){if(0===a.length)return P("r.expr(["+b.join(", ")+"])");var c=a[0].split(":");a.shift();c=parseInt(c[1],10);b=b.map(Q);b[c]=this.i[c].a(a);return"        "+b.join("  ")+"  "}return"r.expr(["+b.join(", ")+"])"};function na(a){this.i={};for(var b in a)if(a.hasOwnProperty(b)){var c=q(a[b]);this.i[b]=c}}p(na,z);
na.prototype.compile=function(a){var b=new K;b.c(11);for(var c in this.i)if(this.i.hasOwnProperty(c)){var d=new Ka;d.T(c);d.ma(this.i[c].compile(a));H(b,12,d)}return b};
na.prototype.a=function(a){var b=[],c;for(c in this.i)this.i.hasOwnProperty(c)&&b.push("'"+c+"':"+this.i[c].a());b="r.expr({"+b.join(", ")+"})";if(a){if(0===a.length)return P(b);b=a[0].split(":");a.shift();var d=b[1],b=[];for(c in this.i)this.i.hasOwnProperty(c)&&(c===d?b.push(Q("'"+c+"':")+this.i[c].a(a)):b.push(Q("'"+c+"':"+this.i[c].a())));return"        "+b.join("  ")+"  "}return b};function pa(a){this.sb=a}p(pa,z);pa.prototype.compile=function(){var a=new K;a.c(14);E(a,16,this.sb);return a};
function ha(a,b){1>a.length&&a.push("");this.m=a;this.body=b}ha.prototype.a=function(a){return a?Q("function("+this.m.join(", ")+") {return ")+this.body.a(a)+" ":"function("+this.m.join(", ")+") {return "+this.body.a()+"}"};var nb=0;
function ia(a){var b,c;if("function"===typeof a&&!(a instanceof r)){b=[];for(c=0;c<a.length;c++)b.push("arg"+b.length+"_"+nb++);c=a.apply(j,b.map(function(a){return ob(a)}));if(!(c instanceof r))throw new C("ReQL function must return ReQL expression");}else c=arguments[arguments.length-1],b=Array.prototype.slice.call(arguments,0,arguments.length-1);c=q(c);b.forEach(function(a){return w(a,"string")});return y(ha,b,c)}function R(a,b,c,d){this.Ua=a;this.Ba=b;this.za=d||j;this.a=c}p(R,z);
R.prototype.compile=function(a){var b=new L;b.c(this.Ua);this.za&&this.za(b);var c=new Na;E(c,1,b);for(var d in this.Ba)b=this.Ba[d].compile(a),H(c,2,b);a=new K;a.c(3);E(a,4,c);return a};function pb(a,b){z.prototype[b]=function(c){x(arguments,1);c=q(c);return y(R,a,[this,c],qb(b,this,c))}}function rb(a,b){z.prototype[b]=function(c){x(arguments,1);c=q(c);return y(R,Ra,[this,c],qb(b,this,c),function(b){E(b,4,a)})}}pb(14,"add");pb(15,"sub");pb(16,"mul");pb(17,"div");pb(18,"mod");rb(1,"eq");rb(2,"ne");
rb(3,"lt");rb(4,"le");rb(5,"gt");rb(6,"ge");z.prototype.wa=function(){return y(R,1,[this],qb("not",this))};z.prototype.not=z.prototype.wa;z.prototype.count=function(){return y(R,26,[this],qb("count",this))};z.prototype.count=z.prototype.count;z.prototype.Aa=function(a){x(arguments,1);a=q(a);return y(R,36,[this,a],qb("and",this,a))};z.prototype.and=z.prototype.Aa;z.prototype.Ha=function(a){x(arguments,1);a=q(a);return y(R,35,[this,a],qb("or",this,a))};z.prototype.or=z.prototype.Ha;
z.prototype.Ta=function(a,b,c){x(arguments,2);a=q(a);b=q(b);w(c,"string");var d=c?c:"id";return y(R,37,[this],qb("between",this,a,b,"'"+d+"'"),function(c,g){var h=new Ya;h.I(d);var m=a.compile(g);E(h,2,m);m=b.compile(g);E(h,3,m);E(c,11,h)})};z.prototype.between=z.prototype.Ta;z.prototype.append=function(a){x(arguments,1);a=q(a);return y(R,9,[this,a],qb("append",this,a))};z.prototype.append=z.prototype.append;
function sb(a,b,c){b=q(b);c=c?q(c):new oa(j);R.call(this,11,[a,b,c],function(d){if(d){var e=d[0].split(":");e[1]=parseInt(e[1],10);d.shift();return 0===e[1]?a.a(d)+Q(".slice("+b.a()+(c?", "+c.a():"")+")"):1===e[1]?Q(a.a()+".slice(")+b.a(d)+Q((c?", "+c.a():"")+")"):Q(a.a()+".slice("+b.a(d)+", ")+c.a(d)+" "}return a.a()+".slice("+b.a()+(c?", "+c.a():"")+")"})}p(sb,R);z.prototype.slice=function(a,b){x(arguments,1);return y(sb,this,a,b)};z.prototype.slice=z.prototype.slice;
z.prototype.eb=function(a){x(arguments,1);return y(sb,this,0,a)};z.prototype.limit=z.prototype.eb;z.prototype.rb=function(a){x(arguments,1);return y(sb,this,a)};z.prototype.skip=z.prototype.rb;z.prototype.jb=function(a){x(arguments,1);a=q(a);return y(R,28,[this,a],qb("nth",this,a))};z.prototype.nth=z.prototype.jb;
z.prototype.filter=function(a){var b;if("object"===typeof a&&!(a instanceof r)){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(ga(d).eq(t(a[d])));b=y(ha,[""],y(R,36,c,function(a){var b=c.map(function(a){return a.a()});if(a){var d=a[0].split(":");a.shift();b=b.map(Q);b[d[1]]=c[d[1]].a(a);return b.join("      ")}return b.join(").and(")}))}else b=u(a);var e=this;return y(R,20,[this],function(a){if(a){if("predicate"===a[0])return a.shift(),Q(e.a()+".filter(")+b.a(a)+" ";a.shift();return e.a(a)+Q(".filter("+
b.a(a)+")")}return e.a()+".filter("+b.a()+")"},function(a,c){var d=new $a;d.F(b.m[0]);d.q(b.body.compile(c));var e=new Ta;E(e,1,d);E(a,5,e)})};z.prototype.filter=z.prototype.filter;z.prototype.map=function(a){var a=u(a),b=this;return y(R,21,[this],function(c){if(c){if("arg:0"===c[0])return c.shift(),b.a(c)+Q(".map("+a.a(c)+")");c.shift();return Q(b.a()+".map(")+a.a(c)+" "}return b.a()+".map("+a.a()+")"},function(b,d){var e=new M;e.F(a.m[0]);e.q(a.body.compile(d));var g=new Ua;g.B(e);E(b,6,g)})};
z.prototype.map=z.prototype.map;
z.prototype.kb=function(a){x(arguments,1);var b=Array.prototype.slice.call(arguments,0);b.forEach(function(a){w(a,"string")});var c=this;return y(R,23,[this],function(a){var e=b.map(function(a){return"'"+a+"'"});return a?"order_by"===a.shift()?Q(c.a()+".orderby(")+P(e.join(", "))+" ":c.a(a)+Q(".orderby("+e.join(", ")+")"):c.a()+".orderby("+e.join(", ")+")"},function(a){for(var c=0;c<b.length;c++){var g=i,h=b[c];"-"===h[0]&&(g=k,h=h.slice(1));var m=new Wa;m.$(h);E(m,2,g);H(a,8,m)}})};
z.prototype.orderby=z.prototype.kb;z.prototype.Xa=function(a){w(a,"string");var b=a?this.map(ga(a)):this;return y(R,24,[b],function(a){return a?(a.shift(),b.a(a)+"           "):b.a()+".distinct()"})};z.prototype.distinct=z.prototype.Xa;
z.prototype.reduce=function(a,b){x(arguments,2);var a=q(a),b=u(b),c=this;return y(R,31,[this],function(d){if(d)if("reduce"===d[0]){d.shift();if("body"===d[0])return d.shift(),Q(c.a()+".reduce("+a.a()+", ")+b.a(d)+" ";if("base"===d[0])return d.shift(),Q(c.a()+".reduce(")+a.a(d)+Q(", "+b.a()+")")}else return d.shift(),c.a(d)+Q(".reduce("+a.a()+", "+b.a()+")");else return c.a()+".reduce("+a.a()+", "+b.a()+")"},function(c,e){var g=new Za,h=a.compile(e);E(g,1,h);E(g,2,b.m[0]);E(g,3,b.m[1]);g.q(b.body.compile(e));
E(c,9,g)})};z.prototype.reduce=z.prototype.reduce;
z.prototype.Ea=function(a,b,c,d){x(arguments,4);var a=u(a),b=u(b),c=q(c),d=u(d),e=this;return y(R,32,[this],function(g){var h=e.a(),m=a.a(),v=b.a(),s=c.a(),B=d.a();if(g){var ba=g.shift();if("arg:0"===ba)return e.a(g)+Q(".groupedMapReduce("+m+", "+v+", "+s+", "+B+")");if("group_mapping"===ba)return Q(h+".groupedMapReduce(")+a.a(g)+Q(", "+v+", "+s+", "+B+")");if("value_mapping"===ba)return Q(h+".groupedMapReduce("+m+", ")+b.a(g)+Q(", "+s+", "+B+")");ba=g.shift();return"base"===ba?Q(h+".groupedMapReduce("+
m+", "+v+", ")+c.a(g)+Q(", "+B+")"):Q(h+".groupedMapReduce("+m+", "+v+", "+s+", ")+d.a(g)+" "}return h+".groupedMapReduce("+m+", "+v+", "+s+", "+B+")"},function(e,h){var m=new M;m.F(a.m[0]);m.q(a.body.compile(h));var v=new M;v.F(b.m[0]);v.q(b.body.compile(h));var s=new Za,B=c.compile(h);E(s,1,B);E(s,2,d.m[0]);E(s,3,d.m[1]);s.q(d.body.compile(h));B=new Xa;E(B,1,m);E(B,2,v);E(B,3,s);E(e,10,B)})};z.prototype.groupedMapReduce=z.prototype.Ea;
z.prototype.ab=function(a){x(arguments,2);var b=Array.prototype.slice.call(arguments,0,-1);b.forEach(function(a){w(a,"string")});var c=arguments[arguments.length-1];w(c,"object");var d=ia(function(a){return 1<b.length?t(b.map(a)):a(b[0])}),e=c.mapping||ia(function(a){return a}),g=c.base,h=c.reduction;if(!h)throw new C("Must provide a reduction to groupby");if(g===f)throw new C("Must provide a base for the reduction in groupby");var d=this.Ea(d,e,g,h),m=c.finalizer;m&&(d=d.map(function(a){return a.extend({reduction:m(a("reduction"))})}));
return d};z.prototype.groupBy=z.prototype.ab;o("rethinkdb.count",{mapping:function(){return t(1)},base:0,reduction:function(a,b){return a.add(b)}});o("rethinkdb.sum",function(a){x(arguments,1);w(a,"string");return{mapping:function(b){return b(a)},base:0,reduction:function(a,c){return a.add(c)}}});
o("rethinkdb.average",function(a){x(arguments,1);w(a,"string");return{mapping:function(b){return t([b(a),1])},base:[0,0],reduction:function(a,c){return t([a.nth(0).add(c.nth(0)),a.nth(1).add(c.nth(1))])},finalizer:function(a){return a.nth(0).div(a.nth(1))}}});z.prototype.contains=function(a){w(a,"string");var b=this;return y(R,4,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".contains("+a+")"):Q(b.a())+P(".contains("+a+")"):b.a()+".contains("+a+")"},function(b){b.$(a)})};
z.prototype.contains=z.prototype.contains;z.prototype.ia=function(a){w(a,"string");var b=this;return y(R,2,[this],function(c){return c?"arg:0"===c[0]?(c.shift(),b.a(c)):Q(b.a())+P("('"+a+"')"):b.a()+"('"+a+"')"},function(b){b.$(a)})};z.prototype.getAttr=z.prototype.ia;
z.prototype.Ia=function(){var a=Array.prototype.slice.call(arguments,0);n(a)||(a=[a]);a.forEach(function(a){w(a,"string")});var b=this;return y(R,6,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+Q(".pick("+d.join(", ")+")")):b.a()+".pick("+d.join(", ")+")"},function(b){for(var d in a)H(b,3,a[d])})};z.prototype.pick=z.prototype.Ia;
z.prototype.Na=function(a){n(a)||(a=[a]);a.forEach(function(a){w(a,"string")});var b=this;return y(R,39,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+Q(".unpick("+d.join(", ")+")")):b.a()+".unpick("+d.join(", ")+")"},function(b){for(var d in a)H(b,3,a[d])})};z.prototype.unpick=z.prototype.Na;z.prototype.mb=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return z.prototype.Ia.apply(b,a)})};z.prototype.pluck=z.prototype.mb;
z.prototype.xb=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return z.prototype.Na.apply(b,a)})};z.prototype.without=z.prototype.xb;function tb(a){this.Oa=a}p(tb,z);tb.prototype.compile=function(){var a=new K;a.c(1);a.T(this.Oa);return a};tb.prototype.a=function(a){var b="r.letVar('"+this.Oa+"')";return a?P(b):b};function ub(){}p(ub,z);ub.prototype.compile=function(){var a=new K;a.c(15);return a};ub.prototype.a=function(a){return a?"^^^^^^^^":"r.R('@')"};
function vb(a,b){R.call(this,2,[a],function(c){return c?"arg:0"===c.shift()?a.a(c)+"('"+b+"')":Q(a.a())+P("('"+b+"')"):a.a()+"('"+b+"')"},function(a){a.$(b)})}p(vb,R);function ga(a){w(a,"string");var a=a.split("."),b=a.shift();"@"===b[0]&&1<b.length?a.unshift(b.slice(1)):"@"!==b[0]&&a.unshift(b);for(var c=y(ub);b=a.shift();)c=y(vb,c,b);return c}o("rethinkdb.R",ga);function ob(a){w(a,"string");for(var a=a.split("."),b=a.shift(),c=y(tb,b);b=a.shift();)c=y(vb,c,b);return c}o("rethinkdb.letVar",ob);
z.prototype.extend=function(a){var a=q(a),b=this;return y(R,8,[this,a],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".extend("+a.a()+")"):Q(b.a()+".extend(")+a.a(c)+" ":b.a()+".extend("+a.a()+")"})};z.prototype.extend=z.prototype.extend;
z.prototype.Ma=function(a){x(arguments,1);var b=Array.prototype.slice.call(arguments,0).map(q),c=this;return y(R,27,[this].concat(b),function(a){var e=b.map(function(a){return a.a()});if(a){var g=a.shift();if(g){if("arg:0"===g)return c.a(a)+Q(".union("+e.join(", ")+")");g=parseInt(g.split(":")[1],10);e=e.map(Q);e[g]=b[g].a(a);return Q(c.a()+".union(")+e.join("  ")+" "}return P(c.a()+".union("+e.join(", ")+")")}return c.a()+".union("+e.join(", ")+")"})};z.prototype.union=z.prototype.Ma;
z.prototype.O=function(a){var a=u(a),b=this;return y(R,22,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".concatMap("+a.a()+")"):Q(b.a()+".concatMap(")+a.a(c)+" ":b.a()+".concatMap("+a.a()+")"},function(b,d){var e=new M;e.F(a.m[0]);e.q(a.body.compile(d));var g=new Va;g.B(e);E(b,7,g)})};z.prototype.concatMap=z.prototype.O;function wb(a,b,c){this.na=a;this.oa=b;this.ga=c}p(wb,z);
wb.prototype.compile=function(a){var b=new Oa,c=this.na.compile(a);E(b,1,c);c=this.oa.compile(a);E(b,2,c);a=this.ga.compile(a);E(b,3,a);a=new K;a.c(4);E(a,5,b);return a};wb.prototype.a=function(a){if(a){var b=a.shift(),c=Q(this.na.a()),d=Q(this.oa.a()),e=Q(this.ga.a());"test"===b?c=this.na.a(a):"true"===b?d=this.oa.a(a):e=this.ga.a(a);return"             "+c+"  "+d+"  "+e+" "}return"r.ifThenElse("+this.na.a()+", "+this.oa.a()+", "+this.ga.a()+")"};
function xb(a,b,c){w(b,r);w(c,r);a=q(a);return y(wb,a,b,c)}o("rethinkdb.ifThenElse",xb);function yb(a,b){this.N=a;this.pa=b}p(yb,z);yb.prototype.compile=function(a){var b=new Ma,c;for(c in this.N)if(this.N.hasOwnProperty(c)){var d=this.N[c],e=new Ka;e.T(c);e.ma(d.compile(a));H(b,1,e)}a=this.pa.compile(a);E(b,2,a);a=new K;a.c(2);E(a,3,b);return a};
yb.prototype.a=function(a){var b=[],c;for(c in this.N)this.N.hasOwnProperty(c)&&b.push([c,this.N[c]]);if(a){var d=a.shift().split(":")[1],b=b.map(function(b){return b[0]===d?Q("'"+b[0]+"':")+b[1].a(a):Q("'"+b[0]+"':"+b[1].a())});return Q("r.let({")+b.join("  ")+Q("}, "+this.pa.a()+")")}b=b.map(function(a){return"'"+a[0]+"':"+a[1].a()});return"r.let({"+b.join(", ")+"}, "+this.pa.a()+")"};function zb(a,b){w(b,r);for(var c in a)a.hasOwnProperty(c)&&w(a[c],z);return y(yb,a,b)}o("rethinkdb.let",zb);
function Ab(a,b){this.va=a;this.ha=b}p(Ab,r);Ab.prototype.o=function(a){var b=new eb,c=this.va.compile(a);E(b,1,c);b.T(this.ha.m[0]);a=this.ha.body.o(a);a=G(a,4);if(!a)throw new C("For each requires a write query to execute");H(b,3,a);a=new N;a.c(6);E(a,7,b);b=new D;b.c(2);E(b,4,a);return b};Ab.prototype.a=function(a){return a?(a.shift(),this.va.a(a)+Q(".forEach("+this.ha.a()+")")):this.va.a()+".forEach("+this.ha.a()+")"};z.prototype.forEach=function(a){a=u(a);return y(Ab,this,a)};
z.prototype.forEach=z.prototype.forEach;z.prototype.bb=function(a,b){return this.O(function(c){return a.O(function(a){return xb(b(c,a),t([{left:c,right:a}]),t([]))})})};z.prototype.innerJoin=z.prototype.bb;z.prototype.lb=function(a,b){return this.O(function(c){return zb({matches:a.O(function(a){return xb(b(c,a),t([{left:c,right:a}]),t([]))}).Ka()},xb(ob("matches").count().gt(0),ob("matches"),t([{left:c}])))})};z.prototype.outerJoin=z.prototype.lb;
z.prototype.Za=function(a,b){return this.O(function(c){return zb({right:b.get(c(a))},xb(ob("right").ne(t(j)),t([{left:c,right:ob("right")}]),t([])))})};z.prototype.equiJoin=z.prototype.Za;z.prototype.yb=function(){return this.map(function(a){return xb(a.contains("right"),a("left").extend(a("right")),a("left"))})};z.prototype.zip=z.prototype.yb;z.prototype.Ka=function(){var a=this;return y(R,29,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".streamToArray()"})};
z.prototype.streamToArray=z.prototype.Ka;z.prototype.Sa=function(){var a=this;return y(R,30,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".arrayToStream()"})};z.prototype.arrayToStream=z.prototype.Sa;function A(a,b,c){this.v=a;this.z=b;this.Ra="boolean"===typeof c?c:j}p(A,z);A.prototype.compile=function(a){var b=new K;b.c(13);var c=new Qa,d=new J;d.aa(this.z||qa.z);E(d,2,this.v);E(d,3,this.Ra!==j?this.Zc:a&&a.Ca!==f?a.Ca:k);c.r(d);E(b,15,c);return b};A.prototype.a=function(a){return a?this.z?P("r.db('"+this.z+"').table('"+this.v+"')"):P("r.table('"+this.v+"')"):this.z?"r.db('"+this.z+"').table('"+this.v+"')":"r.table('"+this.v+"')"};function Bb(a,b,c){this.f=a;this.j=b;this.g=c||"id"}p(Bb,z);
Bb.prototype.compile=function(a){var b=this.f.compile(a),c=G(b,15).A(),b=new Pa;b.r(c);b.I(this.g);b.M(this.j.compile(a));a=new K;a.c(12);E(a,14,b);return a};Bb.prototype.a=function(a){if(a){var b=a.shift();return"key"===b?Q(this.f.a()+".get(")+this.j.a(a)+Q(", '"+this.g+"')"):"attrname"===b?Q(this.f.a()+".get("+this.j.a()+", ")+P("'"+this.g+"'")+" ":this.f.a(a)+Q(".get("+this.j.a()+", '"+this.g+"')")}return this.f.a()+".get("+this.j.a()+", '"+this.g+"')"};
A.prototype.get=function(a,b){x(arguments,1);a=q(a);return y(Bb,this,a,b)};A.prototype.get=A.prototype.get;function Cb(a,b){this.f=a;this.ea=b}p(Cb,r);Cb.prototype.o=function(a){var b=this.f.compile(a),c=G(b,15).A(),b=new db;b.r(c);for(c=0;c<this.ea.length;c++){var d=this.ea[c].compile(a);H(b,2,d)}a=new N;a.c(4);E(a,5,b);b=new D;b.c(2);E(b,4,a);return b};
Cb.prototype.a=function(a){var b=this.ea.map(function(a){return a.a()});if(a){var b=b.map(Q),c=a.shift(),d;c!==f?(d=Q(this.f.a()),c=parseInt(c.split(":")[1],10),b[c]=this.ea[c].a(a)):d=this.f.a(a);a=" "+b.join("  ")+" ";return d+"        "+a+" "}a="["+b.join(", ")+"]";return this.f.a()+".insert("+a+")"};A.prototype.cb=function(a){x(arguments,1);n(a)||(a=[a]);a=a.map(t);return new Cb(this,a)};A.prototype.insert=A.prototype.cb;function Db(a){this.t=a}p(Db,r);
Db.prototype.o=function(a){var b=new bb;b.ba(this.t.compile(a));a=new N;a.c(2);E(a,3,b);b=new D;b.c(2);E(b,4,a);return b};Db.prototype.a=function(a){return a?(a.shift(),this.t.a(a)+"      "):this.t.a()+".del()"};function Eb(a,b,c){this.f=a;this.j=b;this.g=c||"id"}p(Eb,r);Eb.prototype.o=function(a){var b=new gb;b.r(La(this.f.compile(a)).A());b.I(this.g);b.M(this.j.compile(a));a=new N;a.c(8);E(a,9,b);b=new D;b.c(2);E(b,4,a);return b};
Eb.prototype.a=function(a){return a?a.shift()!==f?Q(this.f.a()+".get(")+this.j.a(a)+"       ":this.f.a(a)+Q(".get("+this.j.a()+").del()"):this.f.a()+".get("+this.j.a()+").del()"};z.prototype.Va=function(){return this instanceof Bb?new Eb(this.f,this.j,this.g):new Db(this)};z.prototype.del=z.prototype.Va;function Fb(a,b){this.t=a;this.k=b}p(Fb,r);
Fb.prototype.o=function(a){var b=new M;b.F(this.k.m[0]);b.q(this.k.body.compile(a));var c=new ab;c.ba(this.t.compile(a));c.B(b);a=new N;a.c(1);E(a,2,c);c=new D;c.c(2);E(c,4,a);return c};Fb.prototype.a=function(a){return a?"view"===a.shift()?this.t.a(a)+Q(".update("+this.k.a()+")"):Q(this.t.a()+".update(")+this.k.a(a)+" ":this.t.a()+".update("+this.k.a()+")"};function Gb(a,b,c,d){this.f=a;this.j=b;this.g=c||"id";this.k=d}p(Gb,r);
Gb.prototype.o=function(a){var b=new M;b.F(this.k.m[0]);b.q(this.k.body.compile(a));var c=new fb;c.r(La(this.f.compile(a)).A());c.I(this.g);c.M(this.j.compile(a));c.B(b);a=new N;a.c(7);E(a,8,c);c=new D;c.c(2);E(c,4,a);return c};
Gb.prototype.a=function(a){if(a){var b=a.shift();return b===f?this.f.a(a)+Q(".get("+this.j.a()+", '"+this.g+"').update("+this.k.a()+")"):"key"===b?Q(this.f.a()+".get(")+this.j.a(a)+Q(", '"+this.g+"').update("+this.k.a()+")"):"keyname"===b?Q(this.f.a()+".get("+this.j.a()+", ")+P("'"+this.g+"'")+Q(").update("+this.k.a()+")"):Q(this.f.a()+".get("+this.j.a()+", '"+this.g+"').update(")+this.k.a(a)+" "}return this.f.a()+".get("+this.j.a()+", '"+this.g+"').update("+this.k.a()+")"};
z.prototype.update=function(a){x(arguments,1);a=u(a);return this instanceof Bb?new Gb(this.f,this.j,this.g,a):new Fb(this,a)};z.prototype.update=z.prototype.update;function Hb(a,b){this.t=a;this.k=b}p(Hb,r);Hb.prototype.o=function(a){var b=new M;b.F(this.k.m[0]);b.q(this.k.body.compile(a));var c=new cb;c.ba(this.t.compile(a));c.B(b);a=new N;a.c(3);E(a,4,c);c=new D;c.c(2);E(c,4,a);return c};
Hb.prototype.a=function(a){return a?"view"===a.shift()?this.t.a(a)+Q(".mutate("+this.k.a()+")"):Q(this.t.a()+".mutate(")+this.k.a(a)+" ":this.t.a()+".mutate("+this.k.a()+")"};function Ib(a,b,c,d){this.f=a;this.j=b;this.g=c||"id";this.k=d}p(Ib,r);Ib.prototype.o=function(a){var b=new M;b.F(this.k.m[0]);b.q(this.k.body.compile(a));var c=new hb;c.r(La(this.f.compile(a)).A());c.I(this.g);c.M(this.j.compile(a));c.B(b);a=new N;a.c(9);E(a,10,c);c=new D;c.c(2);E(c,4,a);return c};
Ib.prototype.a=function(a){if(a){var b=a.shift();return b===f?this.f.a(a)+Q(".get("+this.j.a()+", '"+this.g+"').mutate("+this.k.a()+")"):"key"===b?Q(this.f.a()+".get(")+this.j.a(a)+Q(", '"+this.g+"').mutate("+this.k.a()+")"):"keyname"===b?Q(this.f.a()+".get("+this.j.a()+", ")+P("'"+this.g+"'")+Q(").mutate("+this.k.a()+")"):Q(this.f.a()+".get("+this.j.a()+", '"+this.g+"').mutate(")+this.k.a(a)+" "}return this.f.a()+".get("+this.j.a()+", '"+this.g+"').mutate("+this.k.a()+")"};
z.prototype.hb=function(a){x(arguments,1);a=u(a);return this instanceof Bb?new Ib(this.f,this.j,this.g,a):new Hb(this,a)};z.prototype.mutate=z.prototype.hb;function Jb(){}Jb.prototype.Da=function(a,b){return 11==a.p||10==a.p?Kb(this,b):b};function Lb(a,b){this.h=a|0;this.d=b|0}var Mb={};function Nb(a){if(-128<=a&&128>a){var b=Mb[a];if(b)return b}b=new Lb(a|0,0>a?-1:0);-128<=a&&128>a&&(Mb[a]=b);return b}function S(a){return isNaN(a)||!isFinite(a)?Ob:a<=-Pb?T:a+1>=Pb?Qb:0>a?U(S(-a)):new Lb(a%Rb|0,a/Rb|0)}function V(a,b){return new Lb(a,b)}var Rb=4294967296,Pb=Rb*Rb/2,Ob=Nb(0),Sb=Nb(1),Tb=Nb(-1),Qb=V(-1,2147483647),T=V(0,-2147483648),Ub=Nb(16777216);l=Lb.prototype;
l.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(Vb(this))return"0";if(0>this.d){if(this.n(T)){var b=S(a),c=Wb(this,b),b=Xb(c.multiply(b),this);return c.toString(a)+b.h.toString(a)}return"-"+U(this).toString(a)}for(var c=S(Math.pow(a,6)),b=this,d="";;){var e=Wb(b,c),g=Xb(b,e.multiply(c)).h.toString(a),b=e;if(Vb(b))return g+d;for(;6>g.length;)g="0"+g;d=""+g+d}};function Yb(a){return 0<=a.h?a.h:Rb+a.h}function Vb(a){return 0==a.d&&0==a.h}
l.n=function(a){return this.d==a.d&&this.h==a.h};function Zb(a,b){if(a.n(b))return 0;var c=0>a.d,d=0>b.d;return c&&!d?-1:!c&&d?1:0>Xb(a,b).d?-1:1}function U(a){return a.n(T)?T:a.wa().add(Sb)}l.add=function(a){var b=this.d>>>16,c=this.d&65535,d=this.h>>>16,e=a.d>>>16,g=a.d&65535,h=a.h>>>16,m;m=0+((this.h&65535)+(a.h&65535));a=0+(m>>>16);a+=d+h;d=0+(a>>>16);d+=c+g;c=0+(d>>>16);return V((a&65535)<<16|m&65535,(c+(b+e)&65535)<<16|d&65535)};function Xb(a,b){return a.add(U(b))}
l.multiply=function(a){if(Vb(this)||Vb(a))return Ob;if(this.n(T))return 1==(a.h&1)?T:Ob;if(a.n(T))return 1==(this.h&1)?T:Ob;if(0>this.d)return 0>a.d?U(this).multiply(U(a)):U(U(this).multiply(a));if(0>a.d)return U(this.multiply(U(a)));if(0>Zb(this,Ub)&&0>Zb(a,Ub))return S((this.d*Rb+Yb(this))*(a.d*Rb+Yb(a)));var b=this.d>>>16,c=this.d&65535,d=this.h>>>16,e=this.h&65535,g=a.d>>>16,h=a.d&65535,m=a.h>>>16,a=a.h&65535,v,s,B,ba;ba=0+e*a;B=0+(ba>>>16);B+=d*a;s=0+(B>>>16);B=(B&65535)+e*m;s+=B>>>16;s+=c*a;
v=0+(s>>>16);s=(s&65535)+d*m;v+=s>>>16;s=(s&65535)+e*h;v+=s>>>16;return V((B&65535)<<16|ba&65535,(v+(b*a+c*m+d*h+e*g)&65535)<<16|s&65535)};
function Wb(a,b){if(Vb(b))throw Error("division by zero");if(Vb(a))return Ob;if(a.n(T)){if(b.n(Sb)||b.n(Tb))return T;if(b.n(T))return Sb;var c=Wb($b(a,1),b).shiftLeft(1);if(c.n(Ob))return 0>b.d?Sb:Tb;var d=Xb(a,b.multiply(c));return c.add(Wb(d,b))}if(b.n(T))return Ob;if(0>a.d)return 0>b.d?Wb(U(a),U(b)):U(Wb(U(a),b));if(0>b.d)return U(Wb(a,U(b)));for(var e=Ob,d=a;0<=Zb(d,b);){for(var c=Math.max(1,Math.floor((d.d*Rb+Yb(d))/(b.d*Rb+Yb(b)))),g=Math.ceil(Math.log(c)/Math.LN2),g=48>=g?1:Math.pow(2,g-48),
h=S(c),m=h.multiply(b);0>m.d||0<Zb(m,d);)c-=g,h=S(c),m=h.multiply(b);Vb(h)&&(h=Sb);e=e.add(h);d=Xb(d,m)}return e}l.wa=function(){return V(~this.h,~this.d)};l.Aa=function(a){return V(this.h&a.h,this.d&a.d)};l.Ha=function(a){return V(this.h|a.h,this.d|a.d)};function ac(a,b){return V(a.h^b.h,a.d^b.d)}l.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.h;return 32>a?V(b<<a,this.d<<a|b>>>32-a):V(0,b<<a-32)};
function $b(a,b){b&=63;if(0==b)return a;var c=a.d;return 32>b?V(a.h>>>b|c<<32-b,c>>b):V(c>>b-32,0<=c?0:-1)};function bc(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}function cc(a){return new Uint8Array(Array.prototype.map.call(a,function(a){return a.charCodeAt(0)}))}function dc(){this.u=0}p(dc,Jb);function W(a){throw new ua("Error deserializing incorrectly formated message, "+a);}
function Kb(a,b){for(var c=Ea(b.ja()),d=[],e=0,g=0;g<c.length;g++){var h=c[g];if(Fa(b,h.s)){var m=0;do{var v=a.Da(h,b.get(h,m));d.push(v);e+=v.byteLength;m++}while(h.X&&m<Ja(b,h.s))}}c=new Uint8Array(e);for(g=e=0;g<d.length;g++)h=d[g],c.set(new Uint8Array(h),e),e+=h.byteLength;return c}
dc.prototype.Da=function(a,b){var c=a.p,d=ec[c],e=fc(S(a.s<<3|d)),g;switch(d){case X:var h=S(b);if(c==Aa||17==c)h=ac(h.shiftLeft(1),$b(h,63));g=fc(h);break;case gc:h=new ArrayBuffer(8);c=new DataView(h);switch(a.p){case 1:c.setFloat64(0,b,i);break;case ya:g=S(b);c.setUint32(0,Yb(g),i);c.setUint32(4,g.d,i);break;case za:g=S(b);c.setUint32(0,Yb(g),i);c.setInt32(4,g.d,i);break;default:W("Unexpected field type")}g=new Uint8Array(h);break;case hc:switch(a.p){case 11:h=Kb(this,b);break;case 9:h=cc(unescape(encodeURIComponent(b)));
break;case 12:h=cc(b);break;default:W("Unexpected field type")}g=h.length;c=fc(S(g));g=new Uint8Array(c.length+g);g.set(c,0);g.set(h,c.length);break;case ic:W("Use of Groups deprecated and not supported");break;case jc:h=new ArrayBuffer(4);c=new DataView(h);switch(a.p){case 2:c.setFloat32(0,b,i);break;case 7:c.setUint32(0,b,i);break;case 15:c.setInt32(0,b,i);break;default:W("Unexpected field type")}g=new Uint8Array(h);break;default:W("Unexpected wire type")}h=new Uint8Array(e.length+g.length);h.set(new Uint8Array(e),
0);h.set(new Uint8Array(g),e.length);return h};function fc(a){function b(a){var d=S(128),d=Xb(a,Wb(a,d).multiply(d)).h,e=S(127);0<Zb(a,e)?(d+=128,a=b($b(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function kc(a,b,c){var d=b.ja();for(a.u=0;a.u<c.length;){var e=lc(a,c),g=d.H[parseInt(e>>3,10)]||j,h=a,m=e%8,v=g,e=c,s=f;switch(m){case X:e=lc(h,e);if(v){h=f;switch(v.p){case wa:case xa:h=e.toString();break;case 5:case 13:case 14:h=e;break;case 17:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).h;break;case Aa:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).toString();break;case 8:h=0===h?k:i;break;default:W("Unexpected field type")}s=h}else s=j;break;case hc:m=e;e=lc(h,m);m=new Uint8Array(m.buffer,m.byteOffset+h.u,e);
h.u+=e;if(v){e=f;switch(v.p){case 9:e=decodeURIComponent(escape(bc(m)));break;case 12:e=bc(m);break;case 11:e=m;h=new dc;v=new v.Ga.P.fb;kc(h,v,e);e=v;break;default:W("Unexpected field type")}s=e}else s=j;break;case jc:e=new DataView(e.buffer,h.u,4);h.u+=4;if(v){h=f;switch(v.p){case 2:h=e.getFloat32(0,i);break;case 7:h=e.getUint32(0,i);break;case 15:h=e.getInt32(0,i);break;default:W("Unexpected field type")}s=h}else s=j;break;case gc:e=new DataView(e.buffer,h.u,8);h.u+=8;if(v){h=f;switch(v.p){case 1:h=
e.getFloat64(0,i);break;case ya:h=(new Lb(e.getUint32(0,i),e.getUint32(4,i))).toString();break;case za:h=(new Lb(e.getUint32(0,i),e.getInt32(4,i))).toString();break;default:W("Unexpected field type")}s=h}else s=j;break;default:W("Unexpected wire type of "+m)}e=s;g!=j&&e!=j&&(g.X?b.add(g,e):b.set(g,e))}}function lc(a,b){var c=b[a.u++];if(127<c)var c=c-128,d=lc(a,b),c=c+(d<<7);return c}var X=0,gc=1,hc=2,ic=3,jc=5,ec=[-1,gc,jc,X,X,X,gc,jc,X,hc,ic,hc,hc,X,X,jc,gc,X,X];function mc(a){this.name="Runtime Error";this.message=a||"The RDB runtime experienced an error"}p(mc,Error);function nc(a){this.name="Broken Client";this.message=a||"The client sent the server an incorrectly formatted message"}p(nc,Error);function oc(a){this.name="Bad Query";this.message=a||"This query contains type errors"}p(oc,Error);function C(a){this.name="RDB Client Error";this.message=a||"The RDB client has experienced an error"}p(C,Error);
function qb(a,b,c){var d=Array.prototype.slice.call(arguments,2);return function(c){var g=d.map(function(a){return a instanceof r?a.a():a.toString()}),h=b.a()+"."+a+"("+g.join(", ")+")";if(c){if(0===c.length)return P(h);h=c.shift();"lowerbound"===h?h="arg:1":"upperbound"===h&&(h="arg:2");var m=h.split(":");if("arg"===m[0])return m[1]=parseInt(m[1],10),g=g.map(Q),0===m[1]?h=b.a(c):(h=Q(b.a()),m=m[1]-1,c=d[m].a(c),g[m]=c),g=g.join("  "),h+" "+Q(a)+" "+g+" "}else return h}}
function Q(a){return a.replace(/./g," ")}function P(a){return a.replace(/./g,"^")};function pc(a,b,c){this.ra=a;this.nb=b;this.vb=c;this.Y=[];this.ua=k;this.da=j;this.ca=k}pc.prototype.close=function(){delete this.ra.Q[this.vb]};pc.prototype.next=function(a){var b=this.Y.shift();b===f?this.ua?a(b):(this.da=fa(this.next,this,a),this.ca&&qc(this.ra),this.ca=k):a(b)&&this.next(a)};pc.prototype.next=pc.prototype.next;pc.prototype.qa=function(a){this.ua?a(this.Y.splice(0,this.Y.length)):(this.da=fa(this.qa,this,a),this.ca&&qc(this.ra),this.ca=k)};pc.prototype.collect=pc.prototype.qa;
function rc(a,b,c){n(b)?Array.prototype.push.apply(a.Y,b):a.Y.push(b);a.ua=c;a.ca=i;a.da&&a.da()};function Y(a,b){"undefined"===typeof a?a={}:"string"===typeof a&&(a={host:a});this.ka=a.host||this.Qa;this.la=a.port||this.ya;this.z=a.db||this.Pa;w(this.ka,"string");w(this.la,"number");w(this.z,"string");this.Q={};this.ib=1;this.fa=b||j;qa=this}Y.prototype.Qa="localhost";Y.prototype.ya=12346;Y.prototype.Pa="test";Y.prototype.ob=function(a){this.constructor.call(this,{host:this.ka,port:this.la,db:this.z},a,this.fa)};Y.prototype.reconnect=Y.prototype.ob;
function Z(a,b){if(a.fa)a.fa(b);else if(a.ed)console.log(b.name+":"+b.message);else throw b;}Y.prototype.qb=function(a){this.fa=a};Y.prototype.setErrorHandler=Y.prototype.qb;function sc(a,b){var c=Kb(new dc,b),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,i);e.set(c,4);a.Ja(e.buffer)}Y.prototype.S=function(a,b){x(arguments,1);var c=a.o({Ca:k});c.xa((this.ib++).toString());var d=new pc(this,a,c.L());this.Q[c.L()]=d;sc(this,c);b&&d.next(b);return d};Y.prototype.run=Y.prototype.S;
function tc(a,b){(new DataView(b.buffer)).getUint32(0,i)!==b.length-4&&Z(a,new C("RDB response corrupted, length inaccurate"));var c=new dc,d=new kb;try{kc(c,d,new Uint8Array(b.buffer,4))}catch(e){Z(a,new C("response deserialization failed"))}if(c=a.Q[d.L()])switch(G(d,1)){case 101:var g=new nc(G(d,4));rc(c,g,i);break;case 103:var g=c.nb,h=G(d,4),d=G(d,5),m=[];d&&(m=Ia(d,1));g=h+"\n\t"+g.a()+"\n\t"+g.a(m);g=new mc(g);rc(c,g,i);break;case 102:g=new oc(G(d,4));rc(c,g,i);break;case 0:delete a.Q[d.L()];
rc(c,[],i);break;case 3:delete a.Q[d.L()];g=Ia(d,3).map(JSON.parse);rc(c,g,i);break;case 1:delete a.Q[d.L()];g=JSON.parse(G(d,3,0));rc(c,g,i);break;case 2:g=Ia(d,3).map(JSON.parse);rc(c,g,k);break;default:g=new C("unknown response status code"),rc(c,g,i)}}Y.prototype.wb=function(a){x(arguments,1);w(a,"string");this.z=a};Y.prototype.use=Y.prototype.wb;Y.prototype.$a=function(){return this.z};Y.prototype.getDefaultDb=Y.prototype.$a;function qc(a){var b=new D;b.c(3);b.xa(f);sc(a,b)};function uc(a,b){this.La=a;this.w=b||j}p(uc,r);uc.prototype.o=function(){var a=new O;a.c(this.La);this.w&&a.aa(this.w);var b=new D;b.c(5);E(b,5,a);return b};uc.prototype.a=function(a){var b=this.w?"'"+this.w+"'":"",c,d="";switch(this.La){case 1:c="dbCreate";break;case 2:c="dbDrop";break;case 3:c="dbList";break;case 6:c="db",d=".list()"}b="r."+c+"("+b+")";return a?P(b)+Q(d):b+d};o("rethinkdb.dbCreate",function(a){x(arguments,1);w(a,"string");return new uc(1,a)});
o("rethinkdb.dbDrop",function(a){x(arguments,1);w(a,"string");return new uc(2,a)});o("rethinkdb.dbList",function(){return new uc(3)});function $(a){this.v=a}o("rethinkdb.db",function(a){x(arguments,1);w(a,"string");return new $(a)});$.prototype.list=function(){return new uc(6,this.v)};$.prototype.list=$.prototype.list;function vc(a,b,c,d,e){this.W=a;this.w=b;this.J=c;this.g=d;this.V=e}p(vc,r);
vc.prototype.o=function(){var a=new J;a.aa(this.w);E(a,2,this.J);var b=new ib;this.W&&E(b,1,this.W);b.r(a);this.g&&E(b,4,this.g);this.V&&E(b,5,this.V);a=new O;a.c(4);E(a,3,b);b=new D;b.c(5);E(b,5,a);return b};
vc.prototype.a=function(a){var b;this.W||this.g||this.V?(b=[],this.W&&b.push("dataCenter: '"+this.W+"'"),this.g&&b.push("primaryKey: '"+this.g+"'"),this.V&&b.push("cacheSize: '"+this.V+"'"),this.J&&b.push("tableName: '"+this.J+"'"),b="{"+b.join(", ")+"}"):b="'"+this.J+"'";b="r.db('"+this.w+"').create("+b+")";return a?P(b):b};
$.prototype.create=function(a){x(arguments,1);var b={};"string"===typeof a?b.tableName=a:b=a;w(b.tableName,"string");w(b.primaryKey,"string");w(b.dataCenter,"string");w(b.cacheSize,"string");return new vc(b.dataCenter,this.v,b.tableName,b.primaryKey,b.cacheSize)};$.prototype.create=$.prototype.create;function wc(a,b){x(arguments,1);this.w=a;this.J=b}p(wc,r);wc.prototype.o=function(){var a=new J;a.aa(this.w);E(a,2,this.J);var b=new O;b.c(5);E(b,4,a);a=new D;a.c(5);E(a,5,b);return a};
wc.prototype.a=function(a){return a?P("r.db('"+this.w+"').drop('"+this.J+"')"):"r.db('"+this.w+"').drop('"+this.J+"')"};$.prototype.Ya=function(a){x(arguments,1);w(a,"string");return new wc(this.v,a)};$.prototype.drop=$.prototype.Ya;$.prototype.tb=function(a,b){x(arguments,1);w(a,"string");w(b,"boolean");return new A(a,this.v,b)};$.prototype.table=$.prototype.tb;function xc(a,b,c){w(b,"function");w(c,"function");Y.call(this,a,c);this.U="";var d=this,e="http://"+this.ka+":"+this.la+"/ajax/reql/",g=new XMLHttpRequest;g.responseType="arraybuffer";g.open("GET",e+"open-new-connection",i);g.onreadystatechange=function(){4===g.readyState&&(200===g.status?(d.U=e,d.sa=(new DataView(g.response)).getInt32(0,i),b&&b(d)):Z(d,new C("Unabled to establish HTTP connection")))};g.send()}p(xc,Y);o("rethinkdb.HttpConnection",xc);xc.prototype.ya=21300;
xc.prototype.Ja=function(a){this.U||Z(this,new C("Connection not open"));var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.U+"?conn_id="+this.sa,i);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&tc(c,new Uint8Array(b.response))};b.send(a)};xc.prototype.close=function(){this.U||Z(this,new C("Connection not open"));var a=new XMLHttpRequest;a.open("POST",this.U+"close-connection?conn_id="+this.sa,i);a.send();this.U=this.sa=j};xc.prototype.close=xc.prototype.close;function yc(a,b,c){zc()||Z(this,new C("Cannot instantiate TcpConnection, TCP sockets are not available in this environment."));w(b,"function");w(c,"function");Y.call(this,a,c);this.R=j;this.fd=0;this.G=j;var d=this;d.G=j;var e=require("net").connect(this.la,this.ka,function(){e.write("35ba61af","hex");e.on("data",fa(d.ub,d));e.on("end",function(){d.G=j;Z(d,new mc("Server disconnected"))});d.G=e;b&&b(d)});e.on("error",function(){Z(d,new C("Unabled to establish TCP connection"))})}p(yc,Y);
o("rethinkdb.TcpConnection",yc);function zc(){return"undefined"!==typeof require&&require("net")}yc.isAvailable=zc;yc.prototype.Ja=function(a){this.G||Z(this,new C("Connection not open"));for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.G.write(b)};
yc.prototype.ub=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.R===j){var d=(new DataView(a.buffer,b,c)).getUint32(0,i);this.R=new Uint8Array(d+4);this.Z=0}var d=this.R.byteLength-this.Z,e=c<d?c:d,g=new Uint8Array(a.buffer,b,e);this.R.set(g,this.Z);this.Z+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.R,this.R=j,this.Z=0,tc(this,d))}};
yc.prototype.close=function(){this.G||Z(this,new C("Connection not open"));var a=this;this.G.removeAllListeners("end");this.G.on("close",function(){a.G=j});this.G.end()};yc.prototype.close=yc.prototype.close;o("rethinkdb.connect",function(a,b,c){return zc()?new yc(a,b,c):new xc(a,b,c)});var qa=j;o("rethinkdb.getLastConnection",function(){return qa});"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
