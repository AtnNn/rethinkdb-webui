(function(){
var f=void 0,g=!0,j=null,k=!1,m,aa=this;
function ca(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function n(a){return"array"==ca(a)}Math.floor(2147483648*Math.random()).toString(36);function da(a,b,c){return a.call.apply(a.bind,arguments)}function ea(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function fa(a,b,c){fa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?da:ea;return fa.apply(j,arguments)}function o(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==f?d[e]=b:d=d[e]?d[e]:d[e]={}}function p(a,b){function c(){}c.prototype=b.prototype;a.Vc=b.prototype;a.prototype=new c;a.prototype.constructor=a};aa.rethinkdb=function(a){return ga(a)};function q(a){return a instanceof r?a:ha(a)}function u(a){return a instanceof ia?a:ja(a)}function v(a,b){if(a){var c=b;n(b)||(c=[c]);if(!c.some(function(b){return"string"===typeof b?typeof a===b:a instanceof b})){if(n(b))throw new TypeError("Function argument "+a+" must be one of the types "+b);throw new TypeError("Function argument "+a+" must be of the type "+b);}}}
function w(a,b){if(a.length<b)throw new TypeError("Function requires at least "+b+" argument"+(1<b?"s.":"."));}function x(a){function b(a){return y.prototype.Z.call(b,a)}var c=arguments[0],d=Array.prototype.slice.call(arguments,1);b.__proto__=c.prototype;c.apply(b,d);return b};function ha(a){if(!(a instanceof y))if("number"==typeof a)a=x(ka,a);else if("boolean"==typeof a)a=x(la,a);else if("string"==typeof a)a=x(ma,a);else if(n(a))a=x(na,a);else var b=typeof a,a="object"==b&&a!=j||"function"==b?x(oa,a):x(pa,a);return a}o("rethinkdb.expr",ha);o("rethinkdb.js",function(a){w(arguments,1);v(a,"string");return x(qa,a)});o("rethinkdb.table",function(a){w(arguments,1);v(a,"string");return x(z,a)});function r(){}
r.prototype.ea=function(a,b){b=b||ra;if(!b)throw new A("No connection specified and no last connection to default to");b.ea(this,a)};r.prototype.run=r.prototype.ea;r.prototype.fa=function(){if(!ra)throw new A("No last connection to use");ra.fa(this)};r.prototype.runp=r.prototype.fa;r.prototype.ba=function(a,b){var c=ra;if(!c)throw new A("No last connection to use");c.ba(this,a,b)};r.prototype.iter=r.prototype.ba;r.prototype.a=function(){return"----"};function sa(){}p(sa,r);
sa.prototype.k=function(){var a=new ta,b=this.compile();a.ga(b);b=new B;b.c(ua);C(b,3,a);return b};function va(a){Error.captureStackTrace?Error.captureStackTrace(this,va):this.stack=Error().stack||"";a&&(this.message=String(a))}p(va,Error);va.prototype.name="CustomError";function wa(a,b,c){this.Tc=a;this.p=b;this.r=c.name;this.P=!!c.A;this.Sc=!!c.required;this.m=c.b;this.Ca=c.type;this.Ra=k;switch(this.m){case xa:case ya:case za:case Aa:case Ba:this.Ra=g}this.la=c.defaultValue}var xa=3,ya=4,za=6,Aa=16,Ba=18;var Ca=Array.prototype;function Da(a,b){return a>b?1:a<b?-1:0};function Ea(a,b,c){this.Ya=a;this.r=b.name||j;this.Rc=b.e||j;this.Pc=b.h;this.F={};for(a=0;a<c.length;a++)b=c[a],this.F[b.p]=b}function Fa(a){var a=a.F,b=[],c=0,d;for(d in a)b[c++]=a[d];Ca.sort.call(b,function(a,b){return a.p-b.p}||Da);return b};function D(){this.w={};this.K=this.constructor.K;this.F=this.K.F;this.H=this.Ba=j}m=D.prototype;m.$=function(){return this.K};m.get=function(a,b){return E(this,a.p,b)};m.set=function(a,b){C(this,a.p,b)};m.add=function(a,b){F(this,a.p,b)};
m.j=function(a){if(!a||this.constructor!=a.constructor)return k;for(var b=Fa(this.$()),c=0;c<b.length;c++){var d=b[c];if(Ga(this,d.p)!=Ga(a,d.p))return k;if(Ga(this,d.p)){var e=11==d.m||10==d.m,i=Ha(this,d),h=Ha(a,d);if(d.P){if(i.length!=h.length)return k;for(d=0;d<i.length;d++)if(!(e?i[d].j(h[d]):i[d]==h[d]))return k}else if(!(e?i.j(h):i==h))return k}}return g};function Ga(a,b){return b in a.w&&a.w[b]!==f&&a.w[b]!==j}
function Ha(a,b){var c=b.p;if(!c in a.w)return j;var d=a.w[c];return d==j?j:a.Ba?!(c in a.H)?(d=a.Ba.Qc(a,b,d),a.H[c]=d):a.H[c]:d}function E(a,b,c){b=a.F[b];a=Ha(a,b);if(b.P)return n(a),a[c||0];n(a);return a}function G(a,b){var c;if(Ga(a,b))c=E(a,b,f);else{c=a.F[b];if(c.la===f){var d=c.Ca;c.la=d===Boolean?k:d===Number?0:d===String?"":new d}c=c.la}return c}function Ia(a,b){var c=Ha(a,a.F[b]);c==j||n(c);return c||[]}
function Ja(a,b){return a.F[b].P?(Ga(a,b)&&n(a.w[b]),Ga(a,b)?a.w[b].length:0):Ga(a,b)?1:0}function C(a,b,c){a.w[b]=c;a.H&&(a.H[b]=c)}function F(a,b,c){a.w[b]||(a.w[b]=[]);a.w[b].push(c);a.H&&delete a.H[b]}function H(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new wa(a,e,b[e])));a.K=new Ea(a,d,c);a.$=function(){return a.K}};function I(){D.apply(this)}p(I,D);I.prototype.T=function(a){C(this,1,a)};function Ka(){D.apply(this)}p(Ka,D);Ka.prototype.N=function(a){C(this,1,a)};Ka.prototype.ga=function(a){C(this,2,a)};function J(){D.apply(this)}p(J,D);J.prototype.c=function(a){C(this,1,a)};J.prototype.N=function(a){C(this,2,a)};function La(a){return G(a,15)}function Ma(){D.apply(this)}p(Ma,D);function Na(){D.apply(this)}p(Na,D);function Oa(){D.apply(this)}p(Oa,D);function Pa(){D.apply(this)}p(Pa,D);
Pa.prototype.t=function(){return G(this,1)};Pa.prototype.o=function(a){C(this,1,a)};Pa.prototype.G=function(a){C(this,2,a)};Pa.prototype.I=function(a){C(this,3,a)};function Qa(){D.apply(this)}p(Qa,D);Qa.prototype.t=function(){return G(this,1)};Qa.prototype.o=function(a){C(this,1,a)};function L(){D.apply(this)}p(L,D);L.prototype.c=function(a){C(this,1,a)};L.prototype.Z=function(){return E(this,2)};L.prototype.S=function(a){C(this,2,a)};
var Ra=19,Sa={nc:1,Nb:2,Tb:3,Rb:4,Ub:5,sc:6,Vb:7,hc:8,tb:9,Ac:11,pb:14,Ec:15,kc:16,Fb:17,jc:18,yb:Ra,Kb:20,gc:21,zb:22,rc:23,Eb:24,bc:26,Kc:27,oc:28,Cc:29,ub:30,yc:31,Pb:32,rb:35,qb:36,wc:37,Xb:38,Nc:39};function Ta(){D.apply(this)}p(Ta,D);function Ua(){D.apply(this)}p(Ua,D);Ua.prototype.v=function(a){C(this,1,a)};function Va(){D.apply(this)}p(Va,D);Va.prototype.v=function(a){C(this,1,a)};function Wa(){D.apply(this)}p(Wa,D);Wa.prototype.Z=function(){return E(this,1)};
Wa.prototype.S=function(a){C(this,1,a)};function Xa(){D.apply(this)}p(Xa,D);function Ya(){D.apply(this)}p(Ya,D);Ya.prototype.G=function(a){C(this,1,a)};function Za(){D.apply(this)}p(Za,D);Za.prototype.n=function(a){C(this,4,a)};function M(){D.apply(this)}p(M,D);M.prototype.B=function(a){C(this,1,a)};M.prototype.n=function(a){C(this,2,a)};function $a(){D.apply(this)}p($a,D);$a.prototype.B=function(a){C(this,1,a)};$a.prototype.n=function(a){C(this,2,a)};function ta(){D.apply(this)}p(ta,D);
ta.prototype.ga=function(a){C(this,1,a)};function N(){D.apply(this)}p(N,D);N.prototype.c=function(a){C(this,1,a)};function ab(){D.apply(this)}p(ab,D);ab.prototype.U=function(a){C(this,1,a)};ab.prototype.v=function(a){C(this,2,a)};function bb(){D.apply(this)}p(bb,D);bb.prototype.U=function(a){C(this,1,a)};function cb(){D.apply(this)}p(cb,D);cb.prototype.U=function(a){C(this,1,a)};cb.prototype.v=function(a){C(this,2,a)};function db(){D.apply(this)}p(db,D);db.prototype.t=function(){return G(this,1)};
db.prototype.o=function(a){C(this,1,a)};function eb(){D.apply(this)}p(eb,D);eb.prototype.N=function(a){C(this,2,a)};function fb(){D.apply(this)}p(fb,D);m=fb.prototype;m.t=function(){return G(this,1)};m.o=function(a){C(this,1,a)};m.G=function(a){C(this,2,a)};m.I=function(a){C(this,3,a)};m.v=function(a){C(this,4,a)};function gb(){D.apply(this)}p(gb,D);gb.prototype.t=function(){return G(this,1)};gb.prototype.o=function(a){C(this,1,a)};gb.prototype.G=function(a){C(this,2,a)};
gb.prototype.I=function(a){C(this,3,a)};function hb(){D.apply(this)}p(hb,D);m=hb.prototype;m.t=function(){return G(this,1)};m.o=function(a){C(this,1,a)};m.G=function(a){C(this,2,a)};m.I=function(a){C(this,3,a)};m.v=function(a){C(this,4,a)};function O(){D.apply(this)}p(O,D);O.prototype.c=function(a){C(this,1,a)};O.prototype.T=function(a){C(this,2,a)};function ib(){D.apply(this)}p(ib,D);ib.prototype.t=function(){return G(this,3)};ib.prototype.o=function(a){C(this,3,a)};function B(){D.apply(this)}
p(B,D);B.prototype.c=function(a){C(this,1,a)};B.prototype.L=function(){return E(this,2)};B.prototype.Aa=function(){return G(this,2)};B.prototype.pa=function(a){C(this,2,a)};var ua=1,jb={xc:ua,Oc:2,Ab:3,Bc:4,ic:5};function kb(){D.apply(this)}p(kb,D);kb.prototype.L=function(){return E(this,2)};kb.prototype.Aa=function(){return G(this,2)};kb.prototype.pa=function(a){C(this,2,a)};function lb(){D.apply(this)}p(lb,D);
H(I,{"0":{name:"TableRef",e:"TableRef"},1:{name:"db_name",b:9,type:String},2:{name:"table_name",b:9,type:String},3:{name:"use_outdated",b:8,defaultValue:0,type:Boolean}});H(Ka,{"0":{name:"VarTermTuple",e:"VarTermTuple"},1:{name:"var",b:9,type:String},2:{name:"term",b:11,type:J}});
H(J,{"0":{name:"Term",e:"Term"},1:{name:"type",b:14,defaultValue:0,type:{$b:0,Mc:1,cc:2,xb:3,Sb:4,Jb:5,pc:6,Dc:7,JSON:8,BOOL:9,sb:10,qc:11,Ob:12,Jc:13,Zb:14,Wb:15}},2:{name:"var",b:9,type:String},3:{name:"let",b:11,type:Ma},4:{name:"call",b:11,type:Na},5:{name:"if_",b:11,type:Oa},6:{name:"error",b:9,type:String},7:{name:"number",b:1,type:Number},8:{name:"valuestring",b:9,type:String},9:{name:"jsonstring",b:9,type:String},10:{name:"valuebool",b:8,type:Boolean},11:{name:"array",A:g,b:11,type:J},12:{name:"object",
A:g,b:11,type:Ka},14:{name:"get_by_key",b:11,type:Pa},15:{name:"table",b:11,type:Qa},16:{name:"javascript",b:9,type:String}});H(Ma,{"0":{name:"Let",h:J,e:"Term.Let"},1:{name:"binds",A:g,b:11,type:Ka},2:{name:"expr",b:11,type:J}});H(Na,{"0":{name:"Call",h:J,e:"Term.Call"},1:{name:"builtin",b:11,type:L},2:{name:"args",A:g,b:11,type:J}});H(Oa,{"0":{name:"If",h:J,e:"Term.If"},1:{name:"test",b:11,type:J},2:{name:"true_branch",b:11,type:J},3:{name:"false_branch",b:11,type:J}});
H(Pa,{"0":{name:"GetByKey",h:J,e:"Term.GetByKey"},1:{name:"table_ref",b:11,type:I},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:J}});H(Qa,{"0":{name:"Table",h:J,e:"Term.Table"},1:{name:"table_ref",b:11,type:I}});
H(L,{"0":{name:"Builtin",e:"Builtin"},1:{name:"type",b:14,defaultValue:1,type:Sa},2:{name:"attr",b:9,type:String},3:{name:"attrs",A:g,b:9,type:String},4:{name:"comparison",b:14,defaultValue:1,type:{Ib:1,mc:2,fc:3,ac:4,Qb:5,Mb:6}},5:{name:"filter",b:11,type:Ta},6:{name:"map",b:11,type:Ua},7:{name:"concat_map",b:11,type:Va},8:{name:"order_by",A:g,b:11,type:Wa},9:{name:"reduce",b:11,type:Za},10:{name:"grouped_map_reduce",b:11,type:Xa},11:{name:"range",b:11,type:Ya}});
H(Ta,{"0":{name:"Filter",h:L,e:"Builtin.Filter"},1:{name:"predicate",b:11,type:$a}});H(Ua,{"0":{name:"Map",h:L,e:"Builtin.Map"},1:{name:"mapping",b:11,type:M}});H(Va,{"0":{name:"ConcatMap",h:L,e:"Builtin.ConcatMap"},1:{name:"mapping",b:11,type:M}});H(Wa,{"0":{name:"OrderBy",h:L,e:"Builtin.OrderBy"},1:{name:"attr",b:9,type:String},2:{name:"ascending",b:8,defaultValue:1,type:Boolean}});
H(Xa,{"0":{name:"GroupedMapReduce",h:L,e:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",b:11,type:M},2:{name:"value_mapping",b:11,type:M},3:{name:"reduction",b:11,type:Za}});H(Ya,{"0":{name:"Range",h:L,e:"Builtin.Range"},1:{name:"attrname",b:9,type:String},2:{name:"lowerbound",b:11,type:J},3:{name:"upperbound",b:11,type:J}});H(Za,{"0":{name:"Reduction",e:"Reduction"},1:{name:"base",b:11,type:J},2:{name:"var1",b:9,type:String},3:{name:"var2",b:9,type:String},4:{name:"body",b:11,type:J}});
H(M,{"0":{name:"Mapping",e:"Mapping"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:J}});H($a,{"0":{name:"Predicate",e:"Predicate"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:J}});H(ta,{"0":{name:"ReadQuery",e:"ReadQuery"},1:{name:"term",b:11,type:J},2:{name:"max_chunk_size",b:3,type:String},3:{name:"max_age",b:3,type:String}});
H(N,{"0":{name:"WriteQuery",e:"WriteQuery"},1:{name:"type",b:14,defaultValue:1,type:{Lc:1,Db:2,lc:3,Yb:4,Lb:6,vc:7,tc:8,uc:9}},2:{name:"update",b:11,type:ab},3:{name:"delete",b:11,type:bb},4:{name:"mutate",b:11,type:cb},5:{name:"insert",b:11,type:db},7:{name:"for_each",b:11,type:eb},8:{name:"point_update",b:11,type:fb},9:{name:"point_delete",b:11,type:gb},10:{name:"point_mutate",b:11,type:hb}});
H(ab,{"0":{name:"Update",h:N,e:"WriteQuery.Update"},1:{name:"view",b:11,type:J},2:{name:"mapping",b:11,type:M}});H(bb,{"0":{name:"Delete",h:N,e:"WriteQuery.Delete"},1:{name:"view",b:11,type:J}});H(cb,{"0":{name:"Mutate",h:N,e:"WriteQuery.Mutate"},1:{name:"view",b:11,type:J},2:{name:"mapping",b:11,type:M}});H(db,{"0":{name:"Insert",h:N,e:"WriteQuery.Insert"},1:{name:"table_ref",b:11,type:I},2:{name:"terms",A:g,b:11,type:J},3:{name:"overwrite",b:8,defaultValue:0,type:Boolean}});
H(eb,{"0":{name:"ForEach",h:N,e:"WriteQuery.ForEach"},1:{name:"stream",b:11,type:J},2:{name:"var",b:9,type:String},3:{name:"queries",A:g,b:11,type:N}});H(fb,{"0":{name:"PointUpdate",h:N,e:"WriteQuery.PointUpdate"},1:{name:"table_ref",b:11,type:I},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:J},4:{name:"mapping",b:11,type:M}});H(gb,{"0":{name:"PointDelete",h:N,e:"WriteQuery.PointDelete"},1:{name:"table_ref",b:11,type:I},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:J}});
H(hb,{"0":{name:"PointMutate",h:N,e:"WriteQuery.PointMutate"},1:{name:"table_ref",b:11,type:I},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:J},4:{name:"mapping",b:11,type:M}});H(O,{"0":{name:"MetaQuery",e:"MetaQuery"},1:{name:"type",b:14,defaultValue:1,type:{Bb:1,Gb:2,dc:3,Cb:4,Hb:5,ec:6}},2:{name:"db_name",b:9,type:String},3:{name:"create_table",b:11,type:ib},4:{name:"drop_table",b:11,type:I}});
H(ib,{"0":{name:"CreateTable",h:O,e:"MetaQuery.CreateTable"},1:{name:"datacenter",b:9,type:String},3:{name:"table_ref",b:11,type:I},4:{name:"primary_key",b:9,defaultValue:"id",type:String},5:{name:"cache_size",b:3,defaultValue:"1073741824",type:String}});H(B,{"0":{name:"Query",e:"Query"},1:{name:"type",b:14,defaultValue:ua,type:jb},2:{name:"token",b:3,type:String},3:{name:"read_query",b:11,type:ta},4:{name:"write_query",b:11,type:N},5:{name:"meta_query",b:11,type:O}});
H(kb,{"0":{name:"Response",e:"Response"},1:{name:"status_code",b:14,defaultValue:0,type:{Fc:0,Gc:1,Hc:2,Ic:3,wb:101,vb:102,zc:103}},2:{name:"token",b:3,type:String},3:{name:"response",A:g,b:9,type:String},4:{name:"error_message",b:9,type:String},5:{name:"backtrace",b:11,type:lb}});H(lb,{"0":{name:"Backtrace",h:kb,e:"Response.Backtrace"},1:{name:"frame",A:g,b:9,type:String}});function y(){}p(y,sa);function mb(a){this.Za=a||""}p(mb,y);mb.prototype.compile=function(){var a=new J;a.c(5);C(a,6,this.Za);return a};mb.prototype.a=function(a){return a?"^^^^^^^^^":"r.error()"};o("rethinkdb.error",function(){return new mb});function pa(a){this.g=a}p(pa,y);pa.prototype.compile=function(){var a=new J;a.c(8);var b=JSON.stringify(this.g);C(a,9,b);return a};function ka(a){this.g="undefined"===typeof a?j:a}p(ka,y);
ka.prototype.compile=function(){var a=new J;this.g===j?a.c(0):(a.c(6),C(a,7,this.g));return a};ka.prototype.a=function(a){var b="r.expr("+this.g+")";return a?P(b):b};function la(a){this.g=a}p(la,y);la.prototype.compile=function(){var a=new J;a.c(9);C(a,10,this.g);return a};la.prototype.a=function(a){var b="r.expr("+this.g+")";return a?P(b):b};function ma(a){this.g=a}p(ma,y);ma.prototype.compile=function(){var a=new J;a.c(7);C(a,8,this.g);return a};
ma.prototype.a=function(a){var b="r.expr('"+this.g+"')";return a?P(b):b};function na(a){this.g=[];for(var b=0;b<a.length;b++){var c=q(a[b]);this.g.push(c)}}p(na,y);na.prototype.compile=function(){var a=new J;a.c(10);for(var b=0;b<this.g.length;b++){var c=this.g[b].compile();F(a,11,c)}return a};
na.prototype.a=function(a){var b=this.g.map(function(a){return a.a()});if(a){if(0===a.length)return P("r.expr(["+b.join(", ")+"])");var c=a[0].split(":");a.shift();c=parseInt(c[1],10);b=b.map(Q);b[c]=this.g[c].a(a);return"        "+b.join("  ")+"  "}return"r.expr(["+b.join(", ")+"])"};function oa(a){this.g={};for(var b in a)if(a.hasOwnProperty(b)){var c=q(a[b]);this.g[b]=c}}p(oa,y);
oa.prototype.compile=function(){var a=new J;a.c(11);for(var b in this.g)if(this.g.hasOwnProperty(b)){var c=new Ka;c.N(b);c.ga(this.g[b].compile());F(a,12,c)}return a};
oa.prototype.a=function(a){var b=[],c;for(c in this.g)this.g.hasOwnProperty(c)&&b.push("'"+c+"':"+this.g[c].a());b="r.expr({"+b.join(", ")+"})";if(a){if(0===a.length)return P(b);b=a[0].split(":");a.shift();var d=b[1],b=[];for(c in this.g)this.g.hasOwnProperty(c)&&(c===d?b.push(Q("'"+c+"':")+this.g[c].a(a)):b.push(Q("'"+c+"':"+this.g[c].a())));return"        "+b.join("  ")+"  "}return b};function qa(a){this.jb=a}p(qa,y);qa.prototype.compile=function(){var a=new J;a.c(14);C(a,16,this.jb);return a};
function ia(a,b){1>a.length&&a.push("");this.i=a;this.body=b}ia.prototype.a=function(a){return a?Q("function("+this.i.join(", ")+") {return ")+this.body.a(a)+" ":"function("+this.i.join(", ")+") {return "+this.body.a()+"}"};
function ja(a){var b,c;if("function"===typeof a&&!(a instanceof r)){b=[];for(c=0;c<a.length;c++)b.push("arg"+b.length);c=a.apply(j,b.map(function(a){return nb(a)}));if(!(c instanceof r))throw new A("ReQL function must return ReQL expression");}else c=arguments[arguments.length-1],b=Array.prototype.slice.call(arguments,0,arguments.length-1);c=q(c);b.forEach(function(a){return v(a,"string")});return x(ia,b,c)}function R(a,b,c,d){this.Oa=a;this.ua=b;this.sa=d||j;this.a=c}p(R,y);
R.prototype.compile=function(){var a=new L;a.c(this.Oa);this.sa&&this.sa(a);var b=new Na;C(b,1,a);for(var c in this.ua)a=this.ua[c].compile(),F(b,2,a);c=new J;c.c(3);C(c,4,b);return c};function ob(a,b){y.prototype[b]=function(c){w(arguments,1);c=q(c);return x(R,a,[this,c],pb(b,this,c))}}function qb(a,b){y.prototype[b]=function(c){w(arguments,1);c=q(c);return x(R,Ra,[this,c],pb(b,this,c),function(b){C(b,4,a)})}}ob(14,"add");ob(15,"sub");ob(16,"mul");ob(17,"div");ob(18,"mod");qb(1,"eq");qb(2,"ne");
qb(3,"lt");qb(4,"le");qb(5,"gt");qb(6,"ge");y.prototype.ma=function(){return x(R,1,[this],pb("not",this))};y.prototype.not=y.prototype.ma;y.prototype.count=function(){return x(R,26,[this],pb("count",this))};y.prototype.count=y.prototype.count;y.prototype.ta=function(a){w(arguments,1);a=q(a);return x(R,36,[this,a],pb("and",this,a))};y.prototype.and=y.prototype.ta;y.prototype.Da=function(a){w(arguments,1);a=q(a);return x(R,35,[this,a],pb("or",this,a))};y.prototype.or=y.prototype.Da;
y.prototype.Ma=function(a,b,c){w(arguments,2);a=q(a);b=q(b);v(c,"string");var d=c?c:"id";return x(R,37,[this],pb("between",this,a,b,d),function(c){var i=new Ya;i.G(d);var h=a.compile();C(i,2,h);h=b.compile();C(i,3,h);C(c,11,i)})};y.prototype.between=y.prototype.Ma;y.prototype.append=function(a){w(arguments,1);a=q(a);return x(R,9,[this,a],pb("append",this,a))};y.prototype.append=y.prototype.append;
function rb(a,b,c){b=q(b);c=c?q(c):new pa(j);R.call(this,11,[a,b,c],function(d){if(d){var e=d[0].split(":");e[1]=parseInt(e[1],10);d.shift();return 0===e[1]?a.a(d)+Q(".slice("+b.a()+(c?", "+c.a():"")+")"):1===e[1]?Q(a.a()+".slice(")+b.a(d)+Q((c?", "+c.a():"")+")"):Q(a.a()+".slice("+b.a(d)+", ")+c.a(d)+" "}return a.a()+".slice("+b.a()+(c?", "+c.a():"")+")"})}p(rb,R);y.prototype.slice=function(a,b){w(arguments,1);return x(rb,this,a,b)};y.prototype.slice=y.prototype.slice;
y.prototype.Xa=function(a){w(arguments,1);return x(rb,this,0,a)};y.prototype.limit=y.prototype.Xa;y.prototype.ib=function(a){w(arguments,1);return x(rb,this,a)};y.prototype.skip=y.prototype.ib;y.prototype.bb=function(a){w(arguments,1);a=q(a);return x(R,28,[this,a],pb("nth",this,a))};y.prototype.nth=y.prototype.bb;
y.prototype.filter=function(a){var b;if("object"===typeof a&&!(a instanceof r)){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(ga(d).eq(ha(a[d])));b=x(ia,[""],x(R,36,c,function(a){var b=c.map(function(a){return a.a()});if(a){var d=a[0].split(":");a.shift();b=b.map(Q);b[d[1]]=c[d[1]].a(a);return b.join("      ")}return b.join(").and(")}))}else b=u(a);var e=this;return x(R,20,[this],function(a){if(a){if("predicate"===a[0])return a.shift(),Q(e.a()+".filter(")+b.a(a)+" ";a.shift();return e.a(a)+Q(".filter("+
b.a(a)+")")}return e.a()+".filter("+b.a()+")"},function(a){var c=new $a;c.B(b.i[0]);c.n(b.body.compile());var d=new Ta;C(d,1,c);C(a,5,d)})};y.prototype.filter=y.prototype.filter;y.prototype.map=function(a){var a=u(a),b=this;return x(R,21,[this],function(c){if(c){if("arg:0"===c[0])return c.shift(),b.a(c)+Q(".map("+a.a(c)+")");c.shift();return Q(b.a()+".map(")+a.a(c)+" "}return b.a()+".map("+a.a()+")"},function(b){var d=new M;d.B(a.i[0]);d.n(a.body.compile());var e=new Ua;e.v(d);C(b,6,e)})};
y.prototype.map=y.prototype.map;y.prototype.cb=function(a){w(arguments,1);var b=Array.prototype.slice.call(arguments,0);b.forEach(function(a){v(a,"string")});var c=this;return x(R,23,[this],function(a){var e=b.map(function(a){return"'"+a+"'"});return a?(a.shift(),c.a(a)+Q(".orderby("+e.join(", ")+")")):c.a()+".orderby("+e.join(", ")+")"},function(a){for(var c=0;c<b.length;c++){var i=g,h=b[c];"-"===h[0]&&(i=k,h=h.slice(1));var l=new Wa;l.S(h);C(l,2,i);F(a,8,l)}})};y.prototype.orderby=y.prototype.cb;
y.prototype.Sa=function(a){v(a,"string");var b=a?this.map(ga(a)):this;return x(R,24,[b],function(a){return a?(a.shift(),b.a(a)+"           "):b.a()+".distinct()"})};y.prototype.distinct=y.prototype.Sa;
y.prototype.reduce=function(a,b){w(arguments,2);var a=q(a),b=u(b),c=this;return x(R,31,[this],function(d){if(d)if("reduce"===d[0]){d.shift();if("body"===d[0])return d.shift(),Q(c.a()+".reduce("+a.a()+", ")+b.a(d)+" ";if("base"===d[0])return d.shift(),Q(c.a()+".reduce(")+a.a(d)+Q(", "+b.a()+")")}else return d.shift(),c.a(d)+Q(".reduce("+a.a()+", "+b.a()+")");else return c.a()+".reduce("+a.a()+", "+b.a()+")"},function(c){var e=new Za,i=a.compile();C(e,1,i);C(e,2,b.i[0]);C(e,3,b.i[1]);e.n(b.body.compile());
C(c,9,e)})};y.prototype.reduce=y.prototype.reduce;
y.prototype.Ua=function(a,b,c,d){w(arguments,4);var a=u(a),b=u(b),c=q(c),d=u(d),e=this;return x(R,32,[this],function(i){var h=e.a(),l=a.a(),t=b.a(),s=c.a(),K=d.a();if(i){var ba=i.shift();if("arg:0"===ba)return e.a(i)+Q(".groupedMapReduce("+l+", "+t+", "+s+", "+K+")");if("group_mapping"===ba)return Q(h+".groupedMapReduce(")+a.a(i)+Q(", "+t+", "+s+", "+K+")");if("value_mapping"===ba)return Q(h+".groupedMapReduce("+l+", ")+b.a(i)+Q(", "+s+", "+K+")");ba=i.shift();return"base"===ba?Q(h+".groupedMapReduce("+
l+", "+t+", ")+c.a(i)+Q(", "+K+")"):Q(h+".groupedMapReduce("+l+", "+t+", "+s+", ")+d.a(i)+" "}return h+".groupedMapReduce("+l+", "+t+", "+s+", "+K+")"},function(e){var h=new M;h.B(a.i[0]);h.n(a.body.compile());var l=new M;l.B(b.i[0]);l.n(b.body.compile());var t=new Za,s=c.compile();C(t,1,s);C(t,2,d.i[0]);C(t,3,d.i[1]);t.n(d.body.compile());s=new Xa;C(s,1,h);C(s,2,l);C(s,3,t);C(e,10,s)})};y.prototype.groupedMapReduce=y.prototype.Ua;
y.prototype.contains=function(a){v(a,"string");var b=this;return x(R,4,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".contains("+a+")"):Q(b.a())+P(".contains("+a+")"):b.a()+".contains("+a+")"},function(b){b.S(a)})};y.prototype.contains=y.prototype.contains;y.prototype.Z=function(a){v(a,"string");var b=this;return x(R,2,[this],function(c){return c?"arg:0"===c[0]?(c.shift(),b.a(c)):Q(b.a())+P("('"+a+"')"):b.a()+"('"+a+"')"},function(b){b.S(a)})};y.prototype.getAttr=y.prototype.Z;
y.prototype.Ea=function(){var a=Array.prototype.slice.call(arguments,0);n(a)||(a=[a]);a.forEach(function(a){v(a,"string")});var b=this;return x(R,6,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+Q(".pick("+d.join(", ")+")")):b.a()+".pick("+d.join(", ")+")"},function(b){for(var d in a)F(b,3,a[d])})};y.prototype.pick=y.prototype.Ea;
y.prototype.Ha=function(a){n(a)||(a=[a]);a.forEach(function(a){v(a,"string")});var b=this;return x(R,39,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+Q(".unpick("+d.join(", ")+")")):b.a()+".unpick("+d.join(", ")+")"},function(b){for(var d in a)F(b,3,a[d])})};y.prototype.unpick=y.prototype.Ha;y.prototype.eb=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return y.prototype.Ea.apply(b,a)})};y.prototype.pluck=y.prototype.eb;
y.prototype.ob=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return y.prototype.Ha.apply(b,a)})};y.prototype.without=y.prototype.ob;function sb(a){this.Ia=a}p(sb,y);sb.prototype.compile=function(){var a=new J;a.c(1);a.N(this.Ia);return a};sb.prototype.a=function(a){var b="r.letVar('"+this.Ia+"')";return a?P(b):b};function tb(){}p(tb,y);tb.prototype.compile=function(){var a=new J;a.c(15);return a};tb.prototype.a=function(a){return a?"^^^^^^^^":"r.R('@')"};
function ub(a,b){R.call(this,2,[a],function(c){return c?"arg:0"===c.shift()?a.a(c)+"('"+b+"')":Q(a.a())+P("('"+b+"')"):a.a()+"('"+b+"')"},function(a){a.S(b)})}p(ub,R);function ga(a){v(a,"string");var a=a.split("."),b=a.shift();"@"===b[0]&&1<b.length?a.unshift(b.slice(1)):"@"!==b[0]&&a.unshift(b);for(var c=x(tb);b=a.shift();)c=x(ub,c,b);return c}o("rethinkdb.R",ga);function nb(a){v(a,"string");for(var a=a.split("."),b=a.shift(),c=x(sb,b);b=a.shift();)c=x(ub,c,b);return c}o("rethinkdb.letVar",nb);
y.prototype.extend=function(a){var a=q(a),b=this;return x(R,8,[this,a],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".extend("+a.a()+")"):Q(b.a()+".extend(")+a.a(c)+" ":b.a()+".extend("+a.a()+")"})};y.prototype.extend=y.prototype.extend;
y.prototype.Pa=function(a){var a=u(a),b=this;return x(R,22,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+Q(".concatMap("+a.a()+")"):Q(b.a()+".concatMap(")+a.a(c)+" ":b.a()+".concatMap("+a.a()+")"},function(b){var d=new M;d.B(a.i[0]);d.n(a.body.compile());var e=new Va;e.v(d);C(b,7,e)})};y.prototype.concatMap=y.prototype.Pa;function vb(a,b,c){this.ha=a;this.ia=b;this.Y=c}p(vb,y);
vb.prototype.compile=function(){var a=new Oa,b=this.ha.compile();C(a,1,b);b=this.ia.compile();C(a,2,b);b=this.Y.compile();C(a,3,b);b=new J;b.c(4);C(b,5,a);return b};vb.prototype.a=function(a){if(a){var b=a.shift(),c=Q(this.ha.a()),d=Q(this.ia.a()),e=Q(this.Y.a());"test"===b?c=this.ha.a(a):"true"===b?d=this.ia.a(a):e=this.Y.a(a);return"             "+c+"  "+d+"  "+e+" "}return"r.ifThenElse("+this.ha.a()+", "+this.ia.a()+", "+this.Y.a()+")"};
o("rethinkdb.ifThenElse",function(a,b,c){v(b,r);v(c,r);a=q(a);return x(vb,a,b,c)});function wb(a,b){this.ja=a;this.Na=b}p(wb,y);wb.prototype.compile=function(){var a=new Ma,b;for(b in this.ja)if(this.ja.hasOwnProperty(b)){var c=this.ja[b],d=new Ka;d.N(b);d.ga(c.compile());F(a,1,d)}b=this.Na.compile();C(a,2,b);b=new J;b.c(2);C(b,3,a);return b};o("rethinkdb.let",function(a,b){v(b,r);for(var c in a)a.hasOwnProperty(c)&&v(a[c],y);return x(wb,a,b)});function xb(a,b){this.Wa=a;this.ya=b}p(xb,r);
xb.prototype.k=function(){var a=new eb,b=this.Wa.compile();C(a,1,b);a.N(this.ya.i[0]);b=this.ya.body.k();b=E(b,4);if(!b)throw new A("For each requires a write query to execute");F(a,3,b);b=new N;b.c(6);C(b,7,a);a=new B;a.c(2);C(a,4,b);return a};y.prototype.forEach=function(a){a=u(a);return x(xb,this,a)};y.prototype.forEach=y.prototype.forEach;y.prototype.kb=function(){var a=this;return x(R,29,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".streamToArray()"})};
y.prototype.streamToArray=y.prototype.kb;y.prototype.La=function(){var a=this;return x(R,30,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".arrayToStream()"})};y.prototype.arrayToStream=y.prototype.La;function z(a,b){this.D=b||j;this.r=a}p(z,y);z.prototype.compile=function(){var a=new J;a.c(13);var b=new Qa,c=new I;c.T(this.D||ra.D);C(c,2,this.r);b.o(c);C(a,15,b);return a};z.prototype.a=function(a){return a?this.D?P("r.db("+this.D+").table("+this.r+")"):P("r.table("+this.r+")"):this.D?"r.db("+this.D+").table("+this.r+")":"r.table("+this.r+")"};function yb(a,b){this.s=a;this.z=b}p(yb,y);
yb.prototype.compile=function(){var a=this.s.compile(),b=E(a,15).t(),a=new Pa;a.o(b);a.G("id");a.I(this.z.compile());b=new J;b.c(12);C(b,14,a);return b};z.prototype.get=function(a){w(arguments,1);a=q(a);return x(yb,this,a)};z.prototype.get=z.prototype.get;function zb(a,b){this.s=a;this.xa=b}p(zb,r);zb.prototype.k=function(){var a=this.s.compile(),b=E(a,15).t(),a=new db;a.o(b);for(b=0;b<this.xa.length;b++){var c=this.xa[b].compile();F(a,2,c)}b=new N;b.c(4);C(b,5,a);a=new B;a.c(2);C(a,4,b);return a};
z.prototype.Va=function(a){w(arguments,1);n(a)||(a=[a]);a=a.map(ha);return new zb(this,a)};z.prototype.insert=z.prototype.Va;function Ab(a){this.V=a}p(Ab,r);Ab.prototype.k=function(){var a=new bb;a.U(this.V.compile());var b=new N;b.c(2);C(b,3,a);a=new B;a.c(2);C(a,4,b);return a};function Bb(a,b){this.s=a;this.z=b}p(Bb,r);Bb.prototype.k=function(){var a=new gb;a.o(La(this.s.compile()).t());a.G("id");a.I(this.z.compile());var b=new N;b.c(8);C(b,9,a);a=new B;a.c(2);C(a,4,b);return a};
y.prototype.Qa=function(){return this instanceof yb?new Bb(this.s,this.z):new Ab(this)};y.prototype.del=y.prototype.Qa;function Cb(a,b){this.V=a;this.u=b}p(Cb,r);Cb.prototype.k=function(){var a=new M;a.B(this.u.i[0]);a.n(this.u.body.compile());var b=new ab;b.U(this.V.compile());b.v(a);a=new N;a.c(1);C(a,2,b);b=new B;b.c(2);C(b,4,a);return b};function Db(a,b,c){this.s=a;this.z=b;this.u=c}p(Db,r);
Db.prototype.k=function(){var a=new M;a.B(this.u.i[0]);a.n(this.u.body.compile());var b=new fb;b.o(La(this.s.compile()).t());b.G("id");b.I(this.z.compile());b.v(a);a=new N;a.c(7);C(a,8,b);b=new B;b.c(2);C(b,4,a);return b};y.prototype.update=function(a){w(arguments,1);a=u(a);return this instanceof yb?new Db(this.s,this.z,a):new Cb(this,a)};y.prototype.update=y.prototype.update;function Eb(a,b){this.V=a;this.u=b}p(Eb,r);
Eb.prototype.k=function(){var a=new M;a.B(this.u.i[0]);a.n(this.u.body.compile());var b=new cb;b.U(this.V.compile());b.v(a);a=new N;a.c(3);C(a,4,b);b=new B;b.c(2);C(b,4,a);return b};function Fb(a,b,c){this.s=a;this.z=b;this.u=c}p(Fb,r);Fb.prototype.k=function(){var a=new M;a.B(this.u.i[0]);a.n(this.u.body.compile());var b=new hb;b.o(La(this.s.compile()).t());b.G("id");b.I(this.z.compile());b.v(a);a=new N;a.c(9);C(a,10,b);b=new B;b.c(2);C(b,4,a);return b};
y.prototype.$a=function(a){w(arguments,1);a=u(a);return this instanceof yb?new Fb(this.s,this.z,a):new Eb(this,a)};y.prototype.mutate=y.prototype.$a;function Gb(a){this.name="Runtime Error";this.message=a||"The RDB runtime experienced an error"}p(Gb,Error);function Hb(a){this.name="Broken Client";this.message=a||"The client sent the server an incorrectly formatted message"}p(Hb,Error);function Ib(a){this.name="Bad Query";this.message=a||"This query contains type errors"}p(Ib,Error);function A(a){this.name="RDB Client Error";this.message=a||"The RDB client has experienced an error"}p(A,Error);
function pb(a,b,c){var d=Array.prototype.slice.call(arguments,2);return function(c){var i=d.map(function(a){return a instanceof r?a.a():a.toString()}),h=b.a()+"."+a+"("+i.join(", ")+")";if(c){if(0===c.length)return P(h);var l=c[0].split(":");c.shift();if("arg"===l[0])return l[1]=parseInt(l[1],10),i=i.map(Q),0===l[1]?h=b.a(c):(h=Q(b.a()),l=l[1]-1,c=d[l].a(c),i[l]=c),i=i.join("  "),h+" "+Q(a)+" "+i+" "}else return h}}function Q(a){return a.replace(/./g," ")}
function P(a){return a.replace(/./g,"^")};function Jb(){}Jb.prototype.za=function(a,b){return 11==a.m||10==a.m?Kb(this,b):b};function Lb(a,b){this.f=a|0;this.d=b|0}var Mb={};function Nb(a){if(-128<=a&&128>a){var b=Mb[a];if(b)return b}b=new Lb(a|0,0>a?-1:0);-128<=a&&128>a&&(Mb[a]=b);return b}function S(a){return isNaN(a)||!isFinite(a)?Ob:a<=-Pb?T:a+1>=Pb?Qb:0>a?U(S(-a)):new Lb(a%Rb|0,a/Rb|0)}function V(a,b){return new Lb(a,b)}var Rb=4294967296,Pb=Rb*Rb/2,Ob=Nb(0),Sb=Nb(1),Tb=Nb(-1),Qb=V(-1,2147483647),T=V(0,-2147483648),Ub=Nb(16777216);m=Lb.prototype;
m.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(Vb(this))return"0";if(0>this.d){if(this.j(T)){var b=S(a),c=Wb(this,b),b=Xb(c.multiply(b),this);return c.toString(a)+b.f.toString(a)}return"-"+U(this).toString(a)}for(var c=S(Math.pow(a,6)),b=this,d="";;){var e=Wb(b,c),i=Xb(b,e.multiply(c)).f.toString(a),b=e;if(Vb(b))return i+d;for(;6>i.length;)i="0"+i;d=""+i+d}};function Yb(a){return 0<=a.f?a.f:Rb+a.f}function Vb(a){return 0==a.d&&0==a.f}
m.j=function(a){return this.d==a.d&&this.f==a.f};function Zb(a,b){if(a.j(b))return 0;var c=0>a.d,d=0>b.d;return c&&!d?-1:!c&&d?1:0>Xb(a,b).d?-1:1}function U(a){return a.j(T)?T:a.ma().add(Sb)}m.add=function(a){var b=this.d>>>16,c=this.d&65535,d=this.f>>>16,e=a.d>>>16,i=a.d&65535,h=a.f>>>16,l;l=0+((this.f&65535)+(a.f&65535));a=0+(l>>>16);a+=d+h;d=0+(a>>>16);d+=c+i;c=0+(d>>>16);return V((a&65535)<<16|l&65535,(c+(b+e)&65535)<<16|d&65535)};function Xb(a,b){return a.add(U(b))}
m.multiply=function(a){if(Vb(this)||Vb(a))return Ob;if(this.j(T))return 1==(a.f&1)?T:Ob;if(a.j(T))return 1==(this.f&1)?T:Ob;if(0>this.d)return 0>a.d?U(this).multiply(U(a)):U(U(this).multiply(a));if(0>a.d)return U(this.multiply(U(a)));if(0>Zb(this,Ub)&&0>Zb(a,Ub))return S((this.d*Rb+Yb(this))*(a.d*Rb+Yb(a)));var b=this.d>>>16,c=this.d&65535,d=this.f>>>16,e=this.f&65535,i=a.d>>>16,h=a.d&65535,l=a.f>>>16,a=a.f&65535,t,s,K,ba;ba=0+e*a;K=0+(ba>>>16);K+=d*a;s=0+(K>>>16);K=(K&65535)+e*l;s+=K>>>16;s+=c*a;
t=0+(s>>>16);s=(s&65535)+d*l;t+=s>>>16;s=(s&65535)+e*h;t+=s>>>16;return V((K&65535)<<16|ba&65535,(t+(b*a+c*l+d*h+e*i)&65535)<<16|s&65535)};
function Wb(a,b){if(Vb(b))throw Error("division by zero");if(Vb(a))return Ob;if(a.j(T)){if(b.j(Sb)||b.j(Tb))return T;if(b.j(T))return Sb;var c=Wb($b(a,1),b).shiftLeft(1);if(c.j(Ob))return 0>b.d?Sb:Tb;var d=Xb(a,b.multiply(c));return c.add(Wb(d,b))}if(b.j(T))return Ob;if(0>a.d)return 0>b.d?Wb(U(a),U(b)):U(Wb(U(a),b));if(0>b.d)return U(Wb(a,U(b)));for(var e=Ob,d=a;0<=Zb(d,b);){for(var c=Math.max(1,Math.floor((d.d*Rb+Yb(d))/(b.d*Rb+Yb(b)))),i=Math.ceil(Math.log(c)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),
h=S(c),l=h.multiply(b);0>l.d||0<Zb(l,d);)c-=i,h=S(c),l=h.multiply(b);Vb(h)&&(h=Sb);e=e.add(h);d=Xb(d,l)}return e}m.ma=function(){return V(~this.f,~this.d)};m.ta=function(a){return V(this.f&a.f,this.d&a.d)};m.Da=function(a){return V(this.f|a.f,this.d|a.d)};function ac(a,b){return V(a.f^b.f,a.d^b.d)}m.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.f;return 32>a?V(b<<a,this.d<<a|b>>>32-a):V(0,b<<a-32)};
function $b(a,b){b&=63;if(0==b)return a;var c=a.d;return 32>b?V(a.f>>>b|c<<32-b,c>>b):V(c>>b-32,0<=c?0:-1)};function bc(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}function cc(a){return new Uint8Array(Array.prototype.map.call(a,function(a){return a.charCodeAt(0)}))}function dc(){this.q=0}p(dc,Jb);function W(a){throw new va("Error deserializing incorrectly formated message, "+a);}
function Kb(a,b){for(var c=Fa(b.$()),d=[],e=0,i=0;i<c.length;i++){var h=c[i];if(Ga(b,h.p)){var l=0;do{var t=a.za(h,b.get(h,l));d.push(t);e+=t.byteLength;l++}while(h.P&&l<Ja(b,h.p))}}c=new Uint8Array(e);for(i=e=0;i<d.length;i++)h=d[i],c.set(new Uint8Array(h),e),e+=h.byteLength;return c}
dc.prototype.za=function(a,b){var c=a.m,d=ec[c],e=fc(S(a.p<<3|d)),i;switch(d){case X:var h=S(b);if(c==Ba||17==c)h=ac(h.shiftLeft(1),$b(h,63));i=fc(h);break;case gc:h=new ArrayBuffer(8);c=new DataView(h);switch(a.m){case 1:c.setFloat64(0,b,g);break;case za:i=S(b);c.setUint32(0,Yb(i),g);c.setUint32(4,i.d,g);break;case Aa:i=S(b);c.setUint32(0,Yb(i),g);c.setInt32(4,i.d,g);break;default:W("Unexpected field type")}i=new Uint8Array(h);break;case hc:switch(a.m){case 11:h=Kb(this,b);break;case 9:h=cc(unescape(encodeURIComponent(b)));
break;case 12:h=cc(b);break;default:W("Unexpected field type")}i=h.length;c=fc(S(i));i=new Uint8Array(c.length+i);i.set(c,0);i.set(h,c.length);break;case ic:W("Use of Groups deprecated and not supported");break;case jc:h=new ArrayBuffer(4);c=new DataView(h);switch(a.m){case 2:c.setFloat32(0,b,g);break;case 7:c.setUint32(0,b,g);break;case 15:c.setInt32(0,b,g);break;default:W("Unexpected field type")}i=new Uint8Array(h);break;default:W("Unexpected wire type")}h=new Uint8Array(e.length+i.length);h.set(new Uint8Array(e),
0);h.set(new Uint8Array(i),e.length);return h};function fc(a){function b(a){var d=S(128),d=Xb(a,Wb(a,d).multiply(d)).f,e=S(127);0<Zb(a,e)?(d+=128,a=b($b(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function kc(a,b,c){var d=b.$();for(a.q=0;a.q<c.length;){var e=lc(a,c),i=d.F[parseInt(e>>3,10)]||j,h=a,l=e%8,t=i,e=c,s=f;switch(l){case X:e=lc(h,e);if(t){h=f;switch(t.m){case xa:case ya:h=e.toString();break;case 5:case 13:case 14:h=e;break;case 17:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).f;break;case Ba:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).toString();break;case 8:h=0===h?k:g;break;default:W("Unexpected field type")}s=h}else s=j;break;case hc:l=e;e=lc(h,l);l=new Uint8Array(l.buffer,l.byteOffset+h.q,e);
h.q+=e;if(t){e=f;switch(t.m){case 9:e=decodeURIComponent(escape(bc(l)));break;case 12:e=bc(l);break;case 11:e=l;h=new dc;t=new t.Ca.K.Ya;kc(h,t,e);e=t;break;default:W("Unexpected field type")}s=e}else s=j;break;case jc:e=new DataView(e.buffer,h.q,4);h.q+=4;if(t){h=f;switch(t.m){case 2:h=e.getFloat32(0,g);break;case 7:h=e.getUint32(0,g);break;case 15:h=e.getInt32(0,g);break;default:W("Unexpected field type")}s=h}else s=j;break;case gc:e=new DataView(e.buffer,h.q,8);h.q+=8;if(t){h=f;switch(t.m){case 1:h=
e.getFloat64(0,g);break;case za:h=(new Lb(e.getUint32(0,g),e.getUint32(4,g))).toString();break;case Aa:h=(new Lb(e.getUint32(0,g),e.getInt32(4,g))).toString();break;default:W("Unexpected field type")}s=h}else s=j;break;default:W("Unexpected wire type of "+l)}e=s;i!=j&&e!=j&&(i.P?b.add(i,e):b.set(i,e))}}function lc(a,b){var c=b[a.q++];if(127<c)var c=c-128,d=lc(a,b),c=c+(d<<7);return c}var X=0,gc=1,hc=2,ic=3,jc=5,ec=[-1,gc,jc,X,X,X,gc,jc,X,hc,ic,hc,hc,X,X,jc,gc,X,X];function Y(a,b){"undefined"===typeof a?a={}:"string"===typeof a&&(a={host:a});this.aa=a.host||this.Ka;this.da=a.port||this.ra;this.D=a.db||this.Ja;v(this.aa,"string");v(this.da,"number");v(this.D,"string");this.Q={};this.ab=1;this.X=b||j;ra=this}Y.prototype.Ka="localhost";Y.prototype.ra=12346;Y.prototype.Ja="test";Y.prototype.gb=function(a){this.constructor.call(this,{host:this.aa,port:this.da,db:this.D},a,this.X)};Y.prototype.reconnect=Y.prototype.gb;
function Z(a,b){if(a.X)a.X(b);else if(a.oa)console.log(b.name+":"+b.message);else throw b;}Y.prototype.hb=function(a){this.X=a};Y.prototype.setErrorHandler=Y.prototype.hb;function mc(a,b,c,d,e){var i=b.k();i.pa((a.ab++).toString());a.Q[i.L()]={l:d||j,fb:b,ca:c,W:e||j,na:[]};nc(a,i)}function nc(a,b){var c=Kb(new dc,b),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,g);e.set(c,4);a.Ga(e.buffer)}
Y.prototype.ea=function(a,b){this.oa=k;w(arguments,1);v(a,r);v(b,"function");mc(this,a,k,b)};Y.prototype.run=Y.prototype.ea;Y.prototype.fa=function(a){this.oa=g;mc(this,a,k,function(a){console.log(a)})};Y.prototype.runp=Y.prototype.fa;Y.prototype.ba=function(a,b,c){this.oa=k;w(arguments,1);v(a,r);v(b,"function");mc(this,a,g,b,c)};Y.prototype.iter=Y.prototype.ba;
function oc(a,b){(new DataView(b.buffer)).getUint32(0,g)!==b.length-4&&Z(a,new A("RDB response corrupted, length inaccurate"));var c=new dc,d=new kb;try{kc(c,d,new Uint8Array(b.buffer,4))}catch(e){Z(a,new A("response deserialization failed"))}var i=E(d,1);if(c=a.Q[d.L()])switch(i){case 101:Z(a,new Hb(E(d,4)));break;case 103:var c=c.fb,i=E(d,4),d=E(d,5),h=[];d&&(h=Ia(d,1));d=i+"\n\t"+c.a()+"\n\t"+c.a(h);Z(a,new Gb(d));break;case 102:Z(a,new Ib(E(d,4)));break;case 0:delete a.Q[d.L()];c.l&&c.l();break;
case 3:delete a.Q[d.L()];d=Ia(d,3).map(JSON.parse);c.l&&(c.ca?d.forEach(c.l):c.l(c.na.concat(d)));c.W&&c.ca&&c.W();break;case 1:delete a.Q[d.L()];d=JSON.parse(E(d,3,0));c.ca?(d.forEach&&c.l?d.forEach(c.l):c.l&&c.l(d),c.W&&c.W()):c.l&&c.l(d);break;case 2:i=new B;i.c(3);i.pa(d.Aa());nc(a,i);d=Ia(d,3).map(JSON.parse);c.l&&(c.ca?d.forEach(c.l):c.na=c.na.concat(d));break;default:Z(a,new A("unknown response status code"))}};function pc(a,b){this.nb=a;this.J=b||j}p(pc,r);pc.prototype.k=function(){var a=new O;a.c(this.nb);this.J&&a.T(this.J);var b=new B;b.c(5);C(b,5,a);return b};o("rethinkdb.dbCreate",function(a){w(arguments,1);v(a,"string");return new pc(1,a)});o("rethinkdb.dbDrop",function(a){w(arguments,1);v(a,"string");return new pc(2,a)});o("rethinkdb.dbList",function(){return new pc(3)});function $(a){this.r=a}o("rethinkdb.db",function(a){w(arguments,1);v(a,"string");return new $(a)});
$.prototype.list=function(){return new pc(6,this.r)};$.prototype.list=$.prototype.list;function qc(a,b,c,d,e){this.wa=a;this.J=b;this.qa=c;this.Fa=d;this.va=e}p(qc,r);qc.prototype.k=function(){var a=new I;a.T(this.J);C(a,2,this.qa);var b=new ib;this.wa&&C(b,1,this.wa);b.o(a);this.Fa&&C(b,4,this.Fa);this.va&&C(b,5,this.va);a=new O;a.c(4);C(a,3,b);b=new B;b.c(5);C(b,5,a);return b};
$.prototype.create=function(a){w(arguments,1);var b={};"string"===typeof a?b.tableName=a:b=a;v(b.tableName,"string");v(b.primaryKey,"string");v(b.dataCenter,"string");v(b.cacheSize,"string");return new qc(b.dataCenter,this.r,b.tableName,b.primaryKey,b.cacheSize)};$.prototype.create=$.prototype.create;function rc(a,b){w(arguments,1);this.J=a;this.qa=b}p(rc,r);rc.prototype.k=function(){var a=new I;a.T(this.J);C(a,2,this.qa);var b=new O;b.c(5);C(b,4,a);a=new B;a.c(5);C(a,5,b);return a};
$.prototype.Ta=function(a){w(arguments,1);v(a,"string");return new rc(this.r,a)};$.prototype.drop=$.prototype.Ta;$.prototype.lb=function(a){w(arguments,1);v(a,"string");return new z(a,this.r)};$.prototype.table=$.prototype.lb;function sc(a,b,c){v(b,"function");v(c,"function");Y.call(this,a,c);this.O="";var d=this,e="http://"+this.aa+":"+this.da+"/ajax/reql/",i=new XMLHttpRequest;i.responseType="arraybuffer";i.open("GET",e+"open-new-connection",g);i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(d.O=e,d.ka=(new DataView(i.response)).getInt32(0,g),b&&b(d)):Z(d,new A("Unabled to establish HTTP connection")))};i.send()}p(sc,Y);o("rethinkdb.HttpConnection",sc);sc.prototype.ra=21300;
sc.prototype.Ga=function(a){this.O||Z(this,new A("Connection not open"));var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.O+"?conn_id="+this.ka,g);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&oc(c,new Uint8Array(b.response))};b.send(a)};sc.prototype.close=function(){this.O||Z(this,new A("Connection not open"));var a=new XMLHttpRequest;a.open("POST",this.O+"close-connection?conn_id="+this.ka,g);a.send();this.O=this.ka=j};sc.prototype.close=sc.prototype.close;function tc(a,b,c){uc()||Z(this,new A("Cannot instantiate TcpConnection, TCP sockets are not available in this environment."));v(b,"function");v(c,"function");Y.call(this,a,c);this.M=j;this.Uc=0;this.C=j;var d=this;d.C=j;var e=require("net").connect(this.da,this.aa,function(){e.write("35ba61af","hex");e.on("data",fa(d.mb,d));e.on("end",function(){d.C=j;Z(d,new Gb("Server disconnected"))});d.C=e;b&&b(d)});e.on("error",function(){Z(d,new A("Unabled to establish TCP connection"))})}p(tc,Y);
o("rethinkdb.TcpConnection",tc);function uc(){return"undefined"!==typeof require&&require("net")}tc.isAvailable=uc;tc.prototype.Ga=function(a){this.C||Z(this,new A("Connection not open"));for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.C.write(b)};
tc.prototype.mb=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.M===j){var d=(new DataView(a.buffer,b,c)).getUint32(0,g);this.M=new Uint8Array(d+4);this.R=0}var d=this.M.byteLength-this.R,e=c<d?c:d,i=new Uint8Array(a.buffer,b,e);this.M.set(i,this.R);this.R+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.M,this.M=j,this.R=0,oc(this,d))}};
tc.prototype.close=function(){this.C||Z(this,new A("Connection not open"));var a=this;this.C.removeAllListeners("end");this.C.on("close",function(){a.C=j});this.C.end()};tc.prototype.close=tc.prototype.close;o("rethinkdb.connect",function(a,b,c){return uc()?new tc(a,b,c):new sc(a,b,c)});var ra=j;o("rethinkdb.getLastConnection",function(){return ra});"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
