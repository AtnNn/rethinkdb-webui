(function(){
var f=void 0,g=!0,j=null,k=!1,m,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function n(a){return"array"==ba(a)}Math.floor(2147483648*Math.random()).toString(36);function ca(a,b,c){return a.call.apply(a.bind,arguments)}function ea(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function fa(a,b,c){fa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:ea;return fa.apply(j,arguments)}function o(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==f?d[e]=b:d=d[e]?d[e]:d[e]={}}function p(a,b){function c(){}c.prototype=b.prototype;a.bd=b.prototype;a.prototype=new c;a.prototype.constructor=a};aa.rethinkdb=function(a){return ga(a)};function q(a){return a instanceof r?a:t(a)}function u(a){return a instanceof ha?a:ia(a)}function w(a,b){if(a){var c=b;n(b)||(c=[c]);if(!c.some(function(b){return"string"===typeof b?typeof a===b:a instanceof b})){if(n(b))throw new TypeError("Function argument "+a+" must be one of the types "+b);throw new TypeError("Function argument "+a+" must be of the type "+b);}}}
function x(a,b){if(a.length<b)throw new TypeError("Function requires at least "+b+" argument"+(1<b?"s.":"."));}function y(a){function b(a){return z.prototype.ba.call(b,a)}var c=arguments[0],d=Array.prototype.slice.call(arguments,1);b.__proto__=c.prototype;c.apply(b,d);return b};function t(a){if(!(a instanceof z))if(a===j||"number"==typeof a)a=y(ja,a);else if("boolean"==typeof a)a=y(ka,a);else if("string"==typeof a)a=y(la,a);else if(n(a))a=y(ma,a);else var b=typeof a,a="object"==b&&a!=j||"function"==b?y(na,a):y(oa,a);return a}o("rethinkdb.expr",t);o("rethinkdb.js",function(a){x(arguments,1);w(a,"string");return y(pa,a)});o("rethinkdb.table",function(a,b){x(arguments,1);w(a,"string");w(b,"boolean");return y(A,a,j,b)});function r(){}
r.prototype.ga=function(a,b){var c,d={};!a||"function"===typeof a?(c=b||qa,d.callback=a):(c=a.conn||qa,ra(d,a),delete d.conn);d.expr=this;if(!c)throw new C("No connection specified and no last connection to default to.");c.ga(d)};r.prototype.run=r.prototype.ga;r.prototype.ha=function(a){var b,c={};!a||a instanceof D?b=a||qa:(b=a.conn||qa,ra(c,a),delete c.conn);c.expr=this;if(!b)throw new C("No connection specified and no last connection to default to.");b.ha(c)};r.prototype.runp=r.prototype.ha;
r.prototype.ea=function(a,b){var c,d={};!a||"function"===typeof a?(c=b||qa,d.callback=a):(c=a.conn||qa,ra(d,a),delete d.conn);d.expr=this;if(!c)throw new C("No connection specified and no last connection to default to.");c.ea(d)};r.prototype.iter=r.prototype.ea;r.prototype.a=function(){return"----"};function sa(){}p(sa,r);sa.prototype.k=function(a){var b=new ta,a=this.compile(a);b.ia(a);a=new E;a.c(ua);F(a,3,b);return a};function va(a){Error.captureStackTrace?Error.captureStackTrace(this,va):this.stack=Error().stack||"";a&&(this.message=String(a))}p(va,Error);va.prototype.name="CustomError";function wa(a,b,c){this.$c=a;this.p=b;this.r=c.name;this.S=!!c.A;this.Zc=!!c.required;this.m=c.b;this.Fa=c.type;this.Ua=k;switch(this.m){case xa:case ya:case za:case Aa:case Ba:this.Ua=g}this.na=c.defaultValue}var xa=3,ya=4,za=6,Aa=16,Ba=18;var Ca="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ra(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var h=0;h<Ca.length;h++)c=Ca[h],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Da=Array.prototype;function Ea(a,b){return a>b?1:a<b?-1:0};function Fa(a,b,c){this.cb=a;this.r=b.name||j;this.Yc=b.e||j;this.Wc=b.h;this.F={};for(a=0;a<c.length;a++)b=c[a],this.F[b.p]=b}function Ga(a){var a=a.F,b=[],c=0,d;for(d in a)b[c++]=a[d];Da.sort.call(b,function(a,b){return a.p-b.p}||Ea);return b};function G(){this.w={};this.M=this.constructor.M;this.F=this.M.F;this.I=this.Ea=j}m=G.prototype;m.ca=function(){return this.M};m.get=function(a,b){return H(this,a.p,b)};m.set=function(a,b){F(this,a.p,b)};m.add=function(a,b){I(this,a.p,b)};
m.j=function(a){if(!a||this.constructor!=a.constructor)return k;for(var b=Ga(this.ca()),c=0;c<b.length;c++){var d=b[c];if(Ha(this,d.p)!=Ha(a,d.p))return k;if(Ha(this,d.p)){var e=11==d.m||10==d.m,h=Ia(this,d),i=Ia(a,d);if(d.S){if(h.length!=i.length)return k;for(d=0;d<h.length;d++)if(!(e?h[d].j(i[d]):h[d]==i[d]))return k}else if(!(e?h.j(i):h==i))return k}}return g};function Ha(a,b){return b in a.w&&a.w[b]!==f&&a.w[b]!==j}
function Ia(a,b){var c=b.p;if(!c in a.w)return j;var d=a.w[c];return d==j?j:a.Ea?!(c in a.I)?(d=a.Ea.Xc(a,b,d),a.I[c]=d):a.I[c]:d}function H(a,b,c){b=a.F[b];a=Ia(a,b);if(b.S)return n(a),a[c||0];n(a);return a}function J(a,b){var c;if(Ha(a,b))c=H(a,b,f);else{c=a.F[b];if(c.na===f){var d=c.Fa;c.na=d===Boolean?k:d===Number?0:d===String?"":new d}c=c.na}return c}function Ja(a,b){var c=Ia(a,a.F[b]);c==j||n(c);return c||[]}
function Ka(a,b){return a.F[b].S?(Ha(a,b)&&n(a.w[b]),Ha(a,b)?a.w[b].length:0):Ha(a,b)?1:0}function F(a,b,c){a.w[b]=c;a.I&&(a.I[b]=c)}function I(a,b,c){a.w[b]||(a.w[b]=[]);a.w[b].push(c);a.I&&delete a.I[b]}function K(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new wa(a,e,b[e])));a.M=new Fa(a,d,c);a.ca=function(){return a.M}};function L(){G.apply(this)}p(L,G);L.prototype.X=function(a){F(this,1,a)};function La(){G.apply(this)}p(La,G);La.prototype.Q=function(a){F(this,1,a)};La.prototype.ia=function(a){F(this,2,a)};function M(){G.apply(this)}p(M,G);M.prototype.c=function(a){F(this,1,a)};M.prototype.Q=function(a){F(this,2,a)};function Ma(a){return J(a,15)}function Na(){G.apply(this)}p(Na,G);function Oa(){G.apply(this)}p(Oa,G);function Pa(){G.apply(this)}p(Pa,G);function Qa(){G.apply(this)}p(Qa,G);
Qa.prototype.t=function(){return J(this,1)};Qa.prototype.o=function(a){F(this,1,a)};Qa.prototype.G=function(a){F(this,2,a)};Qa.prototype.J=function(a){F(this,3,a)};function Ra(){G.apply(this)}p(Ra,G);Ra.prototype.t=function(){return J(this,1)};Ra.prototype.o=function(a){F(this,1,a)};function N(){G.apply(this)}p(N,G);N.prototype.c=function(a){F(this,1,a)};N.prototype.ba=function(){return H(this,2)};N.prototype.W=function(a){F(this,2,a)};
var Sa=19,Ta={tc:1,Tb:2,Zb:3,Xb:4,$b:5,yc:6,ac:7,nc:8,zb:9,Gc:11,vb:14,Kc:15,qc:16,Lb:17,pc:18,Eb:Sa,Qb:20,mc:21,Fb:22,xc:23,Kb:24,hc:26,Qc:27,uc:28,Ic:29,Ab:30,Ec:31,Vb:32,xb:35,wb:36,Cc:37,cc:38,Tc:39};function Ua(){G.apply(this)}p(Ua,G);function Va(){G.apply(this)}p(Va,G);Va.prototype.v=function(a){F(this,1,a)};function Wa(){G.apply(this)}p(Wa,G);Wa.prototype.v=function(a){F(this,1,a)};function Xa(){G.apply(this)}p(Xa,G);Xa.prototype.ba=function(){return H(this,1)};
Xa.prototype.W=function(a){F(this,1,a)};function Ya(){G.apply(this)}p(Ya,G);function Za(){G.apply(this)}p(Za,G);Za.prototype.G=function(a){F(this,1,a)};function $a(){G.apply(this)}p($a,G);$a.prototype.n=function(a){F(this,4,a)};function O(){G.apply(this)}p(O,G);O.prototype.B=function(a){F(this,1,a)};O.prototype.n=function(a){F(this,2,a)};function ab(){G.apply(this)}p(ab,G);ab.prototype.B=function(a){F(this,1,a)};ab.prototype.n=function(a){F(this,2,a)};function ta(){G.apply(this)}p(ta,G);
ta.prototype.ia=function(a){F(this,1,a)};function P(){G.apply(this)}p(P,G);P.prototype.c=function(a){F(this,1,a)};function bb(){G.apply(this)}p(bb,G);bb.prototype.Y=function(a){F(this,1,a)};bb.prototype.v=function(a){F(this,2,a)};function cb(){G.apply(this)}p(cb,G);cb.prototype.Y=function(a){F(this,1,a)};function db(){G.apply(this)}p(db,G);db.prototype.Y=function(a){F(this,1,a)};db.prototype.v=function(a){F(this,2,a)};function eb(){G.apply(this)}p(eb,G);eb.prototype.t=function(){return J(this,1)};
eb.prototype.o=function(a){F(this,1,a)};function fb(){G.apply(this)}p(fb,G);fb.prototype.Q=function(a){F(this,2,a)};function gb(){G.apply(this)}p(gb,G);m=gb.prototype;m.t=function(){return J(this,1)};m.o=function(a){F(this,1,a)};m.G=function(a){F(this,2,a)};m.J=function(a){F(this,3,a)};m.v=function(a){F(this,4,a)};function hb(){G.apply(this)}p(hb,G);hb.prototype.t=function(){return J(this,1)};hb.prototype.o=function(a){F(this,1,a)};hb.prototype.G=function(a){F(this,2,a)};
hb.prototype.J=function(a){F(this,3,a)};function ib(){G.apply(this)}p(ib,G);m=ib.prototype;m.t=function(){return J(this,1)};m.o=function(a){F(this,1,a)};m.G=function(a){F(this,2,a)};m.J=function(a){F(this,3,a)};m.v=function(a){F(this,4,a)};function jb(){G.apply(this)}p(jb,G);jb.prototype.c=function(a){F(this,1,a)};jb.prototype.X=function(a){F(this,2,a)};function kb(){G.apply(this)}p(kb,G);kb.prototype.t=function(){return J(this,3)};kb.prototype.o=function(a){F(this,3,a)};
function E(){G.apply(this)}p(E,G);E.prototype.c=function(a){F(this,1,a)};E.prototype.O=function(){return H(this,2)};E.prototype.Da=function(){return J(this,2)};E.prototype.ra=function(a){F(this,2,a)};var ua=1,lb={Dc:ua,Uc:2,Gb:3,Hc:4,oc:5};function mb(){G.apply(this)}p(mb,G);mb.prototype.O=function(){return H(this,2)};mb.prototype.Da=function(){return J(this,2)};mb.prototype.ra=function(a){F(this,2,a)};function nb(){G.apply(this)}p(nb,G);
K(L,{"0":{name:"TableRef",e:"TableRef"},1:{name:"db_name",b:9,type:String},2:{name:"table_name",b:9,type:String},3:{name:"use_outdated",b:8,defaultValue:0,type:Boolean}});K(La,{"0":{name:"VarTermTuple",e:"VarTermTuple"},1:{name:"var",b:9,type:String},2:{name:"term",b:11,type:M}});
K(M,{"0":{name:"Term",e:"Term"},1:{name:"type",b:14,defaultValue:0,type:{fc:0,Sc:1,ic:2,Db:3,Yb:4,Pb:5,vc:6,Jc:7,JSON:8,BOOL:9,yb:10,wc:11,Ub:12,Pc:13,ec:14,bc:15}},2:{name:"var",b:9,type:String},3:{name:"let",b:11,type:Na},4:{name:"call",b:11,type:Oa},5:{name:"if_",b:11,type:Pa},6:{name:"error",b:9,type:String},7:{name:"number",b:1,type:Number},8:{name:"valuestring",b:9,type:String},9:{name:"jsonstring",b:9,type:String},10:{name:"valuebool",b:8,type:Boolean},11:{name:"array",A:g,b:11,type:M},12:{name:"object",
A:g,b:11,type:La},14:{name:"get_by_key",b:11,type:Qa},15:{name:"table",b:11,type:Ra},16:{name:"javascript",b:9,type:String}});K(Na,{"0":{name:"Let",h:M,e:"Term.Let"},1:{name:"binds",A:g,b:11,type:La},2:{name:"expr",b:11,type:M}});K(Oa,{"0":{name:"Call",h:M,e:"Term.Call"},1:{name:"builtin",b:11,type:N},2:{name:"args",A:g,b:11,type:M}});K(Pa,{"0":{name:"If",h:M,e:"Term.If"},1:{name:"test",b:11,type:M},2:{name:"true_branch",b:11,type:M},3:{name:"false_branch",b:11,type:M}});
K(Qa,{"0":{name:"GetByKey",h:M,e:"Term.GetByKey"},1:{name:"table_ref",b:11,type:L},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:M}});K(Ra,{"0":{name:"Table",h:M,e:"Term.Table"},1:{name:"table_ref",b:11,type:L}});
K(N,{"0":{name:"Builtin",e:"Builtin"},1:{name:"type",b:14,defaultValue:1,type:Ta},2:{name:"attr",b:9,type:String},3:{name:"attrs",A:g,b:9,type:String},4:{name:"comparison",b:14,defaultValue:1,type:{Ob:1,sc:2,lc:3,gc:4,Wb:5,Sb:6}},5:{name:"filter",b:11,type:Ua},6:{name:"map",b:11,type:Va},7:{name:"concat_map",b:11,type:Wa},8:{name:"order_by",A:g,b:11,type:Xa},9:{name:"reduce",b:11,type:$a},10:{name:"grouped_map_reduce",b:11,type:Ya},11:{name:"range",b:11,type:Za}});
K(Ua,{"0":{name:"Filter",h:N,e:"Builtin.Filter"},1:{name:"predicate",b:11,type:ab}});K(Va,{"0":{name:"Map",h:N,e:"Builtin.Map"},1:{name:"mapping",b:11,type:O}});K(Wa,{"0":{name:"ConcatMap",h:N,e:"Builtin.ConcatMap"},1:{name:"mapping",b:11,type:O}});K(Xa,{"0":{name:"OrderBy",h:N,e:"Builtin.OrderBy"},1:{name:"attr",b:9,type:String},2:{name:"ascending",b:8,defaultValue:1,type:Boolean}});
K(Ya,{"0":{name:"GroupedMapReduce",h:N,e:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",b:11,type:O},2:{name:"value_mapping",b:11,type:O},3:{name:"reduction",b:11,type:$a}});K(Za,{"0":{name:"Range",h:N,e:"Builtin.Range"},1:{name:"attrname",b:9,type:String},2:{name:"lowerbound",b:11,type:M},3:{name:"upperbound",b:11,type:M}});K($a,{"0":{name:"Reduction",e:"Reduction"},1:{name:"base",b:11,type:M},2:{name:"var1",b:9,type:String},3:{name:"var2",b:9,type:String},4:{name:"body",b:11,type:M}});
K(O,{"0":{name:"Mapping",e:"Mapping"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:M}});K(ab,{"0":{name:"Predicate",e:"Predicate"},1:{name:"arg",b:9,type:String},2:{name:"body",b:11,type:M}});K(ta,{"0":{name:"ReadQuery",e:"ReadQuery"},1:{name:"term",b:11,type:M},2:{name:"max_chunk_size",b:3,type:String},3:{name:"max_age",b:3,type:String}});
K(P,{"0":{name:"WriteQuery",e:"WriteQuery"},1:{name:"type",b:14,defaultValue:1,type:{Rc:1,Jb:2,rc:3,dc:4,Rb:6,Bc:7,zc:8,Ac:9}},2:{name:"update",b:11,type:bb},3:{name:"delete",b:11,type:cb},4:{name:"mutate",b:11,type:db},5:{name:"insert",b:11,type:eb},7:{name:"for_each",b:11,type:fb},8:{name:"point_update",b:11,type:gb},9:{name:"point_delete",b:11,type:hb},10:{name:"point_mutate",b:11,type:ib}});
K(bb,{"0":{name:"Update",h:P,e:"WriteQuery.Update"},1:{name:"view",b:11,type:M},2:{name:"mapping",b:11,type:O}});K(cb,{"0":{name:"Delete",h:P,e:"WriteQuery.Delete"},1:{name:"view",b:11,type:M}});K(db,{"0":{name:"Mutate",h:P,e:"WriteQuery.Mutate"},1:{name:"view",b:11,type:M},2:{name:"mapping",b:11,type:O}});K(eb,{"0":{name:"Insert",h:P,e:"WriteQuery.Insert"},1:{name:"table_ref",b:11,type:L},2:{name:"terms",A:g,b:11,type:M},3:{name:"overwrite",b:8,defaultValue:0,type:Boolean}});
K(fb,{"0":{name:"ForEach",h:P,e:"WriteQuery.ForEach"},1:{name:"stream",b:11,type:M},2:{name:"var",b:9,type:String},3:{name:"queries",A:g,b:11,type:P}});K(gb,{"0":{name:"PointUpdate",h:P,e:"WriteQuery.PointUpdate"},1:{name:"table_ref",b:11,type:L},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:M},4:{name:"mapping",b:11,type:O}});K(hb,{"0":{name:"PointDelete",h:P,e:"WriteQuery.PointDelete"},1:{name:"table_ref",b:11,type:L},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:M}});
K(ib,{"0":{name:"PointMutate",h:P,e:"WriteQuery.PointMutate"},1:{name:"table_ref",b:11,type:L},2:{name:"attrname",b:9,type:String},3:{name:"key",b:11,type:M},4:{name:"mapping",b:11,type:O}});K(jb,{"0":{name:"MetaQuery",e:"MetaQuery"},1:{name:"type",b:14,defaultValue:1,type:{Hb:1,Mb:2,jc:3,Ib:4,Nb:5,kc:6}},2:{name:"db_name",b:9,type:String},3:{name:"create_table",b:11,type:kb},4:{name:"drop_table",b:11,type:L}});
K(kb,{"0":{name:"CreateTable",h:jb,e:"MetaQuery.CreateTable"},1:{name:"datacenter",b:9,type:String},3:{name:"table_ref",b:11,type:L},4:{name:"primary_key",b:9,defaultValue:"id",type:String},5:{name:"cache_size",b:3,defaultValue:"1073741824",type:String}});K(E,{"0":{name:"Query",e:"Query"},1:{name:"type",b:14,defaultValue:ua,type:lb},2:{name:"token",b:3,type:String},3:{name:"read_query",b:11,type:ta},4:{name:"write_query",b:11,type:P},5:{name:"meta_query",b:11,type:jb}});
K(mb,{"0":{name:"Response",e:"Response"},1:{name:"status_code",b:14,defaultValue:0,type:{Lc:0,Mc:1,Nc:2,Oc:3,Cb:101,Bb:102,Fc:103}},2:{name:"token",b:3,type:String},3:{name:"response",A:g,b:9,type:String},4:{name:"error_message",b:9,type:String},5:{name:"backtrace",b:11,type:nb}});K(nb,{"0":{name:"Backtrace",h:mb,e:"Response.Backtrace"},1:{name:"frame",A:g,b:9,type:String}});function z(){}p(z,sa);function ob(a){this.eb=a||""}p(ob,z);ob.prototype.compile=function(){var a=new M;a.c(5);F(a,6,this.eb);return a};ob.prototype.a=function(a){return a?"^^^^^^^^^":"r.error()"};o("rethinkdb.error",function(){return new ob});function oa(a){this.g=a}p(oa,z);oa.prototype.compile=function(){var a=new M;a.c(8);var b=JSON.stringify(this.g);F(a,9,b);return a};function ja(a){this.g="undefined"===typeof a?j:a}p(ja,z);
ja.prototype.compile=function(){var a=new M;this.g===j?a.c(0):(a.c(6),F(a,7,this.g));return a};ja.prototype.a=function(a){var b="r.expr("+this.g+")";return a?Q(b):b};function ka(a){this.g=a}p(ka,z);ka.prototype.compile=function(){var a=new M;a.c(9);F(a,10,this.g);return a};ka.prototype.a=function(a){var b="r.expr("+this.g+")";return a?Q(b):b};function la(a){this.g=a}p(la,z);la.prototype.compile=function(){var a=new M;a.c(7);F(a,8,this.g);return a};
la.prototype.a=function(a){var b="r.expr('"+this.g+"')";return a?Q(b):b};function ma(a){this.g=[];for(var b=0;b<a.length;b++){var c=q(a[b]);this.g.push(c)}}p(ma,z);ma.prototype.compile=function(a){var b=new M;b.c(10);for(var c=0;c<this.g.length;c++){var d=this.g[c].compile(a);I(b,11,d)}return b};
ma.prototype.a=function(a){var b=this.g.map(function(a){return a.a()});if(a){if(0===a.length)return Q("r.expr(["+b.join(", ")+"])");var c=a[0].split(":");a.shift();c=parseInt(c[1],10);b=b.map(R);b[c]=this.g[c].a(a);return"        "+b.join("  ")+"  "}return"r.expr(["+b.join(", ")+"])"};function na(a){this.g={};for(var b in a)if(a.hasOwnProperty(b)){var c=q(a[b]);this.g[b]=c}}p(na,z);
na.prototype.compile=function(a){var b=new M;b.c(11);for(var c in this.g)if(this.g.hasOwnProperty(c)){var d=new La;d.Q(c);d.ia(this.g[c].compile(a));I(b,12,d)}return b};
na.prototype.a=function(a){var b=[],c;for(c in this.g)this.g.hasOwnProperty(c)&&b.push("'"+c+"':"+this.g[c].a());b="r.expr({"+b.join(", ")+"})";if(a){if(0===a.length)return Q(b);b=a[0].split(":");a.shift();var d=b[1],b=[];for(c in this.g)this.g.hasOwnProperty(c)&&(c===d?b.push(R("'"+c+"':")+this.g[c].a(a)):b.push(R("'"+c+"':"+this.g[c].a())));return"        "+b.join("  ")+"  "}return b};function pa(a){this.pb=a}p(pa,z);pa.prototype.compile=function(){var a=new M;a.c(14);F(a,16,this.pb);return a};
function ha(a,b){1>a.length&&a.push("");this.i=a;this.body=b}ha.prototype.a=function(a){return a?R("function("+this.i.join(", ")+") {return ")+this.body.a(a)+" ":"function("+this.i.join(", ")+") {return "+this.body.a()+"}"};var pb=0;
function ia(a){var b,c;if("function"===typeof a&&!(a instanceof r)){b=[];for(c=0;c<a.length;c++)b.push("arg"+b.length+"_"+pb++);c=a.apply(j,b.map(function(a){return qb(a)}));if(!(c instanceof r))throw new C("ReQL function must return ReQL expression");}else c=arguments[arguments.length-1],b=Array.prototype.slice.call(arguments,0,arguments.length-1);c=q(c);b.forEach(function(a){return w(a,"string")});return y(ha,b,c)}function S(a,b,c,d){this.Sa=a;this.wa=b;this.ua=d||j;this.a=c}p(S,z);
S.prototype.compile=function(a){var b=new N;b.c(this.Sa);this.ua&&this.ua(b);var c=new Oa;F(c,1,b);for(var d in this.wa)b=this.wa[d].compile(a),I(c,2,b);a=new M;a.c(3);F(a,4,c);return a};function rb(a,b){z.prototype[b]=function(c){x(arguments,1);c=q(c);return y(S,a,[this,c],sb(b,this,c))}}function tb(a,b){z.prototype[b]=function(c){x(arguments,1);c=q(c);return y(S,Sa,[this,c],sb(b,this,c),function(b){F(b,4,a)})}}rb(14,"add");rb(15,"sub");rb(16,"mul");rb(17,"div");rb(18,"mod");tb(1,"eq");tb(2,"ne");
tb(3,"lt");tb(4,"le");tb(5,"gt");tb(6,"ge");z.prototype.oa=function(){return y(S,1,[this],sb("not",this))};z.prototype.not=z.prototype.oa;z.prototype.count=function(){return y(S,26,[this],sb("count",this))};z.prototype.count=z.prototype.count;z.prototype.va=function(a){x(arguments,1);a=q(a);return y(S,36,[this,a],sb("and",this,a))};z.prototype.and=z.prototype.va;z.prototype.Ga=function(a){x(arguments,1);a=q(a);return y(S,35,[this,a],sb("or",this,a))};z.prototype.or=z.prototype.Ga;
z.prototype.Qa=function(a,b,c){x(arguments,2);a=q(a);b=q(b);w(c,"string");var d=c?c:"id";return y(S,37,[this],sb("between",this,a,b,d),function(c,h){var i=new Za;i.G(d);var l=a.compile(h);F(i,2,l);l=b.compile(h);F(i,3,l);F(c,11,i)})};z.prototype.between=z.prototype.Qa;z.prototype.append=function(a){x(arguments,1);a=q(a);return y(S,9,[this,a],sb("append",this,a))};z.prototype.append=z.prototype.append;
function ub(a,b,c){b=q(b);c=c?q(c):new oa(j);S.call(this,11,[a,b,c],function(d){if(d){var e=d[0].split(":");e[1]=parseInt(e[1],10);d.shift();return 0===e[1]?a.a(d)+R(".slice("+b.a()+(c?", "+c.a():"")+")"):1===e[1]?R(a.a()+".slice(")+b.a(d)+R((c?", "+c.a():"")+")"):R(a.a()+".slice("+b.a(d)+", ")+c.a(d)+" "}return a.a()+".slice("+b.a()+(c?", "+c.a():"")+")"})}p(ub,S);z.prototype.slice=function(a,b){x(arguments,1);return y(ub,this,a,b)};z.prototype.slice=z.prototype.slice;
z.prototype.bb=function(a){x(arguments,1);return y(ub,this,0,a)};z.prototype.limit=z.prototype.bb;z.prototype.ob=function(a){x(arguments,1);return y(ub,this,a)};z.prototype.skip=z.prototype.ob;z.prototype.hb=function(a){x(arguments,1);a=q(a);return y(S,28,[this,a],sb("nth",this,a))};z.prototype.nth=z.prototype.hb;
z.prototype.filter=function(a){var b;if("object"===typeof a&&!(a instanceof r)){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(ga(d).eq(t(a[d])));b=y(ha,[""],y(S,36,c,function(a){var b=c.map(function(a){return a.a()});if(a){var d=a[0].split(":");a.shift();b=b.map(R);b[d[1]]=c[d[1]].a(a);return b.join("      ")}return b.join(").and(")}))}else b=u(a);var e=this;return y(S,20,[this],function(a){if(a){if("predicate"===a[0])return a.shift(),R(e.a()+".filter(")+b.a(a)+" ";a.shift();return e.a(a)+R(".filter("+
b.a(a)+")")}return e.a()+".filter("+b.a()+")"},function(a,c){var d=new ab;d.B(b.i[0]);d.n(b.body.compile(c));var e=new Ua;F(e,1,d);F(a,5,e)})};z.prototype.filter=z.prototype.filter;z.prototype.map=function(a){var a=u(a),b=this;return y(S,21,[this],function(c){if(c){if("arg:0"===c[0])return c.shift(),b.a(c)+R(".map("+a.a(c)+")");c.shift();return R(b.a()+".map(")+a.a(c)+" "}return b.a()+".map("+a.a()+")"},function(b,d){var e=new O;e.B(a.i[0]);e.n(a.body.compile(d));var h=new Va;h.v(e);F(b,6,h)})};
z.prototype.map=z.prototype.map;z.prototype.ib=function(a){x(arguments,1);var b=Array.prototype.slice.call(arguments,0);b.forEach(function(a){w(a,"string")});var c=this;return y(S,23,[this],function(a){var e=b.map(function(a){return"'"+a+"'"});return a?(a.shift(),c.a(a)+R(".orderby("+e.join(", ")+")")):c.a()+".orderby("+e.join(", ")+")"},function(a){for(var c=0;c<b.length;c++){var h=g,i=b[c];"-"===i[0]&&(h=k,i=i.slice(1));var l=new Xa;l.W(i);F(l,2,h);I(a,8,l)}})};z.prototype.orderby=z.prototype.ib;
z.prototype.Va=function(a){w(a,"string");var b=a?this.map(ga(a)):this;return y(S,24,[b],function(a){return a?(a.shift(),b.a(a)+"           "):b.a()+".distinct()"})};z.prototype.distinct=z.prototype.Va;
z.prototype.reduce=function(a,b){x(arguments,2);var a=q(a),b=u(b),c=this;return y(S,31,[this],function(d){if(d)if("reduce"===d[0]){d.shift();if("body"===d[0])return d.shift(),R(c.a()+".reduce("+a.a()+", ")+b.a(d)+" ";if("base"===d[0])return d.shift(),R(c.a()+".reduce(")+a.a(d)+R(", "+b.a()+")")}else return d.shift(),c.a(d)+R(".reduce("+a.a()+", "+b.a()+")");else return c.a()+".reduce("+a.a()+", "+b.a()+")"},function(c,e){var h=new $a,i=a.compile(e);F(h,1,i);F(h,2,b.i[0]);F(h,3,b.i[1]);h.n(b.body.compile(e));
F(c,9,h)})};z.prototype.reduce=z.prototype.reduce;
z.prototype.Ya=function(a,b,c,d){x(arguments,4);var a=u(a),b=u(b),c=q(c),d=u(d),e=this;return y(S,32,[this],function(h){var i=e.a(),l=a.a(),v=b.a(),s=c.a(),B=d.a();if(h){var da=h.shift();if("arg:0"===da)return e.a(h)+R(".groupedMapReduce("+l+", "+v+", "+s+", "+B+")");if("group_mapping"===da)return R(i+".groupedMapReduce(")+a.a(h)+R(", "+v+", "+s+", "+B+")");if("value_mapping"===da)return R(i+".groupedMapReduce("+l+", ")+b.a(h)+R(", "+s+", "+B+")");da=h.shift();return"base"===da?R(i+".groupedMapReduce("+
l+", "+v+", ")+c.a(h)+R(", "+B+")"):R(i+".groupedMapReduce("+l+", "+v+", "+s+", ")+d.a(h)+" "}return i+".groupedMapReduce("+l+", "+v+", "+s+", "+B+")"},function(e,i){var l=new O;l.B(a.i[0]);l.n(a.body.compile(i));var v=new O;v.B(b.i[0]);v.n(b.body.compile(i));var s=new $a,B=c.compile(i);F(s,1,B);F(s,2,d.i[0]);F(s,3,d.i[1]);s.n(d.body.compile(i));B=new Ya;F(B,1,l);F(B,2,v);F(B,3,s);F(e,10,B)})};z.prototype.groupedMapReduce=z.prototype.Ya;
z.prototype.contains=function(a){w(a,"string");var b=this;return y(S,4,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+R(".contains("+a+")"):R(b.a())+Q(".contains("+a+")"):b.a()+".contains("+a+")"},function(b){b.W(a)})};z.prototype.contains=z.prototype.contains;z.prototype.ba=function(a){w(a,"string");var b=this;return y(S,2,[this],function(c){return c?"arg:0"===c[0]?(c.shift(),b.a(c)):R(b.a())+Q("('"+a+"')"):b.a()+"('"+a+"')"},function(b){b.W(a)})};z.prototype.getAttr=z.prototype.ba;
z.prototype.Ha=function(){var a=Array.prototype.slice.call(arguments,0);n(a)||(a=[a]);a.forEach(function(a){w(a,"string")});var b=this;return y(S,6,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+R(".pick("+d.join(", ")+")")):b.a()+".pick("+d.join(", ")+")"},function(b){for(var d in a)I(b,3,a[d])})};z.prototype.pick=z.prototype.Ha;
z.prototype.Ka=function(a){n(a)||(a=[a]);a.forEach(function(a){w(a,"string")});var b=this;return y(S,39,[this],function(c){var d=a.map(function(a){return"'"+a+"'"});return c?(c.shift(),b.a(c)+R(".unpick("+d.join(", ")+")")):b.a()+".unpick("+d.join(", ")+")"},function(b){for(var d in a)I(b,3,a[d])})};z.prototype.unpick=z.prototype.Ka;z.prototype.kb=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return z.prototype.Ha.apply(b,a)})};z.prototype.pluck=z.prototype.kb;
z.prototype.ub=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return z.prototype.Ka.apply(b,a)})};z.prototype.without=z.prototype.ub;function vb(a){this.La=a}p(vb,z);vb.prototype.compile=function(){var a=new M;a.c(1);a.Q(this.La);return a};vb.prototype.a=function(a){var b="r.letVar('"+this.La+"')";return a?Q(b):b};function wb(){}p(wb,z);wb.prototype.compile=function(){var a=new M;a.c(15);return a};wb.prototype.a=function(a){return a?"^^^^^^^^":"r.R('@')"};
function xb(a,b){S.call(this,2,[a],function(c){return c?"arg:0"===c.shift()?a.a(c)+"('"+b+"')":R(a.a())+Q("('"+b+"')"):a.a()+"('"+b+"')"},function(a){a.W(b)})}p(xb,S);function ga(a){w(a,"string");var a=a.split("."),b=a.shift();"@"===b[0]&&1<b.length?a.unshift(b.slice(1)):"@"!==b[0]&&a.unshift(b);for(var c=y(wb);b=a.shift();)c=y(xb,c,b);return c}o("rethinkdb.R",ga);function qb(a){w(a,"string");for(var a=a.split("."),b=a.shift(),c=y(vb,b);b=a.shift();)c=y(xb,c,b);return c}o("rethinkdb.letVar",qb);
z.prototype.extend=function(a){var a=q(a),b=this;return y(S,8,[this,a],function(c){return c?"arg:0"===c.shift()?b.a(c)+R(".extend("+a.a()+")"):R(b.a()+".extend(")+a.a(c)+" ":b.a()+".extend("+a.a()+")"})};z.prototype.extend=z.prototype.extend;
z.prototype.K=function(a){var a=u(a),b=this;return y(S,22,[this],function(c){return c?"arg:0"===c.shift()?b.a(c)+R(".concatMap("+a.a()+")"):R(b.a()+".concatMap(")+a.a(c)+" ":b.a()+".concatMap("+a.a()+")"},function(b,d){var e=new O;e.B(a.i[0]);e.n(a.body.compile(d));var h=new Wa;h.v(e);F(b,7,h)})};z.prototype.concatMap=z.prototype.K;function yb(a,b,c){this.ja=a;this.ka=b;this.aa=c}p(yb,z);
yb.prototype.compile=function(a){var b=new Pa,c=this.ja.compile(a);F(b,1,c);c=this.ka.compile(a);F(b,2,c);a=this.aa.compile(a);F(b,3,a);a=new M;a.c(4);F(a,5,b);return a};yb.prototype.a=function(a){if(a){var b=a.shift(),c=R(this.ja.a()),d=R(this.ka.a()),e=R(this.aa.a());"test"===b?c=this.ja.a(a):"true"===b?d=this.ka.a(a):e=this.aa.a(a);return"             "+c+"  "+d+"  "+e+" "}return"r.ifThenElse("+this.ja.a()+", "+this.ka.a()+", "+this.aa.a()+")"};
function zb(a,b,c){w(b,r);w(c,r);a=q(a);return y(yb,a,b,c)}o("rethinkdb.ifThenElse",zb);function Ab(a,b){this.la=a;this.Ra=b}p(Ab,z);Ab.prototype.compile=function(a){var b=new Na,c;for(c in this.la)if(this.la.hasOwnProperty(c)){var d=this.la[c],e=new La;e.Q(c);e.ia(d.compile(a));I(b,1,e)}a=this.Ra.compile(a);F(b,2,a);a=new M;a.c(2);F(a,3,b);return a};function Bb(a,b){w(b,r);for(var c in a)a.hasOwnProperty(c)&&w(a[c],z);return y(Ab,a,b)}o("rethinkdb.let",Bb);function Cb(a,b){this.ab=a;this.Ba=b}
p(Cb,r);Cb.prototype.k=function(a){var b=new fb,c=this.ab.compile(a);F(b,1,c);b.Q(this.Ba.i[0]);a=this.Ba.body.k(a);a=H(a,4);if(!a)throw new C("For each requires a write query to execute");I(b,3,a);a=new P;a.c(6);F(a,7,b);b=new E;b.c(2);F(b,4,a);return b};z.prototype.forEach=function(a){a=u(a);return y(Cb,this,a)};z.prototype.forEach=z.prototype.forEach;z.prototype.Xa=function(a,b){return this.K(function(c){return Bb({right:b.get(c(a))},zb(qb("right").ne(t(j)),t([{left:c,right:qb("right")}]),t([])))})};
z.prototype.equiJoin=z.prototype.Xa;z.prototype.Za=function(a,b){return this.K(function(c){return a.K(function(a){return zb(b(c,a),t([{left:c,right:a}]),t([]))})})};z.prototype.innerJoin=z.prototype.Za;z.prototype.jb=function(a,b){return this.K(function(c){return Bb({matches:a.K(function(a){return zb(b(c,a),t({left:c,right:a}),t([]))})},zb(qb("matches").count().gt(0),qb("matches"),t({left:c})))})};z.prototype.outerJoin=z.prototype.jb;
z.prototype.qb=function(){var a=this;return y(S,29,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".streamToArray()"})};z.prototype.streamToArray=z.prototype.qb;z.prototype.Pa=function(){var a=this;return y(S,30,[this],function(b){return b?(b.shift(),a.a(b)+"                "):a.a()+".arrayToStream()"})};z.prototype.arrayToStream=z.prototype.Pa;function A(a,b,c){this.r=a;this.D=b;this.Oa="boolean"===typeof c?c:j}p(A,z);A.prototype.compile=function(a){var b=new M;b.c(13);var c=new Ra,d=new L;d.X(this.D||qa.D);F(d,2,this.r);F(d,3,this.Oa!==j?this.Vc:a&&a.za!==f?a.za:k);c.o(d);F(b,15,c);return b};A.prototype.a=function(a){return a?this.D?Q("r.db("+this.D+").table("+this.r+")"):Q("r.table("+this.r+")"):this.D?"r.db("+this.D+").table("+this.r+")":"r.table("+this.r+")"};function Db(a,b){this.s=a;this.z=b}p(Db,z);
Db.prototype.compile=function(a){var b=this.s.compile(a),c=H(b,15).t(),b=new Qa;b.o(c);b.G("id");b.J(this.z.compile(a));a=new M;a.c(12);F(a,14,b);return a};A.prototype.get=function(a){x(arguments,1);a=q(a);return y(Db,this,a)};A.prototype.get=A.prototype.get;function Eb(a,b){this.s=a;this.Aa=b}p(Eb,r);Eb.prototype.k=function(a){var b=this.s.compile(a),c=H(b,15).t(),b=new eb;b.o(c);for(c=0;c<this.Aa.length;c++){var d=this.Aa[c].compile(a);I(b,2,d)}a=new P;a.c(4);F(a,5,b);b=new E;b.c(2);F(b,4,a);return b};
A.prototype.$a=function(a){x(arguments,1);n(a)||(a=[a]);a=a.map(t);return new Eb(this,a)};A.prototype.insert=A.prototype.$a;function Fb(a){this.Z=a}p(Fb,r);Fb.prototype.k=function(a){var b=new cb;b.Y(this.Z.compile(a));a=new P;a.c(2);F(a,3,b);b=new E;b.c(2);F(b,4,a);return b};function Gb(a,b){this.s=a;this.z=b}p(Gb,r);Gb.prototype.k=function(a){var b=new hb;b.o(Ma(this.s.compile(a)).t());b.G("id");b.J(this.z.compile(a));a=new P;a.c(8);F(a,9,b);b=new E;b.c(2);F(b,4,a);return b};
z.prototype.Ta=function(){return this instanceof Db?new Gb(this.s,this.z):new Fb(this)};z.prototype.del=z.prototype.Ta;function Hb(a,b){this.Z=a;this.u=b}p(Hb,r);Hb.prototype.k=function(a){var b=new O;b.B(this.u.i[0]);b.n(this.u.body.compile(a));var c=new bb;c.Y(this.Z.compile(a));c.v(b);a=new P;a.c(1);F(a,2,c);c=new E;c.c(2);F(c,4,a);return c};function Ib(a,b,c){this.s=a;this.z=b;this.u=c}p(Ib,r);
Ib.prototype.k=function(a){var b=new O;b.B(this.u.i[0]);b.n(this.u.body.compile(a));var c=new gb;c.o(Ma(this.s.compile(a)).t());c.G("id");c.J(this.z.compile(a));c.v(b);a=new P;a.c(7);F(a,8,c);c=new E;c.c(2);F(c,4,a);return c};z.prototype.update=function(a){x(arguments,1);a=u(a);return this instanceof Db?new Ib(this.s,this.z,a):new Hb(this,a)};z.prototype.update=z.prototype.update;function Jb(a,b){this.Z=a;this.u=b}p(Jb,r);
Jb.prototype.k=function(a){var b=new O;b.B(this.u.i[0]);b.n(this.u.body.compile(a));var c=new db;c.Y(this.Z.compile(a));c.v(b);a=new P;a.c(3);F(a,4,c);c=new E;c.c(2);F(c,4,a);return c};function Kb(a,b,c){this.s=a;this.z=b;this.u=c}p(Kb,r);Kb.prototype.k=function(a){var b=new O;b.B(this.u.i[0]);b.n(this.u.body.compile(a));var c=new ib;c.o(Ma(this.s.compile(a)).t());c.G("id");c.J(this.z.compile(a));c.v(b);a=new P;a.c(9);F(a,10,c);c=new E;c.c(2);F(c,4,a);return c};
z.prototype.fb=function(a){x(arguments,1);a=u(a);return this instanceof Db?new Kb(this.s,this.z,a):new Jb(this,a)};z.prototype.mutate=z.prototype.fb;function Lb(a){this.name="Runtime Error";this.message=a||"The RDB runtime experienced an error"}p(Lb,Error);function Mb(a){this.name="Broken Client";this.message=a||"The client sent the server an incorrectly formatted message"}p(Mb,Error);function Nb(a){this.name="Bad Query";this.message=a||"This query contains type errors"}p(Nb,Error);function C(a){this.name="RDB Client Error";this.message=a||"The RDB client has experienced an error"}p(C,Error);
function sb(a,b,c){var d=Array.prototype.slice.call(arguments,2);return function(c){var h=d.map(function(a){return a instanceof r?a.a():a.toString()}),i=b.a()+"."+a+"("+h.join(", ")+")";if(c){if(0===c.length)return Q(i);var l=c[0].split(":");c.shift();if("arg"===l[0])return l[1]=parseInt(l[1],10),h=h.map(R),0===l[1]?i=b.a(c):(i=R(b.a()),l=l[1]-1,c=d[l].a(c),h[l]=c),h=h.join("  "),i+" "+R(a)+" "+h+" "}else return i}}function R(a){return a.replace(/./g," ")}
function Q(a){return a.replace(/./g,"^")};function Ob(){}Ob.prototype.Ca=function(a,b){return 11==a.m||10==a.m?Pb(this,b):b};function Qb(a,b){this.f=a|0;this.d=b|0}var Rb={};function Sb(a){if(-128<=a&&128>a){var b=Rb[a];if(b)return b}b=new Qb(a|0,0>a?-1:0);-128<=a&&128>a&&(Rb[a]=b);return b}function T(a){return isNaN(a)||!isFinite(a)?Tb:a<=-Ub?U:a+1>=Ub?Vb:0>a?V(T(-a)):new Qb(a%Wb|0,a/Wb|0)}function W(a,b){return new Qb(a,b)}var Wb=4294967296,Ub=Wb*Wb/2,Tb=Sb(0),Xb=Sb(1),Yb=Sb(-1),Vb=W(-1,2147483647),U=W(0,-2147483648),Zb=Sb(16777216);m=Qb.prototype;
m.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if($b(this))return"0";if(0>this.d){if(this.j(U)){var b=T(a),c=ac(this,b),b=bc(c.multiply(b),this);return c.toString(a)+b.f.toString(a)}return"-"+V(this).toString(a)}for(var c=T(Math.pow(a,6)),b=this,d="";;){var e=ac(b,c),h=bc(b,e.multiply(c)).f.toString(a),b=e;if($b(b))return h+d;for(;6>h.length;)h="0"+h;d=""+h+d}};function cc(a){return 0<=a.f?a.f:Wb+a.f}function $b(a){return 0==a.d&&0==a.f}
m.j=function(a){return this.d==a.d&&this.f==a.f};function dc(a,b){if(a.j(b))return 0;var c=0>a.d,d=0>b.d;return c&&!d?-1:!c&&d?1:0>bc(a,b).d?-1:1}function V(a){return a.j(U)?U:a.oa().add(Xb)}m.add=function(a){var b=this.d>>>16,c=this.d&65535,d=this.f>>>16,e=a.d>>>16,h=a.d&65535,i=a.f>>>16,l;l=0+((this.f&65535)+(a.f&65535));a=0+(l>>>16);a+=d+i;d=0+(a>>>16);d+=c+h;c=0+(d>>>16);return W((a&65535)<<16|l&65535,(c+(b+e)&65535)<<16|d&65535)};function bc(a,b){return a.add(V(b))}
m.multiply=function(a){if($b(this)||$b(a))return Tb;if(this.j(U))return 1==(a.f&1)?U:Tb;if(a.j(U))return 1==(this.f&1)?U:Tb;if(0>this.d)return 0>a.d?V(this).multiply(V(a)):V(V(this).multiply(a));if(0>a.d)return V(this.multiply(V(a)));if(0>dc(this,Zb)&&0>dc(a,Zb))return T((this.d*Wb+cc(this))*(a.d*Wb+cc(a)));var b=this.d>>>16,c=this.d&65535,d=this.f>>>16,e=this.f&65535,h=a.d>>>16,i=a.d&65535,l=a.f>>>16,a=a.f&65535,v,s,B,da;da=0+e*a;B=0+(da>>>16);B+=d*a;s=0+(B>>>16);B=(B&65535)+e*l;s+=B>>>16;s+=c*a;
v=0+(s>>>16);s=(s&65535)+d*l;v+=s>>>16;s=(s&65535)+e*i;v+=s>>>16;return W((B&65535)<<16|da&65535,(v+(b*a+c*l+d*i+e*h)&65535)<<16|s&65535)};
function ac(a,b){if($b(b))throw Error("division by zero");if($b(a))return Tb;if(a.j(U)){if(b.j(Xb)||b.j(Yb))return U;if(b.j(U))return Xb;var c=ac(ec(a,1),b).shiftLeft(1);if(c.j(Tb))return 0>b.d?Xb:Yb;var d=bc(a,b.multiply(c));return c.add(ac(d,b))}if(b.j(U))return Tb;if(0>a.d)return 0>b.d?ac(V(a),V(b)):V(ac(V(a),b));if(0>b.d)return V(ac(a,V(b)));for(var e=Tb,d=a;0<=dc(d,b);){for(var c=Math.max(1,Math.floor((d.d*Wb+cc(d))/(b.d*Wb+cc(b)))),h=Math.ceil(Math.log(c)/Math.LN2),h=48>=h?1:Math.pow(2,h-48),
i=T(c),l=i.multiply(b);0>l.d||0<dc(l,d);)c-=h,i=T(c),l=i.multiply(b);$b(i)&&(i=Xb);e=e.add(i);d=bc(d,l)}return e}m.oa=function(){return W(~this.f,~this.d)};m.va=function(a){return W(this.f&a.f,this.d&a.d)};m.Ga=function(a){return W(this.f|a.f,this.d|a.d)};function fc(a,b){return W(a.f^b.f,a.d^b.d)}m.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.f;return 32>a?W(b<<a,this.d<<a|b>>>32-a):W(0,b<<a-32)};
function ec(a,b){b&=63;if(0==b)return a;var c=a.d;return 32>b?W(a.f>>>b|c<<32-b,c>>b):W(c>>b-32,0<=c?0:-1)};function gc(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}function hc(a){return new Uint8Array(Array.prototype.map.call(a,function(a){return a.charCodeAt(0)}))}function ic(){this.q=0}p(ic,Ob);function X(a){throw new va("Error deserializing incorrectly formated message, "+a);}
function Pb(a,b){for(var c=Ga(b.ca()),d=[],e=0,h=0;h<c.length;h++){var i=c[h];if(Ha(b,i.p)){var l=0;do{var v=a.Ca(i,b.get(i,l));d.push(v);e+=v.byteLength;l++}while(i.S&&l<Ka(b,i.p))}}c=new Uint8Array(e);for(h=e=0;h<d.length;h++)i=d[h],c.set(new Uint8Array(i),e),e+=i.byteLength;return c}
ic.prototype.Ca=function(a,b){var c=a.m,d=jc[c],e=kc(T(a.p<<3|d)),h;switch(d){case Y:var i=T(b);if(c==Ba||17==c)i=fc(i.shiftLeft(1),ec(i,63));h=kc(i);break;case lc:i=new ArrayBuffer(8);c=new DataView(i);switch(a.m){case 1:c.setFloat64(0,b,g);break;case za:h=T(b);c.setUint32(0,cc(h),g);c.setUint32(4,h.d,g);break;case Aa:h=T(b);c.setUint32(0,cc(h),g);c.setInt32(4,h.d,g);break;default:X("Unexpected field type")}h=new Uint8Array(i);break;case mc:switch(a.m){case 11:i=Pb(this,b);break;case 9:i=hc(unescape(encodeURIComponent(b)));
break;case 12:i=hc(b);break;default:X("Unexpected field type")}h=i.length;c=kc(T(h));h=new Uint8Array(c.length+h);h.set(c,0);h.set(i,c.length);break;case nc:X("Use of Groups deprecated and not supported");break;case oc:i=new ArrayBuffer(4);c=new DataView(i);switch(a.m){case 2:c.setFloat32(0,b,g);break;case 7:c.setUint32(0,b,g);break;case 15:c.setInt32(0,b,g);break;default:X("Unexpected field type")}h=new Uint8Array(i);break;default:X("Unexpected wire type")}i=new Uint8Array(e.length+h.length);i.set(new Uint8Array(e),
0);i.set(new Uint8Array(h),e.length);return i};function kc(a){function b(a){var d=T(128),d=bc(a,ac(a,d).multiply(d)).f,e=T(127);0<dc(a,e)?(d+=128,a=b(ec(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function pc(a,b,c){var d=b.ca();for(a.q=0;a.q<c.length;){var e=qc(a,c),h=d.F[parseInt(e>>3,10)]||j,i=a,l=e%8,v=h,e=c,s=f;switch(l){case Y:e=qc(i,e);if(v){i=f;switch(v.m){case xa:case ya:i=e.toString();break;case 5:case 13:case 14:i=e;break;case 17:e=T(e);i=fc(ec(e,1),e.shiftLeft(63)).f;break;case Ba:e=T(e);i=fc(ec(e,1),e.shiftLeft(63)).toString();break;case 8:i=0===i?k:g;break;default:X("Unexpected field type")}s=i}else s=j;break;case mc:l=e;e=qc(i,l);l=new Uint8Array(l.buffer,l.byteOffset+i.q,e);
i.q+=e;if(v){e=f;switch(v.m){case 9:e=decodeURIComponent(escape(gc(l)));break;case 12:e=gc(l);break;case 11:e=l;i=new ic;v=new v.Fa.M.cb;pc(i,v,e);e=v;break;default:X("Unexpected field type")}s=e}else s=j;break;case oc:e=new DataView(e.buffer,i.q,4);i.q+=4;if(v){i=f;switch(v.m){case 2:i=e.getFloat32(0,g);break;case 7:i=e.getUint32(0,g);break;case 15:i=e.getInt32(0,g);break;default:X("Unexpected field type")}s=i}else s=j;break;case lc:e=new DataView(e.buffer,i.q,8);i.q+=8;if(v){i=f;switch(v.m){case 1:i=
e.getFloat64(0,g);break;case za:i=(new Qb(e.getUint32(0,g),e.getUint32(4,g))).toString();break;case Aa:i=(new Qb(e.getUint32(0,g),e.getInt32(4,g))).toString();break;default:X("Unexpected field type")}s=i}else s=j;break;default:X("Unexpected wire type of "+l)}e=s;h!=j&&e!=j&&(h.S?b.add(h,e):b.set(h,e))}}function qc(a,b){var c=b[a.q++];if(127<c)var c=c-128,d=qc(a,b),c=c+(d<<7);return c}var Y=0,lc=1,mc=2,nc=3,oc=5,jc=[-1,lc,oc,Y,Y,Y,lc,oc,Y,mc,nc,mc,mc,Y,Y,oc,lc,Y,Y];function D(a,b){"undefined"===typeof a?a={}:"string"===typeof a&&(a={host:a});this.da=a.host||this.Na;this.fa=a.port||this.ta;this.D=a.db||this.Ma;w(this.da,"string");w(this.fa,"number");w(this.D,"string");this.U={};this.gb=1;this.$=b||j;qa=this}D.prototype.Na="localhost";D.prototype.ta=12346;D.prototype.Ma="test";D.prototype.mb=function(a){this.constructor.call(this,{host:this.da,port:this.fa,db:this.D},a,this.$)};D.prototype.reconnect=D.prototype.mb;
function Z(a,b){if(a.$)a.$(b);else if(a.qa)console.log(b.name+":"+b.message);else throw b;}D.prototype.nb=function(a){this.$=a};D.prototype.setErrorHandler=D.prototype.nb;
function rc(a,b){var c={expr:t(j),callback:function(){},iterate:k,doneCallback:function(){},allowOutdated:k,onError:j};ra(c,b);w(c.expr,r);w(c.callback,"function");w(c.iterate,"boolean");w(c.doneCallback,"function");w(c.allowOutdated,"boolean");var d=c.expr.k({za:c.allowOutdated});d.ra((a.gb++).toString());a.U[d.O()]={l:c.callback,lb:c.expr,T:c.iterate,N:c.doneCallback,H:c.onError,pa:[]};sc(a,d)}
function sc(a,b){var c=Pb(new ic,b),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,g);e.set(c,4);a.Ja(e.buffer)}D.prototype.ga=function(a,b){x(arguments,1);this.qa=k;var c={};a instanceof r?(c.expr=a,c.callback=b):ra(c,a);rc(this,c)};D.prototype.run=D.prototype.ga;D.prototype.ha=function(a){x(arguments,1);this.qa=g;var b={};a instanceof r?b.expr=a:ra(b,a);b.callback=function(a){console.log(a)};rc(this,b)};D.prototype.runp=D.prototype.ha;
D.prototype.ea=function(a,b,c){x(arguments,1);this.qa=k;var d={};a instanceof r?(d.expr=a,d.callback=b,d.doneCallback=c):ra(d,a);d.iterate=g;rc(this,d)};D.prototype.iter=D.prototype.ea;
function tc(a,b){(new DataView(b.buffer)).getUint32(0,g)!==b.length-4&&Z(a,new C("RDB response corrupted, length inaccurate"));var c=new ic,d=new mb;try{pc(c,d,new Uint8Array(b.buffer,4))}catch(e){Z(a,new C("response deserialization failed"))}var h=H(d,1);if(c=a.U[d.O()])switch(h){case 101:d=new Mb(H(d,4));c.H?c.H(d):Z(a,d);break;case 103:var h=c.lb,i=H(d,4),d=H(d,5),l=[];d&&(l=Ja(d,1));d=i+"\n\t"+h.a()+"\n\t"+h.a(l);d=new Lb(d);c.H?c.H(d):Z(a,d);break;case 102:d=new Nb(H(d,4));c.H?c.H(d):Z(a,d);
break;case 0:delete a.U[d.O()];c.T?c.N&&c.N():c.l&&c.l();break;case 3:delete a.U[d.O()];d=Ja(d,3).map(JSON.parse);c.l&&(c.T?d.forEach(c.l):c.l(c.pa.concat(d)));c.N&&c.T&&c.N();break;case 1:delete a.U[d.O()];d=JSON.parse(H(d,3,0));c.T?(d.forEach&&c.l?d.forEach(c.l):c.l&&c.l(d),c.N&&c.N()):c.l&&c.l(d);break;case 2:h=new E;h.c(3);h.ra(d.Da());sc(a,h);d=Ja(d,3).map(JSON.parse);c.l&&(c.T?d.forEach(c.l):c.pa=c.pa.concat(d));break;default:d=new C("unknown response status code"),c.H?c.H(d):Z(a,d)}};function uc(a,b){this.tb=a;this.L=b||j}p(uc,r);uc.prototype.k=function(){var a=new jb;a.c(this.tb);this.L&&a.X(this.L);var b=new E;b.c(5);F(b,5,a);return b};o("rethinkdb.dbCreate",function(a){x(arguments,1);w(a,"string");return new uc(1,a)});o("rethinkdb.dbDrop",function(a){x(arguments,1);w(a,"string");return new uc(2,a)});o("rethinkdb.dbList",function(){return new uc(3)});function $(a){this.r=a}o("rethinkdb.db",function(a){x(arguments,1);w(a,"string");return new $(a)});
$.prototype.list=function(){return new uc(6,this.r)};$.prototype.list=$.prototype.list;function vc(a,b,c,d,e){this.ya=a;this.L=b;this.sa=c;this.Ia=d;this.xa=e}p(vc,r);vc.prototype.k=function(){var a=new L;a.X(this.L);F(a,2,this.sa);var b=new kb;this.ya&&F(b,1,this.ya);b.o(a);this.Ia&&F(b,4,this.Ia);this.xa&&F(b,5,this.xa);a=new jb;a.c(4);F(a,3,b);b=new E;b.c(5);F(b,5,a);return b};
$.prototype.create=function(a){x(arguments,1);var b={};"string"===typeof a?b.tableName=a:b=a;w(b.tableName,"string");w(b.primaryKey,"string");w(b.dataCenter,"string");w(b.cacheSize,"string");return new vc(b.dataCenter,this.r,b.tableName,b.primaryKey,b.cacheSize)};$.prototype.create=$.prototype.create;function wc(a,b){x(arguments,1);this.L=a;this.sa=b}p(wc,r);wc.prototype.k=function(){var a=new L;a.X(this.L);F(a,2,this.sa);var b=new jb;b.c(5);F(b,4,a);a=new E;a.c(5);F(a,5,b);return a};
$.prototype.Wa=function(a){x(arguments,1);w(a,"string");return new wc(this.r,a)};$.prototype.drop=$.prototype.Wa;$.prototype.rb=function(a,b){x(arguments,1);w(a,"string");w(b,"boolean");return new A(a,this.r,b)};$.prototype.table=$.prototype.rb;function xc(a,b,c){w(b,"function");w(c,"function");D.call(this,a,c);this.R="";var d=this,e="http://"+this.da+":"+this.fa+"/ajax/reql/",h=new XMLHttpRequest;h.responseType="arraybuffer";h.open("GET",e+"open-new-connection",g);h.onreadystatechange=function(){4===h.readyState&&(200===h.status?(d.R=e,d.ma=(new DataView(h.response)).getInt32(0,g),b&&b(d)):Z(d,new C("Unabled to establish HTTP connection")))};h.send()}p(xc,D);o("rethinkdb.HttpConnection",xc);xc.prototype.ta=21300;
xc.prototype.Ja=function(a){this.R||Z(this,new C("Connection not open"));var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.R+"?conn_id="+this.ma,g);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&tc(c,new Uint8Array(b.response))};b.send(a)};xc.prototype.close=function(){this.R||Z(this,new C("Connection not open"));var a=new XMLHttpRequest;a.open("POST",this.R+"close-connection?conn_id="+this.ma,g);a.send();this.R=this.ma=j};xc.prototype.close=xc.prototype.close;function yc(a,b,c){zc()||Z(this,new C("Cannot instantiate TcpConnection, TCP sockets are not available in this environment."));w(b,"function");w(c,"function");D.call(this,a,c);this.P=j;this.ad=0;this.C=j;var d=this;d.C=j;var e=require("net").connect(this.fa,this.da,function(){e.write("35ba61af","hex");e.on("data",fa(d.sb,d));e.on("end",function(){d.C=j;Z(d,new Lb("Server disconnected"))});d.C=e;b&&b(d)});e.on("error",function(){Z(d,new C("Unabled to establish TCP connection"))})}p(yc,D);
o("rethinkdb.TcpConnection",yc);function zc(){return"undefined"!==typeof require&&require("net")}yc.isAvailable=zc;yc.prototype.Ja=function(a){this.C||Z(this,new C("Connection not open"));for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.C.write(b)};
yc.prototype.sb=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.P===j){var d=(new DataView(a.buffer,b,c)).getUint32(0,g);this.P=new Uint8Array(d+4);this.V=0}var d=this.P.byteLength-this.V,e=c<d?c:d,h=new Uint8Array(a.buffer,b,e);this.P.set(h,this.V);this.V+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.P,this.P=j,this.V=0,tc(this,d))}};
yc.prototype.close=function(){this.C||Z(this,new C("Connection not open"));var a=this;this.C.removeAllListeners("end");this.C.on("close",function(){a.C=j});this.C.end()};yc.prototype.close=yc.prototype.close;o("rethinkdb.connect",function(a,b,c){return zc()?new yc(a,b,c):new xc(a,b,c)});var qa=j;o("rethinkdb.getLastConnection",function(){return qa});"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
