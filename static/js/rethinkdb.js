(function(){
function f(a){throw a;}var h=void 0,i=!0,k=null,l=!1,m,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function n(a){return"array"==ba(a)}Math.floor(2147483648*Math.random()).toString(36);function ca(a,b,c){return a.call.apply(a.bind,arguments)}function da(a,b,c){a||f(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ea(a,b,c){ea=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return ea.apply(k,arguments)}function fa(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==h?d[e]=b:d=d[e]?d[e]:d[e]={}}function o(a,b){function c(){}c.prototype=b.prototype;a.tc=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ga(a){Error.captureStackTrace?Error.captureStackTrace(this,ga):this.stack=Error().stack||"";a&&(this.message=String(a))}o(ga,Error);ga.prototype.name="CustomError";function ha(a,b,c){this.qc=a;this.j=b;this.C=c.name;this.B=!!c.m;this.pc=!!c.required;this.i=c.a;this.ia=c.type;this.wa=l;switch(this.i){case ia:case ja:case ka:case la:case ma:this.wa=i}this.S=c.defaultValue}var ia=3,ja=4,ka=6,la=16,ma=18;var na=Array.prototype;function oa(a,b){return a>b?1:a<b?-1:0};function pa(a,b,c){this.Fa=a;this.C=b.name||k;this.oc=b.d||k;this.lc=b.g;this.o={};for(a=0;a<c.length;a++)b=c[a],this.o[b.j]=b}function qa(a){var a=a.o,b=[],c=0,d;for(d in a)b[c++]=a[d];na.sort.call(b,function(a,b){return a.j-b.j}||oa);return b};function p(){this.l={};this.s=this.constructor.s;this.o=this.s.o;this.q=this.ha=k}m=p.prototype;m.I=function(){return this.s};m.get=function(a,b){return t(this,a.j,b)};m.set=function(a,b){u(this,a.j,b)};m.add=function(a,b){ra(this,a.j,b)};
m.h=function(a){if(!a||this.constructor!=a.constructor)return l;for(var b=qa(this.I()),c=0;c<b.length;c++){var d=b[c];if(v(this,d.j)!=v(a,d.j))return l;if(v(this,d.j)){var e=11==d.i||10==d.i,j=sa(this,d),g=sa(a,d);if(d.B){if(j.length!=g.length)return l;for(d=0;d<j.length;d++)if(!(e?j[d].h(g[d]):j[d]==g[d]))return l}else if(!(e?j.h(g):j==g))return l}}return i};function v(a,b){return b in a.l&&a.l[b]!==h&&a.l[b]!==k}
function sa(a,b){var c=b.j;if(!c in a.l)return k;var d=a.l[c];return d==k?k:a.ha?!(c in a.q)?(d=a.ha.mc(a,b,d),a.q[c]=d):a.q[c]:d}function t(a,b,c){b=a.o[b];a=sa(a,b);if(b.B)return n(a),a[c||0];n(a);return a}function x(a,b){var c;if(v(a,b))c=t(a,b,h);else{c=a.o[b];if(c.S===h){var d=c.ia;c.S=d===Boolean?l:d===Number?0:d===String?"":new d}c=c.S}return c}function ta(a,b){return a.o[b].B?(v(a,b)&&n(a.l[b]),v(a,b)?a.l[b].length:0):v(a,b)?1:0}function u(a,b,c){a.l[b]=c;a.q&&(a.q[b]=c)}
function ra(a,b,c){a.l[b]||(a.l[b]=[]);a.l[b].push(c);a.q&&delete a.q[b]}function y(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new ha(a,e,b[e])));a.s=new pa(a,d,c);a.I=function(){return a.s}};function z(){p.apply(this)}o(z,p);function ua(){p.apply(this)}o(ua,p);ua.prototype.X=function(a){u(this,1,a)};ua.prototype.na=function(a){u(this,2,a)};function A(){p.apply(this)}o(A,p);A.prototype.b=function(a){u(this,1,a)};A.prototype.X=function(a){u(this,2,a)};var B=3,va={yb:0,jc:1,Bb:2,Ya:B,rb:4,ib:5,Mb:6,$b:7,JSON:8,BOOL:9,Ta:10,Nb:11,nb:12,fc:13,xb:14};function wa(){p.apply(this)}o(wa,p);function C(){p.apply(this)}o(C,p);function D(a,b){ra(a,2,b)}function xa(){p.apply(this)}o(xa,p);
function E(){p.apply(this)}o(E,p);E.prototype.p=function(){return x(this,1)};E.prototype.n=function(a){u(this,1,a)};E.prototype.w=function(a){u(this,2,a)};E.prototype.N=function(a){u(this,3,a)};function ya(){p.apply(this)}o(ya,p);ya.prototype.p=function(){return x(this,1)};ya.prototype.n=function(a){u(this,1,a)};function F(){p.apply(this)}o(F,p);F.prototype.b=function(a){u(this,1,a)};F.prototype.M=function(a){u(this,2,a)};
var za=19,Aa={Kb:1,mb:2,sb:3,qb:4,tb:5,Pb:6,ub:7,Fb:8,Ua:9,Xb:11,Qa:14,ac:15,Hb:16,fb:17,Gb:18,Za:za,jb:20,Eb:21,$a:22,Ob:23,eb:24,Ab:26,hc:27,Lb:28,Zb:29,Va:30,Vb:31,ob:32,Sa:35,Ra:36,Tb:37};function Ba(){p.apply(this)}o(Ba,p);function Ca(){p.apply(this)}o(Ca,p);Ca.prototype.z=function(a){u(this,1,a)};function Da(){p.apply(this)}o(Da,p);Da.prototype.z=function(a){u(this,1,a)};function Ea(){p.apply(this)}o(Ea,p);Ea.prototype.M=function(a){u(this,1,a)};function Fa(){p.apply(this)}o(Fa,p);
function Ga(){p.apply(this)}o(Ga,p);Ga.prototype.w=function(a){u(this,1,a)};function Ha(){p.apply(this)}o(Ha,p);Ha.prototype.G=function(a){u(this,4,a)};function G(){p.apply(this)}o(G,p);G.prototype.W=function(a){u(this,1,a)};G.prototype.G=function(a){u(this,2,a)};function Ia(){p.apply(this)}o(Ia,p);Ia.prototype.W=function(a){u(this,1,a)};Ia.prototype.G=function(a){u(this,2,a)};function Ja(){p.apply(this)}o(Ja,p);Ja.prototype.na=function(a){u(this,1,a)};function H(){p.apply(this)}o(H,p);
H.prototype.b=function(a){u(this,1,a)};function Ka(){p.apply(this)}o(Ka,p);Ka.prototype.z=function(a){u(this,2,a)};function La(){p.apply(this)}o(La,p);function Ma(){p.apply(this)}o(Ma,p);Ma.prototype.z=function(a){u(this,2,a)};function Na(){p.apply(this)}o(Na,p);Na.prototype.p=function(){return x(this,1)};Na.prototype.n=function(a){u(this,1,a)};function Oa(){p.apply(this)}o(Oa,p);Oa.prototype.p=function(){return x(this,1)};Oa.prototype.n=function(a){u(this,1,a)};function Pa(){p.apply(this)}o(Pa,p);
Pa.prototype.X=function(a){u(this,2,a)};function Qa(){p.apply(this)}o(Qa,p);m=Qa.prototype;m.p=function(){return x(this,1)};m.n=function(a){u(this,1,a)};m.w=function(a){u(this,2,a)};m.N=function(a){u(this,3,a)};m.z=function(a){u(this,4,a)};function I(){p.apply(this)}o(I,p);I.prototype.p=function(){return x(this,1)};I.prototype.n=function(a){u(this,1,a)};I.prototype.w=function(a){u(this,2,a)};I.prototype.N=function(a){u(this,3,a)};function Ra(){p.apply(this)}o(Ra,p);m=Ra.prototype;
m.p=function(){return x(this,1)};m.n=function(a){u(this,1,a)};m.w=function(a){u(this,2,a)};m.N=function(a){u(this,3,a)};m.z=function(a){u(this,4,a)};function Sa(){p.apply(this)}o(Sa,p);Sa.prototype.b=function(a){u(this,1,a)};function Ta(){p.apply(this)}o(Ta,p);Ta.prototype.p=function(){return x(this,2)};Ta.prototype.n=function(a){u(this,2,a)};function J(){p.apply(this)}o(J,p);J.prototype.b=function(a){u(this,1,a)};J.prototype.u=function(){return t(this,2)};J.prototype.oa=function(a){u(this,2,a)};
function Ua(){p.apply(this)}o(Ua,p);Ua.prototype.u=function(){return t(this,2)};Ua.prototype.oa=function(a){u(this,2,a)};function Va(){p.apply(this)}o(Va,p);y(z,{"0":{name:"TableRef",d:"TableRef"},1:{name:"db_name",a:9,type:String},2:{name:"table_name",a:9,type:String}});y(ua,{"0":{name:"VarTermTuple",d:"VarTermTuple"},1:{name:"var",a:9,type:String},2:{name:"term",a:11,type:A}});
y(A,{"0":{name:"Term",d:"Term"},1:{name:"type",a:14,defaultValue:0,type:va},2:{name:"var",a:9,type:String},3:{name:"let",a:11,type:wa},4:{name:"call",a:11,type:C},5:{name:"if_",a:11,type:xa},6:{name:"error",a:9,type:String},7:{name:"number",a:1,type:Number},8:{name:"valuestring",a:9,type:String},9:{name:"jsonstring",a:9,type:String},10:{name:"valuebool",a:8,type:Boolean},11:{name:"array",m:i,a:11,type:A},12:{name:"object",m:i,a:11,type:ua},14:{name:"get_by_key",a:11,type:E},15:{name:"table",a:11,
type:ya},16:{name:"javascript",a:9,type:String}});y(wa,{"0":{name:"Let",g:A,d:"Term.Let"},1:{name:"binds",m:i,a:11,type:ua},2:{name:"expr",a:11,type:A}});y(C,{"0":{name:"Call",g:A,d:"Term.Call"},1:{name:"builtin",a:11,type:F},2:{name:"args",m:i,a:11,type:A}});y(xa,{"0":{name:"If",g:A,d:"Term.If"},1:{name:"test",a:11,type:A},2:{name:"true_branch",a:11,type:A},3:{name:"false_branch",a:11,type:A}});
y(E,{"0":{name:"GetByKey",g:A,d:"Term.GetByKey"},1:{name:"table_ref",a:11,type:z},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:A}});y(ya,{"0":{name:"Table",g:A,d:"Term.Table"},1:{name:"table_ref",a:11,type:z}});
y(F,{"0":{name:"Builtin",d:"Builtin"},1:{name:"type",a:14,defaultValue:1,type:Aa},2:{name:"attr",a:9,type:String},3:{name:"attrs",m:i,a:9,type:String},4:{name:"comparison",a:14,defaultValue:1,type:{hb:1,Jb:2,Db:3,zb:4,pb:5,lb:6}},5:{name:"filter",a:11,type:Ba},6:{name:"map",a:11,type:Ca},7:{name:"concat_map",a:11,type:Da},8:{name:"order_by",m:i,a:11,type:Ea},9:{name:"reduce",a:11,type:Ha},10:{name:"grouped_map_reduce",a:11,type:Fa},11:{name:"range",a:11,type:Ga}});
y(Ba,{"0":{name:"Filter",g:F,d:"Builtin.Filter"},1:{name:"predicate",a:11,type:Ia}});y(Ca,{"0":{name:"Map",g:F,d:"Builtin.Map"},1:{name:"mapping",a:11,type:G}});y(Da,{"0":{name:"ConcatMap",g:F,d:"Builtin.ConcatMap"},1:{name:"mapping",a:11,type:G}});y(Ea,{"0":{name:"OrderBy",g:F,d:"Builtin.OrderBy"},1:{name:"attr",a:9,type:String},2:{name:"ascending",a:8,defaultValue:1,type:Boolean}});
y(Fa,{"0":{name:"GroupedMapReduce",g:F,d:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",a:11,type:G},2:{name:"value_mapping",a:11,type:G},3:{name:"reduction",a:11,type:Ha}});y(Ga,{"0":{name:"Range",g:F,d:"Builtin.Range"},1:{name:"attrname",a:9,type:String},2:{name:"lowerbound",a:11,type:A},3:{name:"upperbound",a:11,type:A}});y(Ha,{"0":{name:"Reduction",d:"Reduction"},1:{name:"base",a:11,type:A},2:{name:"var1",a:9,type:String},3:{name:"var2",a:9,type:String},4:{name:"body",a:11,type:A}});
y(G,{"0":{name:"Mapping",d:"Mapping"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:A}});y(Ia,{"0":{name:"Predicate",d:"Predicate"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:A}});y(Ja,{"0":{name:"ReadQuery",d:"ReadQuery"},1:{name:"term",a:11,type:A},2:{name:"max_chunk_size",a:3,type:String},3:{name:"max_age",a:3,type:String}});
y(H,{"0":{name:"WriteQuery",d:"WriteQuery"},1:{name:"type",a:14,defaultValue:1,type:{ic:1,cb:2,Ib:3,vb:4,wb:5,kb:6,Sb:7,Qb:8,Rb:9}},2:{name:"update",a:11,type:Ka},3:{name:"delete",a:11,type:La},4:{name:"mutate",a:11,type:Ma},5:{name:"insert",a:11,type:Na},6:{name:"insert_stream",a:11,type:Oa},7:{name:"for_each",a:11,type:Pa},8:{name:"point_update",a:11,type:Qa},9:{name:"point_delete",a:11,type:I},10:{name:"point_mutate",a:11,type:Ra}});
y(Ka,{"0":{name:"Update",g:H,d:"WriteQuery.Update"},1:{name:"view",a:11,type:A},2:{name:"mapping",a:11,type:G}});y(La,{"0":{name:"Delete",g:H,d:"WriteQuery.Delete"},1:{name:"view",a:11,type:A}});y(Ma,{"0":{name:"Mutate",g:H,d:"WriteQuery.Mutate"},1:{name:"view",a:11,type:A},2:{name:"mapping",a:11,type:G}});y(Na,{"0":{name:"Insert",g:H,d:"WriteQuery.Insert"},1:{name:"table_ref",a:11,type:z},2:{name:"terms",m:i,a:11,type:A}});
y(Oa,{"0":{name:"InsertStream",g:H,d:"WriteQuery.InsertStream"},1:{name:"table_ref",a:11,type:z},2:{name:"stream",a:11,type:A}});y(Pa,{"0":{name:"ForEach",g:H,d:"WriteQuery.ForEach"},1:{name:"stream",a:11,type:A},2:{name:"var",a:9,type:String},3:{name:"queries",m:i,a:11,type:H}});y(Qa,{"0":{name:"PointUpdate",g:H,d:"WriteQuery.PointUpdate"},1:{name:"table_ref",a:11,type:z},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:A},4:{name:"mapping",a:11,type:G}});
y(I,{"0":{name:"PointDelete",g:H,d:"WriteQuery.PointDelete"},1:{name:"table_ref",a:11,type:z},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:A}});y(Ra,{"0":{name:"PointMutate",g:H,d:"WriteQuery.PointMutate"},1:{name:"table_ref",a:11,type:z},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:A},4:{name:"mapping",a:11,type:G}});
y(Sa,{"0":{name:"TableopQuery",d:"TableopQuery"},1:{name:"type",a:14,defaultValue:1,type:{bb:1,gb:2,Cb:3}},2:{name:"create",a:11,type:Ta},3:{name:"drop",a:11,type:z}});y(Ta,{"0":{name:"Create",g:Sa,d:"TableopQuery.Create"},1:{name:"datacenter",a:9,type:String},2:{name:"table_ref",a:11,type:z},3:{name:"primary_key",a:9,type:String}});
y(J,{"0":{name:"Query",d:"Query"},1:{name:"type",a:14,defaultValue:1,type:{Ub:1,kc:2,ab:3,Yb:4,gc:5}},2:{name:"token",a:3,type:String},3:{name:"read_query",a:11,type:Ja},4:{name:"write_query",a:11,type:H},5:{name:"tableop_query",a:11,type:Sa}});
y(Ua,{"0":{name:"Response",d:"Response"},1:{name:"status_code",a:14,defaultValue:0,type:{bc:0,cc:1,dc:2,ec:3,Xa:101,Wa:102,Wb:103}},2:{name:"token",a:3,type:String},3:{name:"response",m:i,a:9,type:String},4:{name:"error_message",a:9,type:String},5:{name:"backtrace",a:11,type:Va}});y(Va,{"0":{name:"Backtrace",g:Ua,d:"Response.Backtrace"},1:{name:"frame",m:i,a:9,type:String}});function K(a){return K.t(a)}fa("rethinkdb.query",K);function L(){}L.prototype.L=function(a,b){b=b||Wa;b.L(this,a)};L.prototype.run=L.prototype.L;function M(){}o(M,L);M.prototype.ca=function(){var a=new Ja,b=this.compile();a.na(b);b=new J;b.b(1);u(b,3,a);return b};function Xa(){}o(Xa,L);function Ya(a){this.Oa=a}o(Ya,M);Ya.prototype.compile=function(){var a=new A;a.b(8);var b=JSON.stringify(this.Oa);u(a,9,b);return a};
function Za(a,b){return function(){var c=new A;c.b(B);var d=new C,e=new F;e.b(a);b&&u(e,4,b);u(d,1,e);D(d,this.Da.compile());D(d,this.Ka.compile());u(c,4,d);return c}}function N(a,b,c,d){var e=K[a]=function(a,b){this.Da=a;this.Ka=b};o(e,M);e.prototype.compile=d?Za(za,b):Za(b);L.prototype[c]=function(a){return a instanceof L?new e(this,a):new e(this,K.t(a))}}N("AddExpression",14,"add");N("SubtractExpression",15,"sub");N("MultiplyExpression",16,"mul");N("DivideExpression",17,"div");
N("ModuloExpression",18,"mod");N("EqualsExpression",1,"eq",i);N("NotEqualsExpression",2,"ne",i);N("LessThanExpression",3,"lt",i);N("LessThanOrEqualsExpression",4,"le",i);N("GreaterThanExpression",5,"gt",i);N("GreaterThanOrEqualsExpression",6,"ge",i);function $a(a){this.f=a}o($a,M);$a.prototype.compile=function(){var a=new F;a.b(1);var b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.U=function(){return new $a(this)};L.prototype.not=L.prototype.U;
function ab(a){this.f=a}o(ab,M);ab.prototype.compile=function(){var a=new F;a.b(26);var b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.length=function(){return new ab(this)};L.prototype.length=L.prototype.length;function bb(a){this.K=[];for(var b in arguments)arguments.hasOwnProperty(b)&&this.K.push(arguments[b])}o(bb,M);
bb.prototype.compile=function(){var a=new F;a.b(this.da);var b=new C;u(b,1,a);for(a=0;a<this.K.length;a++)D(b,this.K[a].compile());a=new A;a.b(B);u(a,4,b);return a};function cb(a){bb.apply(this,arguments);this.da=36}o(cb,bb);L.prototype.$=function(a){return a instanceof L?new cb(this,a):new cb(this,K.t(a))};L.prototype.and=L.prototype.$;function db(a){bb.apply(this,arguments);this.da=35}o(db,bb);L.prototype.ja=function(a){return a instanceof L?new db(this,a):new db(this,K.t(a))};L.prototype.or=L.prototype.ja;
function eb(a,b,c,d,e){this.f=a;this.Ma=b;this.ya=c;this.sc="undefined"===typeof d?l:d;this.nc="undefined"===typeof e?l:e}o(eb,M);eb.prototype.compile=function(){var a=new Ga;a.w("id");var b=this.Ma.compile();u(a,2,b);b=this.ya.compile();u(a,3,b);b=new F;b.b(37);u(b,11,a);a=new C;u(a,1,b);D(a,this.f.compile());b=new A;b.b(B);u(b,4,a);return b};L.prototype.qa=function(a,b,c,d){return new eb(this,a,b,c,d)};L.prototype.between=L.prototype.qa;function fb(a,b,c){this.f=a;this.Ca=b;this.la=c||k}o(fb,M);
fb.prototype.compile=function(){var a=new A;a.b(B);var b=new C,c=new F;c.b(11);u(b,1,c);D(b,this.f.compile());c=new A;c.b(6);u(c,7,this.Ca);D(b,c);c=new A;this.la!==k?(c.b(6),u(c,7,this.la)):c.b(0);D(b,c);u(a,4,b);return a};L.prototype.slice=function(a,b){return new fb(this,a,b)};L.prototype.slice=L.prototype.slice;L.prototype.Ea=function(a){return new fb(this,0,a)};L.prototype.limit=L.prototype.Ea;L.prototype.La=function(a){return new fb(this,a)};L.prototype.skip=L.prototype.La;
function gb(a,b){this.f=a;this.za=b}o(gb,M);gb.prototype.compile=function(){var a=new A;a.b(B);var b=new C,c=new F;c.b(28);u(b,1,c);D(b,this.f.compile());c=new A;c.b(6);u(c,7,this.za);D(b,c);u(a,4,b);return a};L.prototype.Ha=function(a){return new gb(this,a)};L.prototype.nth=L.prototype.Ha;
function hb(a,b){this.f=a;if(b instanceof ib)this.J=b;else if(b instanceof L)this.J=new ib([""],b);else{var c=new cb,d;for(d in b)if(b.hasOwnProperty(d)){var e=K.O(d).eq(K.t(b[d]));c.K.push(e)}this.J=new ib([""],c)}}o(hb,M);hb.prototype.compile=function(){var a=new Ia;a.W(this.J.H[0]);a.G(this.J.body.compile());var b=new Ba;u(b,1,a);a=new F;a.b(20);u(a,5,b);b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.filter=function(a){return new hb(this,a)};
L.prototype.filter=L.prototype.filter;function jb(a,b){this.f=a;b instanceof ib?this.T=b:b instanceof L&&(this.T=K.fa("",b))}o(jb,M);jb.prototype.compile=function(){var a=new G;a.W(this.T.H[0]);a.G(this.T.body.compile());var b=new Ca;b.z(a);a=new F;a.b(21);u(a,6,b);b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.map=function(a){return new jb(this,a)};L.prototype.map=L.prototype.map;function kb(a,b){this.f=a;this.ka=b}o(kb,M);
kb.prototype.compile=function(){var a=new F;a.b(23);for(var b=0;b<this.ka.length;b++){var c=i,d=this.ka[b];"-"===d[0]&&(c=l,d=d.slice(1));var e=new Ea;e.M(d);u(e,2,c);ra(a,8,e)}b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.Ia=function(a){var b=Array.prototype.slice.call(arguments,0);return new kb(this,b)};L.prototype.orderby=L.prototype.Ia;function lb(a,b){this.f=a;this.aa=b||k}o(lb,M);
lb.prototype.compile=function(){var a=this.f;this.aa&&(a=a.map(K.O(this.aa)));var b=new F;b.b(24);var c=new C;u(c,1,b);D(c,a.compile());a=new A;a.b(B);u(a,4,c);return a};L.prototype.xa=function(a){return new lb(this,a)};L.prototype.distinct=L.prototype.xa;function mb(a,b,c){this.f=a;this.pa=b;this.V=c}o(mb,M);
mb.prototype.compile=function(){var a=new Ha,b=this.pa.compile();u(a,1,b);u(a,2,this.V.H[0]);u(a,3,this.V.H[1]);a.G(this.V.body.compile());b=new F;b.b(31);u(b,9,a);a=new C;u(a,1,b);D(a,this.f.compile());b=new A;b.b(B);u(b,4,a);return b};L.prototype.reduce=function(a,b){return new mb(this,a,b)};L.prototype.reduce=L.prototype.reduce;function nb(a,b){n(b)||(b=[b]);this.f=a;this.ba=b}o(nb,M);
nb.prototype.compile=function(){var a=new F;a.b(7);for(var b in this.ba)ra(a,3,this.ba[b]);b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};L.prototype.Ja=function(a){return new nb(this,a)};L.prototype.pluck=L.prototype.Ja;function ob(a){this.C=a}ob.prototype.Y=function(a){return new O(a,this.C)};ob.prototype.table=ob.prototype.Y;K.db=function(a){return new ob(a)};K.db=K.db;K.sa=function(){};K.db_create=K.sa;K.ta=function(){};K.db_drop=K.ta;K.ua=function(){};K.db_list=K.ua;K.t=function(a){return new Ya(a)};K.expr=K.t;K.Y=function(a){var b=a.split("."),a=b[0],b=b[1];b===h&&(b=a,a=h);return new O(b,a)};K.table=K.Y;function ib(a,b){this.H=a;this.body=b}K.fa=function(a){var b=arguments[arguments.length-1],c=Array.prototype.slice.call(arguments,0,arguments.length-1);return new ib(c,b)};K.fn=K.fa;function pb(a){this.Pa=a}o(pb,M);
pb.prototype.compile=function(){var a=new A;a.b(1);a.X(this.Pa);return a};function rb(a,b){this.f=a;this.P=b}o(rb,M);rb.prototype.compile=function(){var a=new F;a.b(2);a.M(this.P);var b=new C;u(b,1,a);D(b,this.f.compile());a=new A;a.b(B);u(a,4,b);return a};function sb(a){this.P=a}o(sb,M);sb.prototype.compile=function(){var a=new F;a.b(3);a.M(this.P);var b=new C;u(b,1,a);a=new A;a.b(B);u(a,4,b);return a};
K.O=function(a){for(var a=a.split("."),b=a.shift(),c=k,c="$"===b[0]?new pb(b.slice(1)):new sb(b);b=a.shift();)c=new rb(c,b);return c};K.R=K.O;function tb(){}tb.prototype.ga=function(a,b){return 11==a.i||10==a.i?ub(this,b):b};function vb(a,b){this.e=a|0;this.c=b|0}var wb={};function xb(a){if(-128<=a&&128>a){var b=wb[a];if(b)return b}b=new vb(a|0,0>a?-1:0);-128<=a&&128>a&&(wb[a]=b);return b}function P(a){return isNaN(a)||!isFinite(a)?Q:a<=-yb?R:a+1>=yb?zb:0>a?S(P(-a)):new vb(a%T|0,a/T|0)}function U(a,b){return new vb(a,b)}var T=4294967296,yb=T*T/2,Q=xb(0),Ab=xb(1),Bb=xb(-1),zb=U(-1,2147483647),R=U(0,-2147483648),Cb=xb(16777216);m=vb.prototype;
m.toString=function(a){a=a||10;(2>a||36<a)&&f(Error("radix out of range: "+a));if(V(this))return"0";if(0>this.c){if(this.h(R)){var b=P(a),c=W(this,b),b=Db(c.multiply(b),this);return c.toString(a)+b.e.toString(a)}return"-"+S(this).toString(a)}for(var c=P(Math.pow(a,6)),b=this,d="";;){var e=W(b,c),j=Db(b,e.multiply(c)).e.toString(a),b=e;if(V(b))return j+d;for(;6>j.length;)j="0"+j;d=""+j+d}};function Eb(a){return 0<=a.e?a.e:T+a.e}function V(a){return 0==a.c&&0==a.e}
m.h=function(a){return this.c==a.c&&this.e==a.e};function Fb(a,b){if(a.h(b))return 0;var c=0>a.c,d=0>b.c;return c&&!d?-1:!c&&d?1:0>Db(a,b).c?-1:1}function S(a){return a.h(R)?R:a.U().add(Ab)}m.add=function(a){var b=this.c>>>16,c=this.c&65535,d=this.e>>>16,e=a.c>>>16,j=a.c&65535,g=a.e>>>16,q;q=0+((this.e&65535)+(a.e&65535));a=0+(q>>>16);a+=d+g;d=0+(a>>>16);d+=c+j;c=0+(d>>>16);return U((a&65535)<<16|q&65535,(c+(b+e)&65535)<<16|d&65535)};function Db(a,b){return a.add(S(b))}
m.multiply=function(a){if(V(this)||V(a))return Q;if(this.h(R))return 1==(a.e&1)?R:Q;if(a.h(R))return 1==(this.e&1)?R:Q;if(0>this.c)return 0>a.c?S(this).multiply(S(a)):S(S(this).multiply(a));if(0>a.c)return S(this.multiply(S(a)));if(0>Fb(this,Cb)&&0>Fb(a,Cb))return P((this.c*T+Eb(this))*(a.c*T+Eb(a)));var b=this.c>>>16,c=this.c&65535,d=this.e>>>16,e=this.e&65535,j=a.c>>>16,g=a.c&65535,q=a.e>>>16,a=a.e&65535,s,r,w,qb;qb=0+e*a;w=0+(qb>>>16);w+=d*a;r=0+(w>>>16);w=(w&65535)+e*q;r+=w>>>16;r+=c*a;s=0+(r>>>
16);r=(r&65535)+d*q;s+=r>>>16;r=(r&65535)+e*g;s+=r>>>16;return U((w&65535)<<16|qb&65535,(s+(b*a+c*q+d*g+e*j)&65535)<<16|r&65535)};
function W(a,b){V(b)&&f(Error("division by zero"));if(V(a))return Q;if(a.h(R)){if(b.h(Ab)||b.h(Bb))return R;if(b.h(R))return Ab;var c=W(Gb(a,1),b).shiftLeft(1);if(c.h(Q))return 0>b.c?Ab:Bb;var d=Db(a,b.multiply(c));return c.add(W(d,b))}if(b.h(R))return Q;if(0>a.c)return 0>b.c?W(S(a),S(b)):S(W(S(a),b));if(0>b.c)return S(W(a,S(b)));for(var e=Q,d=a;0<=Fb(d,b);){for(var c=Math.max(1,Math.floor((d.c*T+Eb(d))/(b.c*T+Eb(b)))),j=Math.ceil(Math.log(c)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),g=P(c),q=g.multiply(b);0>
q.c||0<Fb(q,d);)c-=j,g=P(c),q=g.multiply(b);V(g)&&(g=Ab);e=e.add(g);d=Db(d,q)}return e}m.U=function(){return U(~this.e,~this.c)};m.$=function(a){return U(this.e&a.e,this.c&a.c)};m.ja=function(a){return U(this.e|a.e,this.c|a.c)};function Hb(a,b){return U(a.e^b.e,a.c^b.c)}m.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.e;return 32>a?U(b<<a,this.c<<a|b>>>32-a):U(0,b<<a-32)};function Gb(a,b){b&=63;if(0==b)return a;var c=a.c;return 32>b?U(a.e>>>b|c<<32-b,c>>b):U(c>>b-32,0<=c?0:-1)};function Ib(){this.k=0}o(Ib,tb);function X(a){f(new ga("Error deserializing incorrectly formated message, "+a))}function ub(a,b){for(var c=qa(b.I()),d=[],e=0,j=0;j<c.length;j++){var g=c[j];if(v(b,g.j)){var q=0;do{var s=a.ga(g,b.get(g,q));d.push(s);e+=s.byteLength;q++}while(g.B&&q<ta(b,g.j))}}c=new Uint8Array(e);for(j=e=0;j<d.length;j++)g=d[j],c.set(new Uint8Array(g),e),e+=g.byteLength;return c}
Ib.prototype.ga=function(a,b){var c=a.i,d=Jb[c],e=Kb(P(a.j<<3|d)),j;switch(d){case Y:var g=P(b);if(c==ma||17==c)g=Hb(g.shiftLeft(1),Gb(g,63));j=Kb(g);break;case Lb:g=new ArrayBuffer(8);c=new DataView(g);switch(a.i){case 1:c.setFloat64(0,b,i);break;case ka:j=P(b);c.setUint32(0,Eb(j),i);c.setUint32(4,j.c,i);break;case la:j=P(b);c.setUint32(0,Eb(j),i);c.setInt32(4,j.c,i);break;default:X("Unexpected field type")}j=new Uint8Array(g);break;case Mb:switch(a.i){case 11:g=ub(this,b);break;case 9:case 12:g=
TextEncoder("utf-8").encode(b);break;default:X("Unexpected field type")}j=g.length;c=Kb(P(j));j=new Uint8Array(c.length+j);j.set(c,0);j.set(g,c.length);break;case Nb:X("Use of Groups deprecated and not supported");break;case Ob:g=new ArrayBuffer(4);c=new DataView(g);switch(a.i){case 2:c.setFloat32(0,b,i);break;case 7:c.setUint32(0,b,i);break;case 15:c.setInt32(0,b,i);break;default:X("Unexpected field type")}j=new Uint8Array(g);break;default:X("Unexpected wire type")}g=new Uint8Array(e.length+j.length);
g.set(new Uint8Array(e),0);g.set(new Uint8Array(j),e.length);return g};function Kb(a){function b(a){var d=P(128),d=Db(a,W(a,d).multiply(d)).e,e=P(127);0<Fb(a,e)?(d+=128,a=b(Gb(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function Pb(a,b,c){var d=b.I();for(a.k=0;a.k<c.length;){var e=Qb(a,c),j=d.o[parseInt(e>>3,10)]||k,g=a,q=e%8,s=j,e=c,r=h;switch(q){case Y:e=Qb(g,e);if(s){g=h;switch(s.i){case ia:case ja:g=e.toString();break;case 5:case 13:case 14:g=e;break;case 17:e=P(e);g=Hb(Gb(e,1),e.shiftLeft(63)).e;break;case ma:e=P(e);g=Hb(Gb(e,1),e.shiftLeft(63)).toString();break;case 8:g=0===g?l:i;break;default:X("Unexpected field type")}r=g}else r=k;break;case Mb:q=e;e=Qb(g,q);q=new Uint8Array(q.buffer,q.byteOffset+g.k,e);
g.k+=e;if(s){e=h;switch(s.i){case 9:case 12:e=TextDecoder("utf-8").decode(q);break;case 11:e=q;g=new Ib;s=new s.ia.s.Fa;Pb(g,s,e);e=s;break;default:X("Unexpected field type")}r=e}else r=k;break;case Ob:e=new DataView(e.buffer,g.k,4);g.k+=4;if(s){g=h;switch(s.i){case 2:g=e.getFloat32(0,i);break;case 7:g=e.getUint32(0,i);break;case 15:g=e.getInt32(0,i);break;default:X("Unexpected field type")}r=g}else r=k;break;case Lb:e=new DataView(e.buffer,g.k,8);g.k+=8;if(s){g=h;switch(s.i){case 1:g=e.getFloat64(0,
i);break;case ka:g=(new vb(e.getUint32(0,i),e.getUint32(4,i))).toString();break;case la:g=(new vb(e.getUint32(0,i),e.getInt32(4,i))).toString();break;default:X("Unexpected field type")}r=g}else r=k;break;default:X("Unexpected wire type of "+q)}e=r;j!=k&&e!=k&&(j.B?b.add(j,e):b.set(j,e))}}function Qb(a,b){var c=b[a.k++];if(127<c)var c=c-128,d=Qb(a,b),c=c+(d<<7);return c}var Y=0,Lb=1,Mb=2,Nb=3,Ob=5,Jb=[-1,Lb,Ob,Y,Y,Y,Lb,Ob,Y,Mb,Nb,Mb,Mb,Y,Y,Ob,Lb,Y,Y];function Z(a){this.va=a||"";this.D={};this.Ga=1;Wa=this}Z.prototype.close=function(){};Z.prototype.L=function(a,b){var c=a.ca();c.oa((this.Ga++).toString());this.D[c.u()]=b;var c=ub(new Ib,c),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,i);e.set(c,4);this.ma(e.buffer)};Z.prototype.run=Z.prototype.L;
function Rb(a,b){(new DataView(b.buffer)).getUint32(0,i)!==b.length-4&&f("message is wrong length");try{var c=new Ua;Pb(new Ib,c,new Uint8Array(b.buffer,4));var d=t(c,1),e=a.D[c.u()];switch(d){case 101:f("Broken client");case 103:f("Runtime error");case 102:f("bad query");case 0:delete a.D[c.u()];e&&e();break;case 3:delete a.D[c.u()];if(e){var j=sa(c,c.o[3]);j==k||n(j);var g=(j||[]).map(JSON.parse);e(g)}break;case 1:delete a.D[c.u()];if(e){var q=JSON.parse(t(c,3,0));e(q)}break;case 2:f("partial results not yet implemented");
default:f("unknown response status code")}}catch(s){f(s)}};function $(a,b,c){Z.call(this,k);this.v=k;this.rc=0;this.r=k;var d=this;d.r=k;var e;e=a?n(a)?a:[a]:["localhost"];var j=require("net");(function q(){var a=e.shift();if(a){var r;"string"===typeof a?(r=a,a=12346):(r=a.host||"localhost",a=a.port||12346);var w=j.connect(a,r,function(){w.on("data",ea(d.Na,d));d.r=w;b&&b(d)});w.on("error",q)}else c&&c()})()}o($,Z);fa("rethinkdb.net.TcpConnection",$);
$.prototype.ma=function(a){this.r||f("Connection not open");for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.r.write(b)};
$.prototype.Na=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.v===k){var d=(new DataView(a.buffer,b,c)).getUint32(0,i);this.v=new Uint8Array(d+4);this.F=0}var d=this.v.byteLength-this.F,e=c<d?c:d,j=new Uint8Array(a.buffer,b,e);this.v.set(j,this.F);this.F+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.v,this.v=k,this.F=0,Rb(this,d))}};$.prototype.close=function(){this.r||f("Connection not open");this.r.end();this.r=k};$.prototype.close=$.prototype.close;function Sb(a,b,c){Z.call(this,k);this.A="";var d=this,e;e=a?n(a)?a:[a]:["localhost"];(function g(){var a=e.shift();if(a){var s;"string"===typeof a?(s=a,a=13457):(s=a.host||"localhost",a=a.port||13457);var r="http://"+s+":"+a,w=new XMLHttpRequest;w.responseType="arraybuffer";w.open("GET",r+"/open-new-connection",i);w.onreadystatechange=function(){if(w.readyState===4)if(w.status===200){d.A=r;d.Q=(new DataView(w.response)).getInt32(0,i);b&&b(d)}else g()};w.send()}else c&&c()})()}o(Sb,Z);
fa("rethinkdb.net.HttpConnection",Sb);Sb.prototype.ma=function(a){this.A||f("Connection not open");var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.A+"/?conn_id="+this.Q,i);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&Rb(c,new Uint8Array(b.response))};b.send(a)};Sb.prototype.close=function(){this.A||f("Connection not open");var a=new XMLHttpRequest;a.open("POST",this.A+"/close-connection?conn_id="+this.Q,i);a.send();this.A=this.Q=k};
Sb.prototype.close=Sb.prototype.close;fa("rethinkdb.net.connect",function(a,b,c){return"undefined"!==typeof require&&require("net")?new $(a,b,c):new Sb(a,b,c)});var Wa=k;fa("rethinkdb.net.last_connection",Wa);function O(a,b){this.ra=b||k;this.C=a}o(O,M);O.prototype.compile=function(){var a=new A;a.b(13);var b=new ya,c=new z,d;if(!(d=this.ra))d=Wa.va;u(c,1,d);u(c,2,this.C);b.n(c);u(a,15,b);return a};function Tb(a,b){this.Z=a;this.Ba=new Ya(b)}o(Tb,M);Tb.prototype.compile=function(){var a=this.Z.compile(),b=t(a,15).p(),a=new E;a.n(b);a.w("id");a.N(this.Ba.compile());b=new A;b.b(12);u(b,14,a);return b};O.prototype.get=function(a){return new Tb(this,a)};O.prototype.get=O.prototype.get;
function Ub(a,b){this.Z=a;n(b)||(b=[b]);this.ea=b}o(Ub,Xa);Ub.prototype.ca=function(){var a=this.Z.compile(),b=t(a,15).p(),a=new Na;a.n(b);for(b=0;b<this.ea.length;b++){var c=(new Ya(this.ea[b])).compile();ra(a,2,c)}b=new H;b.b(4);u(b,5,a);a=new J;a.b(2);u(a,4,b);return a};O.prototype.Aa=function(a){return new Ub(this,a)};O.prototype.insert=O.prototype.Aa;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
