(function(){
function f(a){throw a;}var h=void 0,j=!0,k=null,l=!1,m,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function n(a){return"array"==ba(a)}Math.floor(2147483648*Math.random()).toString(36);function ca(a,b,c){return a.call.apply(a.bind,arguments)}function da(a,b,c){a||f(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ea(a,b,c){ea=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return ea.apply(k,arguments)}function fa(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==h?d[e]=b:d=d[e]?d[e]:d[e]={}}function o(a,b){function c(){}c.prototype=b.prototype;a.Lc=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ga(a){Error.captureStackTrace?Error.captureStackTrace(this,ga):this.stack=Error().stack||"";a&&(this.message=String(a))}o(ga,Error);ga.prototype.name="CustomError";function p(a){return"string"===typeof a&&("$"===a[0]||"@"===a[0])?p.H(a):p.$(a)}fa("rethinkdb.query",p);function s(a){this.name="RDB Client Error";this.message=a||"The RDB client has experienced an error"}o(s,Error);function t(a){return a instanceof w?a:p(a)}function ha(a){a instanceof x||(a instanceof w?a=p.Q("",a):"function"===typeof a?a=p.Q(a):f(TypeError("Argument expected to be a function expression")));return a};p.$=function(a){return"number"===typeof a?new ia(a):new ja(a)};p.expr=p.$;p.Ma=function(a){return new ka(a)};p.js=p.Ma;p.ga=function(a){var b=a.split("."),a=b[0],b=b[1];b===h&&(b=a,a=h);return new y(b,a)};p.table=p.ga;function z(){}z.prototype.U=function(a,b){b=b||la;b.U(this,a)};z.prototype.run=z.prototype.U;z.prototype.T=function(a,b){b=b||la;b.T(this,a)};z.prototype.iter=z.prototype.T;function ma(){}o(ma,z);
ma.prototype.q=function(){var a=new na,b=this.compile();a.ea(b);b=new A;b.d(oa);B(b,3,a);return b};function pa(a,b,c){this.Jc=a;this.i=b;this.r=c.name;this.I=!!c.m;this.Ic=!!c.required;this.h=c.a;this.sa=c.type;this.Ga=l;switch(this.h){case qa:case ra:case sa:case ta:case ua:this.Ga=j}this.Z=c.defaultValue}var qa=3,ra=4,sa=6,ta=16,ua=18;var va=Array.prototype;function wa(a,b){return a>b?1:a<b?-1:0};function xa(a,b,c){this.Qa=a;this.r=b.name||k;this.Hc=b.c||k;this.Fc=b.f;this.o={};for(a=0;a<c.length;a++)b=c[a],this.o[b.i]=b}function ya(a){var a=a.o,b=[],c=0,d;for(d in a)b[c++]=a[d];va.sort.call(b,function(a,b){return a.i-b.i}||wa);return b};function C(){this.l={};this.A=this.constructor.A;this.o=this.A.o;this.t=this.ra=k}m=C.prototype;m.S=function(){return this.A};m.get=function(a,b){return D(this,a.i,b)};m.set=function(a,b){B(this,a.i,b)};m.add=function(a,b){za(this,a.i,b)};
m.g=function(a){if(!a||this.constructor!=a.constructor)return l;for(var b=ya(this.S()),c=0;c<b.length;c++){var d=b[c];if(E(this,d.i)!=E(a,d.i))return l;if(E(this,d.i)){var e=11==d.h||10==d.h,i=Aa(this,d),g=Aa(a,d);if(d.I){if(i.length!=g.length)return l;for(d=0;d<i.length;d++)if(!(e?i[d].g(g[d]):i[d]==g[d]))return l}else if(!(e?i.g(g):i==g))return l}}return j};function E(a,b){return b in a.l&&a.l[b]!==h&&a.l[b]!==k}
function Aa(a,b){var c=b.i;if(!c in a.l)return k;var d=a.l[c];return d==k?k:a.ra?!(c in a.t)?(d=a.ra.Gc(a,b,d),a.t[c]=d):a.t[c]:d}function D(a,b,c){b=a.o[b];a=Aa(a,b);if(b.I)return n(a),a[c||0];n(a);return a}function F(a,b){var c;if(E(a,b))c=D(a,b,h);else{c=a.o[b];if(c.Z===h){var d=c.sa;c.Z=d===Boolean?l:d===Number?0:d===String?"":new d}c=c.Z}return c}function Ba(a){a=Aa(a,a.o[3]);a==k||n(a);return a||[]}function Ca(a,b){return a.o[b].I?(E(a,b)&&n(a.l[b]),E(a,b)?a.l[b].length:0):E(a,b)?1:0}
function B(a,b,c){a.l[b]=c;a.t&&(a.t[b]=c)}function za(a,b,c){a.l[b]||(a.l[b]=[]);a.l[b].push(c);a.t&&delete a.t[b]}function G(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new pa(a,e,b[e])));a.A=new xa(a,d,c);a.S=function(){return a.A}};function H(){C.apply(this)}o(H,C);H.prototype.N=function(a){B(this,1,a)};function Da(){C.apply(this)}o(Da,C);Da.prototype.W=function(a){B(this,1,a)};Da.prototype.ea=function(a){B(this,2,a)};function I(){C.apply(this)}o(I,C);I.prototype.d=function(a){B(this,1,a)};I.prototype.W=function(a){B(this,2,a)};function Ea(){C.apply(this)}o(Ea,C);function Fa(){C.apply(this)}o(Fa,C);function Ga(){C.apply(this)}o(Ga,C);function J(){C.apply(this)}o(J,C);J.prototype.p=function(){return F(this,1)};
J.prototype.k=function(a){B(this,1,a)};J.prototype.F=function(a){B(this,2,a)};J.prototype.V=function(a){B(this,3,a)};function Ha(){C.apply(this)}o(Ha,C);Ha.prototype.p=function(){return F(this,1)};Ha.prototype.k=function(a){B(this,1,a)};function K(){C.apply(this)}o(K,C);K.prototype.d=function(a){B(this,1,a)};K.prototype.aa=function(){return D(this,2)};K.prototype.D=function(a){B(this,2,a)};K.prototype.ba=function(){return E(this,2)};
var Ia=19,Ja={dc:1,Db:2,Jb:3,Hb:4,Kb:5,ic:6,Lb:7,Yb:8,jb:9,qc:11,fb:14,uc:15,ac:16,vb:17,$b:18,ob:Ia,Ab:20,Xb:21,pb:22,hc:23,ub:24,Sb:26,Ac:27,ec:28,sc:29,kb:30,oc:31,Fb:32,hb:35,gb:36,mc:37,Mb:38,Dc:39};function Ka(){C.apply(this)}o(Ka,C);function La(){C.apply(this)}o(La,C);La.prototype.s=function(a){B(this,1,a)};function Ma(){C.apply(this)}o(Ma,C);Ma.prototype.s=function(a){B(this,1,a)};function Na(){C.apply(this)}o(Na,C);Na.prototype.aa=function(){return D(this,1)};
Na.prototype.D=function(a){B(this,1,a)};Na.prototype.ba=function(){return E(this,1)};function Oa(){C.apply(this)}o(Oa,C);function Pa(){C.apply(this)}o(Pa,C);Pa.prototype.F=function(a){B(this,1,a)};function Qa(){C.apply(this)}o(Qa,C);Qa.prototype.u=function(a){B(this,4,a)};function L(){C.apply(this)}o(L,C);L.prototype.M=function(a){B(this,1,a)};L.prototype.u=function(a){B(this,2,a)};function Ra(){C.apply(this)}o(Ra,C);Ra.prototype.M=function(a){B(this,1,a)};Ra.prototype.u=function(a){B(this,2,a)};
function na(){C.apply(this)}o(na,C);na.prototype.ea=function(a){B(this,1,a)};function M(){C.apply(this)}o(M,C);M.prototype.d=function(a){B(this,1,a)};function Sa(){C.apply(this)}o(Sa,C);Sa.prototype.O=function(a){B(this,1,a)};Sa.prototype.s=function(a){B(this,2,a)};function Ta(){C.apply(this)}o(Ta,C);Ta.prototype.O=function(a){B(this,1,a)};function Ua(){C.apply(this)}o(Ua,C);Ua.prototype.O=function(a){B(this,1,a)};Ua.prototype.s=function(a){B(this,2,a)};function Va(){C.apply(this)}o(Va,C);
Va.prototype.p=function(){return F(this,1)};Va.prototype.k=function(a){B(this,1,a)};function Wa(){C.apply(this)}o(Wa,C);Wa.prototype.p=function(){return F(this,1)};Wa.prototype.k=function(a){B(this,1,a)};function Xa(){C.apply(this)}o(Xa,C);Xa.prototype.W=function(a){B(this,2,a)};function Ya(){C.apply(this)}o(Ya,C);m=Ya.prototype;m.p=function(){return F(this,1)};m.k=function(a){B(this,1,a)};m.F=function(a){B(this,2,a)};m.V=function(a){B(this,3,a)};m.s=function(a){B(this,4,a)};
function Za(){C.apply(this)}o(Za,C);Za.prototype.p=function(){return F(this,1)};Za.prototype.k=function(a){B(this,1,a)};Za.prototype.F=function(a){B(this,2,a)};Za.prototype.V=function(a){B(this,3,a)};function $a(){C.apply(this)}o($a,C);m=$a.prototype;m.p=function(){return F(this,1)};m.k=function(a){B(this,1,a)};m.F=function(a){B(this,2,a)};m.V=function(a){B(this,3,a)};m.s=function(a){B(this,4,a)};function N(){C.apply(this)}o(N,C);N.prototype.d=function(a){B(this,1,a)};
N.prototype.N=function(a){B(this,2,a)};function ab(){C.apply(this)}o(ab,C);ab.prototype.p=function(){return F(this,3)};ab.prototype.k=function(a){B(this,3,a)};function A(){C.apply(this)}o(A,C);A.prototype.d=function(a){B(this,1,a)};A.prototype.B=function(){return D(this,2)};A.prototype.pa=function(){return F(this,2)};A.prototype.fa=function(a){B(this,2,a)};var oa=1,bb={nc:oa,Ec:2,qb:3,rc:4,Zb:5};function cb(){C.apply(this)}o(cb,C);cb.prototype.B=function(){return D(this,2)};
cb.prototype.pa=function(){return F(this,2)};cb.prototype.fa=function(a){B(this,2,a)};function db(){C.apply(this)}o(db,C);G(H,{"0":{name:"TableRef",c:"TableRef"},1:{name:"db_name",a:9,type:String},2:{name:"table_name",a:9,type:String}});G(Da,{"0":{name:"VarTermTuple",c:"VarTermTuple"},1:{name:"var",a:9,type:String},2:{name:"term",a:11,type:I}});
G(I,{"0":{name:"Term",c:"Term"},1:{name:"type",a:14,defaultValue:0,type:{Qb:0,Cc:1,Tb:2,nb:3,Ib:4,zb:5,fc:6,tc:7,JSON:8,BOOL:9,ib:10,gc:11,Eb:12,zc:13,Pb:14}},2:{name:"var",a:9,type:String},3:{name:"let",a:11,type:Ea},4:{name:"call",a:11,type:Fa},5:{name:"if_",a:11,type:Ga},6:{name:"error",a:9,type:String},7:{name:"number",a:1,type:Number},8:{name:"valuestring",a:9,type:String},9:{name:"jsonstring",a:9,type:String},10:{name:"valuebool",a:8,type:Boolean},11:{name:"array",m:j,a:11,type:I},12:{name:"object",
m:j,a:11,type:Da},14:{name:"get_by_key",a:11,type:J},15:{name:"table",a:11,type:Ha},16:{name:"javascript",a:9,type:String}});G(Ea,{"0":{name:"Let",f:I,c:"Term.Let"},1:{name:"binds",m:j,a:11,type:Da},2:{name:"expr",a:11,type:I}});G(Fa,{"0":{name:"Call",f:I,c:"Term.Call"},1:{name:"builtin",a:11,type:K},2:{name:"args",m:j,a:11,type:I}});G(Ga,{"0":{name:"If",f:I,c:"Term.If"},1:{name:"test",a:11,type:I},2:{name:"true_branch",a:11,type:I},3:{name:"false_branch",a:11,type:I}});
G(J,{"0":{name:"GetByKey",f:I,c:"Term.GetByKey"},1:{name:"table_ref",a:11,type:H},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:I}});G(Ha,{"0":{name:"Table",f:I,c:"Term.Table"},1:{name:"table_ref",a:11,type:H}});
G(K,{"0":{name:"Builtin",c:"Builtin"},1:{name:"type",a:14,defaultValue:1,type:Ja},2:{name:"attr",a:9,type:String},3:{name:"attrs",m:j,a:9,type:String},4:{name:"comparison",a:14,defaultValue:1,type:{yb:1,cc:2,Wb:3,Rb:4,Gb:5,Cb:6}},5:{name:"filter",a:11,type:Ka},6:{name:"map",a:11,type:La},7:{name:"concat_map",a:11,type:Ma},8:{name:"order_by",m:j,a:11,type:Na},9:{name:"reduce",a:11,type:Qa},10:{name:"grouped_map_reduce",a:11,type:Oa},11:{name:"range",a:11,type:Pa}});
G(Ka,{"0":{name:"Filter",f:K,c:"Builtin.Filter"},1:{name:"predicate",a:11,type:Ra}});G(La,{"0":{name:"Map",f:K,c:"Builtin.Map"},1:{name:"mapping",a:11,type:L}});G(Ma,{"0":{name:"ConcatMap",f:K,c:"Builtin.ConcatMap"},1:{name:"mapping",a:11,type:L}});G(Na,{"0":{name:"OrderBy",f:K,c:"Builtin.OrderBy"},1:{name:"attr",a:9,type:String},2:{name:"ascending",a:8,defaultValue:1,type:Boolean}});
G(Oa,{"0":{name:"GroupedMapReduce",f:K,c:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",a:11,type:L},2:{name:"value_mapping",a:11,type:L},3:{name:"reduction",a:11,type:Qa}});G(Pa,{"0":{name:"Range",f:K,c:"Builtin.Range"},1:{name:"attrname",a:9,type:String},2:{name:"lowerbound",a:11,type:I},3:{name:"upperbound",a:11,type:I}});G(Qa,{"0":{name:"Reduction",c:"Reduction"},1:{name:"base",a:11,type:I},2:{name:"var1",a:9,type:String},3:{name:"var2",a:9,type:String},4:{name:"body",a:11,type:I}});
G(L,{"0":{name:"Mapping",c:"Mapping"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:I}});G(Ra,{"0":{name:"Predicate",c:"Predicate"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:I}});G(na,{"0":{name:"ReadQuery",c:"ReadQuery"},1:{name:"term",a:11,type:I},2:{name:"max_chunk_size",a:3,type:String},3:{name:"max_age",a:3,type:String}});
G(M,{"0":{name:"WriteQuery",c:"WriteQuery"},1:{name:"type",a:14,defaultValue:1,type:{Bc:1,tb:2,bc:3,Nb:4,Ob:5,Bb:6,lc:7,jc:8,kc:9}},2:{name:"update",a:11,type:Sa},3:{name:"delete",a:11,type:Ta},4:{name:"mutate",a:11,type:Ua},5:{name:"insert",a:11,type:Va},6:{name:"insert_stream",a:11,type:Wa},7:{name:"for_each",a:11,type:Xa},8:{name:"point_update",a:11,type:Ya},9:{name:"point_delete",a:11,type:Za},10:{name:"point_mutate",a:11,type:$a}});
G(Sa,{"0":{name:"Update",f:M,c:"WriteQuery.Update"},1:{name:"view",a:11,type:I},2:{name:"mapping",a:11,type:L}});G(Ta,{"0":{name:"Delete",f:M,c:"WriteQuery.Delete"},1:{name:"view",a:11,type:I}});G(Ua,{"0":{name:"Mutate",f:M,c:"WriteQuery.Mutate"},1:{name:"view",a:11,type:I},2:{name:"mapping",a:11,type:L}});G(Va,{"0":{name:"Insert",f:M,c:"WriteQuery.Insert"},1:{name:"table_ref",a:11,type:H},2:{name:"terms",m:j,a:11,type:I}});
G(Wa,{"0":{name:"InsertStream",f:M,c:"WriteQuery.InsertStream"},1:{name:"table_ref",a:11,type:H},2:{name:"stream",a:11,type:I}});G(Xa,{"0":{name:"ForEach",f:M,c:"WriteQuery.ForEach"},1:{name:"stream",a:11,type:I},2:{name:"var",a:9,type:String},3:{name:"queries",m:j,a:11,type:M}});G(Ya,{"0":{name:"PointUpdate",f:M,c:"WriteQuery.PointUpdate"},1:{name:"table_ref",a:11,type:H},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:I},4:{name:"mapping",a:11,type:L}});
G(Za,{"0":{name:"PointDelete",f:M,c:"WriteQuery.PointDelete"},1:{name:"table_ref",a:11,type:H},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:I}});G($a,{"0":{name:"PointMutate",f:M,c:"WriteQuery.PointMutate"},1:{name:"table_ref",a:11,type:H},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:I},4:{name:"mapping",a:11,type:L}});
G(N,{"0":{name:"MetaQuery",c:"MetaQuery"},1:{name:"type",a:14,defaultValue:1,type:{rb:1,wb:2,Ub:3,sb:4,xb:5,Vb:6}},2:{name:"db_name",a:9,type:String},3:{name:"create_table",a:11,type:ab},4:{name:"drop_table",a:11,type:H}});G(ab,{"0":{name:"CreateTable",f:N,c:"MetaQuery.CreateTable"},1:{name:"datacenter",a:9,type:String},3:{name:"table_ref",a:11,type:H},4:{name:"primary_key",a:9,defaultValue:"id",type:String}});
G(A,{"0":{name:"Query",c:"Query"},1:{name:"type",a:14,defaultValue:oa,type:bb},2:{name:"token",a:3,type:String},3:{name:"read_query",a:11,type:na},4:{name:"write_query",a:11,type:M},5:{name:"meta_query",a:11,type:N}});G(cb,{"0":{name:"Response",c:"Response"},1:{name:"status_code",a:14,defaultValue:0,type:{vc:0,wc:1,xc:2,yc:3,mb:101,lb:102,pc:103}},2:{name:"token",a:3,type:String},3:{name:"response",m:j,a:9,type:String},4:{name:"error_message",a:9,type:String},5:{name:"backtrace",a:11,type:db}});
G(db,{"0":{name:"Backtrace",f:cb,c:"Response.Backtrace"},1:{name:"frame",m:j,a:9,type:String}});function w(){}o(w,ma);function ja(a){this.X=a}o(ja,w);ja.prototype.compile=function(){var a=new I;a.d(8);var b=JSON.stringify(this.X);B(a,9,b);return a};function ia(a){this.X="undefined"===typeof a?k:a}o(ia,w);ia.prototype.compile=function(){var a=new I;this.X===k?a.d(0):(a.d(6),B(a,7,this.X));return a};function ka(a){this.Ya=a}o(ka,w);ka.prototype.compile=function(){var a=new I;a.d(14);B(a,16,this.Ya);return a};function x(a,b){this.w=a;this.body=b}
function eb(a){(a=fb.exec(a.toString()))||f(TypeError("Expected a function"));var b=a[1].split(",").map(function(a){return a.trim()});x.call(this,b,new ka(a[2]))}o(eb,x);var fb=/function [^(]*\(([^)]*)\) *{([^]*)}/m;p.Q=function(a){if("function"===typeof a)return new eb(a);var b=arguments[arguments.length-1],c=Array.prototype.slice.call(arguments,0,arguments.length-1);return new x(c,b)};p.fn=p.Q;function O(a,b,c){this.ya=a;this.la=b;this.ja=c||k}o(O,w);
O.prototype.compile=function(){var a=new K;a.d(this.ya);this.ja&&this.ja(a);var b=new Fa;B(b,1,a);for(var c in this.la)a=this.la[c].compile(),za(b,2,a);c=new I;c.d(3);B(c,4,b);return c};function gb(a,b){w.prototype[b]=function(b){b=t(b);return new O(a,[this,b])}}function hb(a,b){w.prototype[b]=function(b){b=t(b);return new O(Ia,[this,b],function(b){B(b,4,a)})}}gb(14,"add");gb(15,"sub");gb(16,"mul");gb(17,"div");gb(18,"mod");hb(1,"eq");hb(2,"ne");hb(3,"lt");hb(4,"le");hb(5,"gt");hb(6,"ge");
w.prototype.ca=function(){return new O(1,[this])};w.prototype.not=w.prototype.ca;w.prototype.length=function(){return new O(26,[this])};w.prototype.length=w.prototype.length;w.prototype.ka=function(a){a=t(a);return new O(36,[this,a])};w.prototype.and=w.prototype.ka;w.prototype.ta=function(a){a=t(a);return new O(35,[this,a])};w.prototype.or=w.prototype.ta;
w.prototype.wa=function(a,b,c){var a=t(a),b=t(b),d=c?c:"id";return new O(37,[this],function(c){var i=new Pa;i.F(d);var g=a.compile();B(i,2,g);g=b.compile();B(i,3,g);B(c,11,i)})};w.prototype.between=w.prototype.wa;function ib(a,b,c){O.call(this,11,[a,new ia(b),new ia(c)])}o(ib,O);w.prototype.slice=function(a,b){return new ib(this,a,b)};w.prototype.slice=w.prototype.slice;w.prototype.Pa=function(a){return new ib(this,0,a)};w.prototype.limit=w.prototype.Pa;
w.prototype.Xa=function(a){return new ib(this,a)};w.prototype.skip=w.prototype.Xa;w.prototype.Ta=function(a){return new O(28,[this,new ia(a)])};w.prototype.nth=w.prototype.Ta;
w.prototype.filter=function(a){var b;if("function"===typeof a)b=new eb(a);else if(a instanceof x)b=a;else if(a instanceof w)b=new x([""],a);else{var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(p.H(d).eq(p.$(a[d])));b=new x([""],new O(36,c))}return new O(20,[this],function(a){var c=new Ra;c.M(b.w[0]);c.u(b.body.compile());var d=new Ka;B(d,1,c);B(a,5,d)})};w.prototype.filter=w.prototype.filter;
w.prototype.map=function(a){a=ha(a);return new O(21,[this],function(b){var c=new L;c.M(a.w[0]);c.u(a.body.compile());var d=new La;d.s(c);B(b,6,d)})};w.prototype.map=w.prototype.map;w.prototype.Ua=function(a){var b=Array.prototype.slice.call(arguments,0);return new O(23,[this],function(a){for(var d=0;d<b.length;d++){var e=j,i=b[d];"-"===i[0]&&(e=l,i=i.slice(1));var g=new Na;g.D(i);B(g,2,e);za(a,8,g)}})};w.prototype.orderby=w.prototype.Ua;
w.prototype.Ha=function(a){a=a?this.map(p.H(a)):this;return new O(24,[a])};w.prototype.distinct=w.prototype.Ha;w.prototype.reduce=function(a,b){a=t(a);b=ha(b);return new O(31,[this],function(c){var d=new Qa,e=a.compile();B(d,1,e);B(d,2,b.w[0]);B(d,3,b.w[1]);d.u(b.body.compile());B(c,9,d)})};w.prototype.reduce=w.prototype.reduce;w.prototype.ba=function(a){return new O(4,[this],function(b){b.D(a)})};w.prototype.hasAttr=w.prototype.ba;w.prototype.aa=function(a){return new O(2,[this],function(b){b.D(a)})};
w.prototype.getAttr=w.prototype.aa;w.prototype.ua=function(a){n(a)||(a=[a]);return new O(6,[this],function(b){for(var c in a)za(b,3,a[c])})};w.prototype.pickAttrs=w.prototype.ua;w.prototype.eb=function(a){n(a)||(a=[a]);return new O(39,[this],function(b){for(var c in a)za(b,3,a[c])})};w.prototype.without=w.prototype.eb;w.prototype.Va=function(a){return this.map(p.Q("a",p.H("$a").ua(a)))};w.prototype.pluck=w.prototype.Va;function jb(a){this.cb=a}o(jb,w);
jb.prototype.compile=function(){var a=new I;a.d(1);a.W(this.cb);return a};function kb(a,b){O.call(this,2,[a],function(a){a.D(b)})}o(kb,O);function lb(a){O.call(this,3,[],function(b){b.D(a)})}o(lb,O);p.H=function(a){var a=a.split("."),b=a.shift(),c=k;"@"===b[0]&&(b=a.shift());for(c="$"===b[0]?new jb(b.slice(1)):new lb(b);b=a.shift();)c=new kb(c,b);return c};p.R=p.H;w.prototype.extend=function(a){a=t(a);return new O(8,[this,a])};w.prototype.extend=w.prototype.extend;
function mb(a,b,c){this.$a=a;this.ab=b;this.Ja=c}o(mb,w);mb.prototype.compile=function(){var a=new Ga,b=this.$a.compile();B(a,1,b);b=this.ab.compile();B(a,2,b);b=this.Ja.compile();B(a,3,b);b=new I;b.d(4);B(b,5,a);return b};p.Ka=function(a,b,c){a=t(a);return new mb(a,b,c)};p.ifThenElse=p.Ka;function nb(a,b){this.ma=a;this.xa=b}o(nb,w);
nb.prototype.compile=function(){var a=new Ea,b;for(b in this.ma){var c=this.ma[b],d=new Da;d.W(c[0]);d.ea(c[1].compile());za(a,1,d)}b=this.xa.compile();B(a,2,b);b=new I;b.d(2);B(b,3,a);return b};p.Oa=function(a){var b=Array.prototype.slice.call(arguments,0,arguments.length-1);return new nb(b,arguments[arguments.length-1])};p.let=p.Oa;function pb(a,b){this.bb=a;this.z=b||k}o(pb,z);pb.prototype.q=function(){var a=new N;a.d(this.bb);this.z&&a.N(this.z);var b=new A;b.d(5);B(b,5,a);return b};p.Aa=function(a){return new pb(1,a)};p.dbCreate=p.Aa;p.Ba=function(a){return new pb(2,a)};p.dbDrop=p.Ba;p.Ca=function(){return new pb(3)};p.dbList=p.Ca;function P(a){this.r=a}p.db=function(a){return new P(a)};p.db=p.db;P.prototype.list=function(){return new pb(6,this.r)};P.prototype.list=P.prototype.list;
function qb(a,b,c,d){this.za=a;this.z=b;this.ha=c;this.primaryKey=d||k}o(qb,z);qb.prototype.q=function(){var a=new H;a.N(this.z);B(a,2,this.ha);var b=new ab;B(b,1,this.za);b.k(a);this.Wa&&B(b,4,this.Wa);a=new N;a.d(4);B(a,3,b);b=new A;b.d(5);B(b,5,a);return b};P.prototype.create=function(a,b){return new qb("Welcome-dc",this.r,a,b)};P.prototype.create=P.prototype.create;function rb(a,b){this.z=a;this.ha=b}o(rb,z);
rb.prototype.q=function(){var a=new H;a.N(this.z);B(a,2,this.ha);var b=new N;b.d(5);B(b,4,a);a=new A;a.d(5);B(a,5,b);return a};P.prototype.Ia=function(a){return new rb(this.r,a)};P.prototype.drop=P.prototype.Ia;P.prototype.ga=function(a){return new y(a,this.r)};P.prototype.table=P.prototype.ga;function sb(){}sb.prototype.oa=function(a,b){return 11==a.h||10==a.h?tb(this,b):b};function ub(a,b){this.e=a|0;this.b=b|0}var vb={};function wb(a){if(-128<=a&&128>a){var b=vb[a];if(b)return b}b=new ub(a|0,0>a?-1:0);-128<=a&&128>a&&(vb[a]=b);return b}function Q(a){return isNaN(a)||!isFinite(a)?R:a<=-xb?S:a+1>=xb?yb:0>a?T(Q(-a)):new ub(a%U|0,a/U|0)}function V(a,b){return new ub(a,b)}var U=4294967296,xb=U*U/2,R=wb(0),zb=wb(1),Ab=wb(-1),yb=V(-1,2147483647),S=V(0,-2147483648),Bb=wb(16777216);m=ub.prototype;
m.toString=function(a){a=a||10;(2>a||36<a)&&f(Error("radix out of range: "+a));if(Cb(this))return"0";if(0>this.b){if(this.g(S)){var b=Q(a),c=W(this,b),b=Db(c.multiply(b),this);return c.toString(a)+b.e.toString(a)}return"-"+T(this).toString(a)}for(var c=Q(Math.pow(a,6)),b=this,d="";;){var e=W(b,c),i=Db(b,e.multiply(c)).e.toString(a),b=e;if(Cb(b))return i+d;for(;6>i.length;)i="0"+i;d=""+i+d}};function Eb(a){return 0<=a.e?a.e:U+a.e}function Cb(a){return 0==a.b&&0==a.e}
m.g=function(a){return this.b==a.b&&this.e==a.e};function Fb(a,b){if(a.g(b))return 0;var c=0>a.b,d=0>b.b;return c&&!d?-1:!c&&d?1:0>Db(a,b).b?-1:1}function T(a){return a.g(S)?S:a.ca().add(zb)}m.add=function(a){var b=this.b>>>16,c=this.b&65535,d=this.e>>>16,e=a.b>>>16,i=a.b&65535,g=a.e>>>16,r;r=0+((this.e&65535)+(a.e&65535));a=0+(r>>>16);a+=d+g;d=0+(a>>>16);d+=c+i;c=0+(d>>>16);return V((a&65535)<<16|r&65535,(c+(b+e)&65535)<<16|d&65535)};function Db(a,b){return a.add(T(b))}
m.multiply=function(a){if(Cb(this)||Cb(a))return R;if(this.g(S))return 1==(a.e&1)?S:R;if(a.g(S))return 1==(this.e&1)?S:R;if(0>this.b)return 0>a.b?T(this).multiply(T(a)):T(T(this).multiply(a));if(0>a.b)return T(this.multiply(T(a)));if(0>Fb(this,Bb)&&0>Fb(a,Bb))return Q((this.b*U+Eb(this))*(a.b*U+Eb(a)));var b=this.b>>>16,c=this.b&65535,d=this.e>>>16,e=this.e&65535,i=a.b>>>16,g=a.b&65535,r=a.e>>>16,a=a.e&65535,u,q,v,ob;ob=0+e*a;v=0+(ob>>>16);v+=d*a;q=0+(v>>>16);v=(v&65535)+e*r;q+=v>>>16;q+=c*a;u=0+
(q>>>16);q=(q&65535)+d*r;u+=q>>>16;q=(q&65535)+e*g;u+=q>>>16;return V((v&65535)<<16|ob&65535,(u+(b*a+c*r+d*g+e*i)&65535)<<16|q&65535)};
function W(a,b){Cb(b)&&f(Error("division by zero"));if(Cb(a))return R;if(a.g(S)){if(b.g(zb)||b.g(Ab))return S;if(b.g(S))return zb;var c=W(Gb(a,1),b).shiftLeft(1);if(c.g(R))return 0>b.b?zb:Ab;var d=Db(a,b.multiply(c));return c.add(W(d,b))}if(b.g(S))return R;if(0>a.b)return 0>b.b?W(T(a),T(b)):T(W(T(a),b));if(0>b.b)return T(W(a,T(b)));for(var e=R,d=a;0<=Fb(d,b);){for(var c=Math.max(1,Math.floor((d.b*U+Eb(d))/(b.b*U+Eb(b)))),i=Math.ceil(Math.log(c)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),g=Q(c),r=g.multiply(b);0>
r.b||0<Fb(r,d);)c-=i,g=Q(c),r=g.multiply(b);Cb(g)&&(g=zb);e=e.add(g);d=Db(d,r)}return e}m.ca=function(){return V(~this.e,~this.b)};m.ka=function(a){return V(this.e&a.e,this.b&a.b)};m.ta=function(a){return V(this.e|a.e,this.b|a.b)};function Hb(a,b){return V(a.e^b.e,a.b^b.b)}m.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.e;return 32>a?V(b<<a,this.b<<a|b>>>32-a):V(0,b<<a-32)};function Gb(a,b){b&=63;if(0==b)return a;var c=a.b;return 32>b?V(a.e>>>b|c<<32-b,c>>b):V(c>>b-32,0<=c?0:-1)};function Ib(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}function Jb(a){return new Uint8Array(Array.prototype.map.call(a,function(a){return a.charCodeAt(0)}))}function Kb(){this.j=0}o(Kb,sb);function X(a){f(new ga("Error deserializing incorrectly formated message, "+a))}
function tb(a,b){for(var c=ya(b.S()),d=[],e=0,i=0;i<c.length;i++){var g=c[i];if(E(b,g.i)){var r=0;do{var u=a.oa(g,b.get(g,r));d.push(u);e+=u.byteLength;r++}while(g.I&&r<Ca(b,g.i))}}c=new Uint8Array(e);for(i=e=0;i<d.length;i++)g=d[i],c.set(new Uint8Array(g),e),e+=g.byteLength;return c}
Kb.prototype.oa=function(a,b){var c=a.h,d=Lb[c],e=Mb(Q(a.i<<3|d)),i;switch(d){case Y:var g=Q(b);if(c==ua||17==c)g=Hb(g.shiftLeft(1),Gb(g,63));i=Mb(g);break;case Nb:g=new ArrayBuffer(8);c=new DataView(g);switch(a.h){case 1:c.setFloat64(0,b,j);break;case sa:i=Q(b);c.setUint32(0,Eb(i),j);c.setUint32(4,i.b,j);break;case ta:i=Q(b);c.setUint32(0,Eb(i),j);c.setInt32(4,i.b,j);break;default:X("Unexpected field type")}i=new Uint8Array(g);break;case Ob:switch(a.h){case 11:g=tb(this,b);break;case 9:g=Jb(unescape(encodeURIComponent(b)));
break;case 12:g=Jb(b);break;default:X("Unexpected field type")}i=g.length;c=Mb(Q(i));i=new Uint8Array(c.length+i);i.set(c,0);i.set(g,c.length);break;case Pb:X("Use of Groups deprecated and not supported");break;case Qb:g=new ArrayBuffer(4);c=new DataView(g);switch(a.h){case 2:c.setFloat32(0,b,j);break;case 7:c.setUint32(0,b,j);break;case 15:c.setInt32(0,b,j);break;default:X("Unexpected field type")}i=new Uint8Array(g);break;default:X("Unexpected wire type")}g=new Uint8Array(e.length+i.length);g.set(new Uint8Array(e),
0);g.set(new Uint8Array(i),e.length);return g};function Mb(a){function b(a){var d=Q(128),d=Db(a,W(a,d).multiply(d)).e,e=Q(127);0<Fb(a,e)?(d+=128,a=b(Gb(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function Rb(a,b,c){var d=b.S();for(a.j=0;a.j<c.length;){var e=Sb(a,c),i=d.o[parseInt(e>>3,10)]||k,g=a,r=e%8,u=i,e=c,q=h;switch(r){case Y:e=Sb(g,e);if(u){g=h;switch(u.h){case qa:case ra:g=e.toString();break;case 5:case 13:case 14:g=e;break;case 17:e=Q(e);g=Hb(Gb(e,1),e.shiftLeft(63)).e;break;case ua:e=Q(e);g=Hb(Gb(e,1),e.shiftLeft(63)).toString();break;case 8:g=0===g?l:j;break;default:X("Unexpected field type")}q=g}else q=k;break;case Ob:r=e;e=Sb(g,r);r=new Uint8Array(r.buffer,r.byteOffset+g.j,e);
g.j+=e;if(u){e=h;switch(u.h){case 9:e=decodeURIComponent(escape(Ib(r)));break;case 12:e=Ib(r);break;case 11:e=r;g=new Kb;u=new u.sa.A.Qa;Rb(g,u,e);e=u;break;default:X("Unexpected field type")}q=e}else q=k;break;case Qb:e=new DataView(e.buffer,g.j,4);g.j+=4;if(u){g=h;switch(u.h){case 2:g=e.getFloat32(0,j);break;case 7:g=e.getUint32(0,j);break;case 15:g=e.getInt32(0,j);break;default:X("Unexpected field type")}q=g}else q=k;break;case Nb:e=new DataView(e.buffer,g.j,8);g.j+=8;if(u){g=h;switch(u.h){case 1:g=
e.getFloat64(0,j);break;case sa:g=(new ub(e.getUint32(0,j),e.getUint32(4,j))).toString();break;case ta:g=(new ub(e.getUint32(0,j),e.getInt32(4,j))).toString();break;default:X("Unexpected field type")}q=g}else q=k;break;default:X("Unexpected wire type of "+r)}e=q;i!=k&&e!=k&&(i.I?b.add(i,e):b.set(i,e))}}function Sb(a,b){var c=b[a.j++];if(127<c)var c=c-128,d=Sb(a,b),c=c+(d<<7);return c}var Y=0,Nb=1,Ob=2,Pb=3,Qb=5,Lb=[-1,Nb,Qb,Y,Y,Y,Nb,Qb,Y,Ob,Pb,Ob,Ob,Y,Y,Qb,Nb,Y,Y];function Z(a){this.Ea=a||"Welcome-db";this.K={};this.Sa=1;la=this}Z.prototype.close=function(){};function Tb(a,b,c,d){b=b.q();b.fa((a.Sa++).toString());a.K[b.B()]={n:d||k,qa:c,da:[]};Ub(a,b)}function Ub(a,b){var c=tb(new Kb,b),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,j);e.set(c,4);a.va(e.buffer)}Z.prototype.U=function(a,b){Tb(this,a,l,b)};Z.prototype.run=Z.prototype.U;Z.prototype.T=function(a,b){Tb(this,a,j,b)};Z.prototype.iter=Z.prototype.T;
function Vb(a){this.name="Runtime Error";this.message=a||"The RDB runtime experienced an error"}o(Vb,Error);function Wb(){this.name="Broken Client";this.message="The client sent the server an incorrectly formatted message"}o(Wb,Error);function Xb(a){this.name="Bad Query";this.message=a||"This query contains type errors"}o(Xb,Error);
function Yb(a,b){(new DataView(b.buffer)).getUint32(0,j)!==b.length-4&&f(new s("RDB response corrupted, length inaccurate"));var c=new Kb,d=new cb;try{Rb(c,d,new Uint8Array(b.buffer,4))}catch(e){f(new s("response deserialization failed"))}var i=D(d,1);if(c=a.K[d.B()])switch(i){case 101:f(new Wb);case 103:f(new Vb(D(d,4)));case 102:f(new Xb(D(d,4)));case 0:delete a.K[d.B()];c.n&&c.n();break;case 3:delete a.K[d.B()];d=Ba(d).map(JSON.parse);c.n&&(c.qa?d.forEach(c.n):c.n(c.da.concat(d)));break;case 1:delete a.K[d.B()];
c.n&&(d=JSON.parse(D(d,3,0)),c.n(d));break;case 2:i=new A;i.d(3);i.fa(d.pa());Ub(a,i);d=Ba(d).map(JSON.parse);c.n&&(c.qa?d.forEach(c.n):c.da=c.da.concat(d));break;default:f(new s("unknown response status code"))}};function $(a,b,c){Z.call(this,k);this.C=k;this.Kc=0;this.v=k;var d=this;d.v=k;var e;e=a?n(a)?a:[a]:["localhost"];var i=require("net");(function r(){var a=e.shift();if(a){var q;"string"===typeof a?(q=a,a=12346):(q=a.host||"localhost",a=a.port||12346);var v=i.connect(a,q,function(){v.write("35ba61af","hex");v.on("data",ea(d.Za,d));d.v=v;b&&b(d)});v.on("error",r)}else c&&c()})()}o($,Z);fa("rethinkdb.net.TcpConnection",$);
$.prototype.va=function(a){this.v||f(new s("Connection not open"));for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.v.write(b)};
$.prototype.Za=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.C===k){var d=(new DataView(a.buffer,b,c)).getUint32(0,j);this.C=new Uint8Array(d+4);this.L=0}var d=this.C.byteLength-this.L,e=c<d?c:d,i=new Uint8Array(a.buffer,b,e);this.C.set(i,this.L);this.L+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.C,this.C=k,this.L=0,Yb(this,d))}};$.prototype.close=function(){this.v||f(new s("Connection not open"));this.v.end();this.v=k};$.prototype.close=$.prototype.close;function Zb(a,b,c){Z.call(this,k);this.G="";var d=this,e;e=a?n(a)?a:[a]:["localhost"];(function g(){var a=e.shift();if(a){var u;"string"===typeof a?(u=a,a=21300):(u=a.host||"localhost",a=a.port||21300);var q="http://"+u+":"+a+"/ajax/reql/",v=new XMLHttpRequest;v.responseType="arraybuffer";v.open("GET",q+"open-new-connection",j);v.onreadystatechange=function(){if(v.readyState===4)if(v.status===200){d.G=q;d.Y=(new DataView(v.response)).getInt32(0,j);b&&b(d)}else g()};v.send()}else c&&c()})()}o(Zb,Z);
fa("rethinkdb.net.HttpConnection",Zb);Zb.prototype.va=function(a){this.G||f(new s("Connection not open"));var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.G+"?conn_id="+this.Y,j);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&Yb(c,new Uint8Array(b.response))};b.send(a)};
Zb.prototype.close=function(){this.G||f(new s("Connection not open"));var a=new XMLHttpRequest;a.open("POST",this.G+"close-connection?conn_id="+this.Y,j);a.send();this.G=this.Y=k};Zb.prototype.close=Zb.prototype.close;fa("rethinkdb.net.connect",function(a,b,c){return"undefined"!==typeof require&&require("net")?new $(a,b,c):new Zb(a,b,c)});var la=k;fa("rethinkdb.net.last_connection",la);function y(a,b){this.Da=b||k;this.r=a}o(y,w);y.prototype.compile=function(){var a=new I;a.d(13);var b=new Ha,c=new H;c.N(this.Da||la.Ea);B(c,2,this.r);b.k(c);B(a,15,b);return a};function $b(a,b){this.ia=a;this.Na=new ja(b)}o($b,w);$b.prototype.compile=function(){var a=this.ia.compile(),b=D(a,15).p(),a=new J;a.k(b);a.F("id");a.V(this.Na.compile());b=new I;b.d(12);B(b,14,a);return b};y.prototype.get=function(a){return new $b(this,a)};y.prototype.get=y.prototype.get;
function ac(a,b){this.ia=a;n(b)||(b=[b]);this.na=b}o(ac,z);ac.prototype.q=function(){var a=this.ia.compile(),b=D(a,15).p(),a=new Va;a.k(b);for(b=0;b<this.na.length;b++){var c=(new ja(this.na[b])).compile();za(a,2,c)}b=new M;b.d(4);B(b,5,a);a=new A;a.d(2);B(a,4,b);return a};y.prototype.La=function(a){return new ac(this,a)};y.prototype.insert=y.prototype.La;function bc(a){this.P=a}o(bc,z);
bc.prototype.q=function(){var a=new Ta;a.O(this.P.compile());var b=new M;b.d(2);B(b,3,a);a=new A;a.d(2);B(a,4,b);return a};w.prototype.Fa=function(){return new bc(this)};w.prototype.del=w.prototype.Fa;function cc(a,b){this.P=a;this.J=b}o(cc,z);cc.prototype.q=function(){var a=new L;a.M(this.J.w[0]);a.u(this.J.body.compile());var b=new Sa;b.O(this.P.compile());b.s(a);a=new M;a.d(1);B(a,2,b);b=new A;b.d(2);B(b,4,a);return b};w.prototype.update=function(a){a=ha(a);return new cc(this,a)};
w.prototype.update=w.prototype.update;function dc(a,b){this.P=a;this.J=b}o(dc,z);dc.prototype.q=function(){var a=new L;a.M(this.J.w[0]);a.u(this.J.body.compile());var b=new Ua;b.O(this.P.compile());b.s(a);a=new M;a.d(3);B(a,4,b);b=new A;b.d(2);B(b,4,a);return b};w.prototype.Ra=function(a){a=ha(a);return new dc(this,a)};w.prototype.mutate=w.prototype.Ra;"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
